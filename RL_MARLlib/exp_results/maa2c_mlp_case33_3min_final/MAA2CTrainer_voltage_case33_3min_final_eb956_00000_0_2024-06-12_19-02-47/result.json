{"episode_reward_max": -170.88553582144272, "episode_reward_min": -188.65446690106913, "episode_reward_mean": -179.02316853050326, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -31.442411150178263}, "policy_reward_max": {"shared_policy": -28.48092263690724}, "policy_reward_mean": {"shared_policy": -29.83719475508393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23385778243053773, "mean_inference_ms": 0.4614909952769859, "mean_action_processing_ms": 0.08624474736497725, "mean_env_wait_ms": 8.25335747390341, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2400, "timesteps_this_iter": 0, "agent_timesteps_total": 14400, "timers": {"sample_time_ms": 24997.488, "sample_throughput": 96.01, "load_time_ms": 0.274, "load_throughput": 8753330.087, "learn_time_ms": 116.34, "learn_throughput": 20629.204, "update_time_ms": 2.324}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7042.74755859375, "policy_entropy": 3423.6127115885415, "policy_loss": -4149.783365885417, "vf_loss": 2236.9866536458335}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2400, "num_agent_steps_sampled": 14400, "num_steps_trained": 2400, "num_agent_steps_trained": 14400}, "done": false, "episodes_total": 8, "training_iteration": 1, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-03-26", "timestamp": 1718186606, "time_this_iter_s": 21.912570476531982, "time_total_s": 21.912570476531982, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30ff951f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 21.912570476531982, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 4.13125, "ram_util_percent": 35.7}}
{"episode_reward_max": -166.37368068035727, "episode_reward_min": -188.65446690106913, "episode_reward_mean": -176.5555980606255, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -31.442411150178263}, "policy_reward_max": {"shared_policy": -27.72894678005953}, "policy_reward_mean": {"shared_policy": -29.425933010104306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2382925014803725, "mean_inference_ms": 0.4595169708570013, "mean_action_processing_ms": 0.08606759938559647, "mean_env_wait_ms": 8.261479538126952, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 4800, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"sample_time_ms": 23489.295, "sample_throughput": 102.174, "load_time_ms": 0.199, "load_throughput": 12077180.084, "learn_time_ms": 118.292, "learn_throughput": 20288.781, "update_time_ms": 2.349}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9302.375, "policy_entropy": 3452.4952392578125, "policy_loss": -3984.7099609375, "vf_loss": 2015.0628458658855}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4800, "num_agent_steps_sampled": 28800, "num_steps_trained": 4800, "num_agent_steps_trained": 28800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-03-48", "timestamp": 1718186628, "time_this_iter_s": 21.969148635864258, "time_total_s": 43.88171911239624, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30ff95670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 43.88171911239624, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 4.0193548387096785, "ram_util_percent": 35.83548387096774}}
{"episode_reward_max": -166.37368068035727, "episode_reward_min": -193.68692443880894, "episode_reward_mean": -178.8335751983177, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -32.28115407313476}, "policy_reward_max": {"shared_policy": -27.72894678005953}, "policy_reward_mean": {"shared_policy": -29.805595866386323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23849577787484386, "mean_inference_ms": 0.45898559006567646, "mean_action_processing_ms": 0.08605179453729193, "mean_env_wait_ms": 8.272039629073163, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 7200, "timesteps_this_iter": 0, "agent_timesteps_total": 43200, "timers": {"sample_time_ms": 23041.783, "sample_throughput": 104.159, "load_time_ms": 0.176, "load_throughput": 13652345.75, "learn_time_ms": 116.866, "learn_throughput": 20536.377, "update_time_ms": 2.367}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12910.2236328125, "policy_entropy": 3494.503173828125, "policy_loss": -4204.6619059244795, "vf_loss": 2109.4650065104165}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 7200, "num_agent_steps_sampled": 43200, "num_steps_trained": 7200, "num_agent_steps_trained": 43200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28, "training_iteration": 3, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-04-10", "timestamp": 1718186650, "time_this_iter_s": 22.127002716064453, "time_total_s": 66.0087218284607, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f690d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 66.0087218284607, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 3.9967741935483874, "ram_util_percent": 36.20000000000001}}
{"episode_reward_max": -166.37368068035727, "episode_reward_min": -199.23858736860112, "episode_reward_mean": -179.52655860748283, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -33.20643122810015}, "policy_reward_max": {"shared_policy": -27.72894678005953}, "policy_reward_mean": {"shared_policy": -29.921093101247166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23965317003076375, "mean_inference_ms": 0.45897229315027677, "mean_action_processing_ms": 0.086061605728842, "mean_env_wait_ms": 8.284774001723235, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"sample_time_ms": 22831.317, "sample_throughput": 105.119, "load_time_ms": 0.163, "load_throughput": 14727621.946, "learn_time_ms": 115.751, "learn_throughput": 20734.104, "update_time_ms": 2.379}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15076.32421875, "policy_entropy": 3527.3045654296875, "policy_loss": -4017.6875, "vf_loss": 1877.6637369791667}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 57600, "num_steps_trained": 9600, "num_agent_steps_trained": 57600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-04-32", "timestamp": 1718186672, "time_this_iter_s": 22.186538219451904, "time_total_s": 88.1952600479126, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f278670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 88.1952600479126, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 4.0, "ram_util_percent": 36.353125}}
{"episode_reward_max": -163.25057026873898, "episode_reward_min": -199.23858736860112, "episode_reward_mean": -179.68705867358577, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -33.20643122810015}, "policy_reward_max": {"shared_policy": -27.208428378123084}, "policy_reward_mean": {"shared_policy": -29.947843112264323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23992680417977677, "mean_inference_ms": 0.459139603322311, "mean_action_processing_ms": 0.08608574643751771, "mean_env_wait_ms": 8.29231771579506, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 12000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"sample_time_ms": 22712.703, "sample_throughput": 105.668, "load_time_ms": 0.156, "load_throughput": 15410792.407, "learn_time_ms": 116.666, "learn_throughput": 20571.473, "update_time_ms": 2.366}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16870.759765625, "policy_entropy": 3561.625040690104, "policy_loss": -4002.8546142578125, "vf_loss": 1810.5602213541667}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 12000, "num_agent_steps_sampled": 72000, "num_steps_trained": 12000, "num_agent_steps_trained": 72000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 48, "training_iteration": 5, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-04-54", "timestamp": 1718186694, "time_this_iter_s": 22.231865406036377, "time_total_s": 110.42712545394897, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff309f664c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 110.42712545394897, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 4.228125, "ram_util_percent": 36.60625}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.23858736860112, "episode_reward_mean": -179.47571933995596, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -33.20643122810015}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -29.912619889992666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2405671674562031, "mean_inference_ms": 0.4592398551202677, "mean_action_processing_ms": 0.08609729241113176, "mean_env_wait_ms": 8.298714223898928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 14400, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"sample_time_ms": 22599.428, "sample_throughput": 106.197, "load_time_ms": 0.151, "load_throughput": 15898388.418, "learn_time_ms": 117.131, "learn_throughput": 20489.866, "update_time_ms": 2.378}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17387.177734375, "policy_entropy": 3609.633015950521, "policy_loss": -3901.0524088541665, "vf_loss": 1688.5033365885417}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 14400, "num_agent_steps_sampled": 86400, "num_steps_trained": 14400, "num_agent_steps_trained": 86400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-05-16", "timestamp": 1718186716, "time_this_iter_s": 22.01863121986389, "time_total_s": 132.44575667381287, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f278af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 132.44575667381287, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 4.145161290322581, "ram_util_percent": 36.79999999999999}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.23858736860112, "episode_reward_mean": -179.13610548091702, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -33.20643122810015}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -29.856017580152848}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24070715689408065, "mean_inference_ms": 0.4592024750518777, "mean_action_processing_ms": 0.0860995115556983, "mean_env_wait_ms": 8.302187216201606, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 16800, "timesteps_this_iter": 0, "agent_timesteps_total": 100800, "timers": {"sample_time_ms": 22530.135, "sample_throughput": 106.524, "load_time_ms": 0.147, "load_throughput": 16303634.243, "learn_time_ms": 117.563, "learn_throughput": 20414.644, "update_time_ms": 2.44}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18664.865234375, "policy_entropy": 3667.208984375, "policy_loss": -4006.5923665364585, "vf_loss": 1713.2052815755208}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16800, "num_agent_steps_sampled": 100800, "num_steps_trained": 16800, "num_agent_steps_trained": 100800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 68, "training_iteration": 7, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-05-38", "timestamp": 1718186738, "time_this_iter_s": 22.10190200805664, "time_total_s": 154.5476586818695, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff309f663a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 154.5476586818695, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 4.212903225806452, "ram_util_percent": 36.977419354838716}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.7379133461239, "episode_reward_mean": -179.53693557815555, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -33.28965222435408}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -29.922822596359264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24101325233931536, "mean_inference_ms": 0.4591461773875551, "mean_action_processing_ms": 0.0860949397071501, "mean_env_wait_ms": 8.306107811450975, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"sample_time_ms": 22477.483, "sample_throughput": 106.774, "load_time_ms": 0.146, "load_throughput": 16421418.597, "learn_time_ms": 118.11, "learn_throughput": 20320.035, "update_time_ms": 2.438}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18224.005859375, "policy_entropy": 3742.9801432291665, "policy_loss": -3916.0833333333335, "vf_loss": 1643.1142171223958}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 115200, "num_steps_trained": 19200, "num_agent_steps_trained": 115200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-06-00", "timestamp": 1718186760, "time_this_iter_s": 22.0958251953125, "time_total_s": 176.643483877182, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f685040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 176.643483877182, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 4.025, "ram_util_percent": 37.11875}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.7379133461239, "episode_reward_mean": -179.62070261507927, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -33.28965222435408}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -29.936783769179883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24113346081952394, "mean_inference_ms": 0.4592981220283145, "mean_action_processing_ms": 0.08610363817364529, "mean_env_wait_ms": 8.308644406719308, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 21600, "timesteps_this_iter": 0, "agent_timesteps_total": 129600, "timers": {"sample_time_ms": 22452.894, "sample_throughput": 106.89, "load_time_ms": 0.145, "load_throughput": 16544369.321, "learn_time_ms": 117.631, "learn_throughput": 20402.778, "update_time_ms": 2.447}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17467.37890625, "policy_entropy": 3880.724365234375, "policy_loss": -3793.582316080729, "vf_loss": 1569.966552734375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 21600, "num_agent_steps_sampled": 129600, "num_steps_trained": 21600, "num_agent_steps_trained": 129600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 88, "training_iteration": 9, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-06-23", "timestamp": 1718186783, "time_this_iter_s": 22.23194980621338, "time_total_s": 198.87543368339539, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff310281c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 198.87543368339539, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 4.138709677419355, "ram_util_percent": 37.2741935483871}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.7379133461239, "episode_reward_mean": -180.31868713896844, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -33.28965222435408}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -30.053114523161415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24139700235595704, "mean_inference_ms": 0.4594970151449613, "mean_action_processing_ms": 0.08611827988470612, "mean_env_wait_ms": 8.311965847457412, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 22426.249, "sample_throughput": 107.017, "load_time_ms": 0.144, "load_throughput": 16652323.573, "learn_time_ms": 117.231, "learn_throughput": 20472.424, "update_time_ms": 2.462}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16587.134765625, "policy_entropy": 4132.267985026042, "policy_loss": -3815.282267252604, "vf_loss": 1625.5616048177083}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 144000, "num_steps_trained": 24000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-06-45", "timestamp": 1718186805, "time_this_iter_s": 22.172756910324097, "time_total_s": 221.04819059371948, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f685f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 221.04819059371948, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 3.9937499999999995, "ram_util_percent": 37.4}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.78810646701513, "episode_reward_mean": -181.21692598516384, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -33.298017744502474}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -30.202820997527304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24209909203152408, "mean_inference_ms": 0.45945356188065856, "mean_action_processing_ms": 0.08611494720223256, "mean_env_wait_ms": 8.318796411968917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 26400, "timesteps_this_iter": 0, "agent_timesteps_total": 158400, "timers": {"sample_time_ms": 22142.223, "sample_throughput": 108.39, "load_time_ms": 0.13, "load_throughput": 18504282.353, "learn_time_ms": 116.934, "learn_throughput": 20524.48, "update_time_ms": 2.487}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17911.013671875, "policy_entropy": 4528.635498046875, "policy_loss": -4382.694010416667, "vf_loss": 1719.9583943684895}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 26400, "num_agent_steps_sampled": 158400, "num_steps_trained": 26400, "num_agent_steps_trained": 158400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 108, "training_iteration": 11, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-07-07", "timestamp": 1718186827, "time_this_iter_s": 22.142028093338013, "time_total_s": 243.1902186870575, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff310281940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 243.1902186870575, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 4.019354838709678, "ram_util_percent": 37.66774193548389}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -217.58335104535448, "episode_reward_mean": -184.5453269159735, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -36.26389184089261}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -30.75755448599557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24236489424553487, "mean_inference_ms": 0.4597839519068884, "mean_action_processing_ms": 0.08614313128461559, "mean_env_wait_ms": 8.327149255432385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 172800, "timers": {"sample_time_ms": 22151.758, "sample_throughput": 108.344, "load_time_ms": 0.131, "load_throughput": 18365863.164, "learn_time_ms": 116.882, "learn_throughput": 20533.527, "update_time_ms": 2.495}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18483.708984375, "policy_entropy": 5124.100830078125, "policy_loss": -5110.056559244792, "vf_loss": 1982.5441080729167}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 172800, "num_steps_trained": 28800, "num_agent_steps_trained": 172800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 12, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-07-29", "timestamp": 1718186849, "time_this_iter_s": 22.066456079483032, "time_total_s": 265.2566747665405, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff303300a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 265.2566747665405, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 4.084375, "ram_util_percent": 37.8}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -230.7552304436114, "episode_reward_mean": -187.30973457132578, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -38.45920507393532}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -31.21828909522096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24266925384573262, "mean_inference_ms": 0.4600161271907561, "mean_action_processing_ms": 0.08615639003212493, "mean_env_wait_ms": 8.330493952626165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 31200, "timesteps_this_iter": 0, "agent_timesteps_total": 187200, "timers": {"sample_time_ms": 22157.232, "sample_throughput": 108.317, "load_time_ms": 0.131, "load_throughput": 18335755.191, "learn_time_ms": 117.415, "learn_throughput": 20440.244, "update_time_ms": 2.538}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21979.810546875, "policy_entropy": 5842.876057942708, "policy_loss": -6667.722574869792, "vf_loss": 2351.238240559896}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 31200, "num_agent_steps_sampled": 187200, "num_steps_trained": 31200, "num_agent_steps_trained": 187200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 128, "training_iteration": 13, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-07-51", "timestamp": 1718186871, "time_this_iter_s": 22.18766164779663, "time_total_s": 287.44433641433716, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30fad2d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 287.44433641433716, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 4.025806451612904, "ram_util_percent": 38.0}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -248.15850612608585, "episode_reward_mean": -192.88286331077626, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -41.35975102101435}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -32.14714388512938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24279331257636488, "mean_inference_ms": 0.4601511823834952, "mean_action_processing_ms": 0.08616572015248324, "mean_env_wait_ms": 8.333692987236919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 33600, "timesteps_this_iter": 0, "agent_timesteps_total": 201600, "timers": {"sample_time_ms": 22152.96, "sample_throughput": 108.338, "load_time_ms": 0.13, "load_throughput": 18473719.215, "learn_time_ms": 117.784, "learn_throughput": 20376.352, "update_time_ms": 2.572}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22326.650390625, "policy_entropy": 6746.379720052083, "policy_loss": -7727.942545572917, "vf_loss": 2471.803670247396}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 33600, "num_agent_steps_sampled": 201600, "num_steps_trained": 33600, "num_agent_steps_trained": 201600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 140, "training_iteration": 14, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-08-14", "timestamp": 1718186894, "time_this_iter_s": 22.13926935195923, "time_total_s": 309.5836057662964, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f278670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 309.5836057662964, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 3.971875, "ram_util_percent": 38.1375}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -256.97349593309593, "episode_reward_mean": -197.7730413287355, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -42.82891598884934}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -32.962173554789246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24294339762329858, "mean_inference_ms": 0.4601573579245688, "mean_action_processing_ms": 0.0861652691191307, "mean_env_wait_ms": 8.335228110265934, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 36000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"sample_time_ms": 22170.11, "sample_throughput": 108.254, "load_time_ms": 0.132, "load_throughput": 18213008.142, "learn_time_ms": 117.137, "learn_throughput": 20488.85, "update_time_ms": 2.592}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25087.884765625, "policy_entropy": 7655.599446614583, "policy_loss": -9770.9638671875, "vf_loss": 2760.0977376302085}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 36000, "num_agent_steps_sampled": 216000, "num_steps_trained": 36000, "num_agent_steps_trained": 216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 148, "training_iteration": 15, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-08-36", "timestamp": 1718186916, "time_this_iter_s": 22.392640113830566, "time_total_s": 331.97624588012695, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30fad2dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 331.97624588012695, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 4.17741935483871, "ram_util_percent": 38.29999999999999}}
{"episode_reward_max": -162.5849580968339, "episode_reward_min": -263.02550053054284, "episode_reward_mean": -206.15265981065616, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -43.837583421757046}, "policy_reward_max": {"shared_policy": -27.097493016139037}, "policy_reward_mean": {"shared_policy": -34.35877663510935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24298925988844997, "mean_inference_ms": 0.46017381590126066, "mean_action_processing_ms": 0.0861698289554217, "mean_env_wait_ms": 8.33865068630219, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 230400, "timers": {"sample_time_ms": 22194.978, "sample_throughput": 108.133, "load_time_ms": 0.133, "load_throughput": 18027094.556, "learn_time_ms": 116.722, "learn_throughput": 20561.742, "update_time_ms": 2.584}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24667.677734375, "policy_entropy": 8632.152669270834, "policy_loss": -10824.371988932291, "vf_loss": 2947.6011962890625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 230400, "num_steps_trained": 38400, "num_agent_steps_trained": 230400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 16, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-08-58", "timestamp": 1718186938, "time_this_iter_s": 22.268555879592896, "time_total_s": 354.24480175971985, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30fad2670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 354.24480175971985, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 4.28125, "ram_util_percent": 38.5}}
{"episode_reward_max": -162.5849580968339, "episode_reward_min": -267.2357927830909, "episode_reward_mean": -212.68170824928737, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -44.53929879718188}, "policy_reward_max": {"shared_policy": -27.097493016139037}, "policy_reward_mean": {"shared_policy": -35.44695137488123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24309427705771583, "mean_inference_ms": 0.4602180196718345, "mean_action_processing_ms": 0.08617517180558729, "mean_env_wait_ms": 8.340634455751815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 40800, "timesteps_this_iter": 0, "agent_timesteps_total": 244800, "timers": {"sample_time_ms": 22196.442, "sample_throughput": 108.125, "load_time_ms": 0.134, "load_throughput": 17962758.03, "learn_time_ms": 116.716, "learn_throughput": 20562.787, "update_time_ms": 2.543}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24669.611328125, "policy_entropy": 9480.43896484375, "policy_loss": -11638.561604817709, "vf_loss": 3205.198201497396}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40800, "num_agent_steps_sampled": 244800, "num_steps_trained": 40800, "num_agent_steps_trained": 244800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 168, "training_iteration": 17, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-09-20", "timestamp": 1718186960, "time_this_iter_s": 22.11970043182373, "time_total_s": 376.3645021915436, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102810d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 376.3645021915436, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 4.232258064516128, "ram_util_percent": 38.69354838709679}}
{"episode_reward_max": -164.145192847411, "episode_reward_min": -279.0093834215262, "episode_reward_mean": -222.25125851470048, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -46.501563903587666}, "policy_reward_max": {"shared_policy": -27.3575321412351}, "policy_reward_mean": {"shared_policy": -37.04187641911676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24319871064678086, "mean_inference_ms": 0.4603210672585199, "mean_action_processing_ms": 0.08619003549555516, "mean_env_wait_ms": 8.344121036345463, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 43200, "timesteps_this_iter": 0, "agent_timesteps_total": 259200, "timers": {"sample_time_ms": 22223.131, "sample_throughput": 107.996, "load_time_ms": 0.133, "load_throughput": 18004524.414, "learn_time_ms": 116.129, "learn_throughput": 20666.695, "update_time_ms": 2.558}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24534.28125, "policy_entropy": 10308.453776041666, "policy_loss": -12218.147623697916, "vf_loss": 3417.271240234375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 43200, "num_agent_steps_sampled": 259200, "num_steps_trained": 43200, "num_agent_steps_trained": 259200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 180, "training_iteration": 18, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-09-43", "timestamp": 1718186983, "time_this_iter_s": 22.35774803161621, "time_total_s": 398.7222502231598, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff309f66040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 398.7222502231598, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 4.231249999999999, "ram_util_percent": 38.9}}
{"episode_reward_max": -167.42691146070004, "episode_reward_min": -279.0093834215262, "episode_reward_mean": -228.73860004406376, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -46.501563903587666}, "policy_reward_max": {"shared_policy": -27.90448524344995}, "policy_reward_mean": {"shared_policy": -38.123100007343986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24327048182856614, "mean_inference_ms": 0.46021013359120816, "mean_action_processing_ms": 0.0861888463599509, "mean_env_wait_ms": 8.34607178603659, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 45600, "timesteps_this_iter": 0, "agent_timesteps_total": 273600, "timers": {"sample_time_ms": 22215.509, "sample_throughput": 108.033, "load_time_ms": 0.134, "load_throughput": 17949945.792, "learn_time_ms": 116.639, "learn_throughput": 20576.326, "update_time_ms": 2.548}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24695.970703125, "policy_entropy": 11056.896647135416, "policy_loss": -13397.61181640625, "vf_loss": 3126.902872721354}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 45600, "num_agent_steps_sampled": 273600, "num_steps_trained": 45600, "num_agent_steps_trained": 273600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 188, "training_iteration": 19, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-10-05", "timestamp": 1718187005, "time_this_iter_s": 22.16813015937805, "time_total_s": 420.89038038253784, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff310281af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 420.89038038253784, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 4.154838709677419, "ram_util_percent": 39.0}}
{"episode_reward_max": -174.7362677665594, "episode_reward_min": -279.0093834215262, "episode_reward_mean": -237.58074837698777, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -46.501563903587666}, "policy_reward_max": {"shared_policy": -29.122711294426573}, "policy_reward_mean": {"shared_policy": -39.59679139616465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24329433385453966, "mean_inference_ms": 0.4599908339239632, "mean_action_processing_ms": 0.08618554491111194, "mean_env_wait_ms": 8.348569936520077, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 22207.498, "sample_throughput": 108.072, "load_time_ms": 0.133, "load_throughput": 18010967.257, "learn_time_ms": 116.821, "learn_throughput": 20544.331, "update_time_ms": 2.523}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24964.666015625, "policy_entropy": 11733.910807291666, "policy_loss": -13238.121907552084, "vf_loss": 3091.6575927734375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 288000, "num_steps_trained": 48000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 20, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-10-27", "timestamp": 1718187027, "time_this_iter_s": 22.08804416656494, "time_total_s": 442.9784245491028, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3033005e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 442.9784245491028, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 4.31875, "ram_util_percent": 39.2}}
{"episode_reward_max": -179.8736305309754, "episode_reward_min": -279.0093834215262, "episode_reward_mean": -243.26314367986254, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -46.501563903587666}, "policy_reward_max": {"shared_policy": -29.97893842182934}, "policy_reward_mean": {"shared_policy": -40.54385727997712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24333102604622522, "mean_inference_ms": 0.4598309295104249, "mean_action_processing_ms": 0.0861835953137393, "mean_env_wait_ms": 8.350158392458779, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 50400, "timesteps_this_iter": 0, "agent_timesteps_total": 302400, "timers": {"sample_time_ms": 22211.981, "sample_throughput": 108.05, "load_time_ms": 0.133, "load_throughput": 18014190.408, "learn_time_ms": 116.893, "learn_throughput": 20531.601, "update_time_ms": 2.512}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28634.625, "policy_entropy": 12304.390787760416, "policy_loss": -15545.71826171875, "vf_loss": 3125.6834716796875}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 50400, "num_agent_steps_sampled": 302400, "num_steps_trained": 50400, "num_agent_steps_trained": 302400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 208, "training_iteration": 21, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-10-49", "timestamp": 1718187049, "time_this_iter_s": 22.186244010925293, "time_total_s": 465.1646685600281, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30ef45dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 465.1646685600281, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 4.180645161290323, "ram_util_percent": 39.40000000000001}}
{"episode_reward_max": -207.15387214236273, "episode_reward_min": -281.0367712021121, "episode_reward_mean": -250.8243588779958, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -46.83946186701869}, "policy_reward_max": {"shared_policy": -34.52564535706054}, "policy_reward_mean": {"shared_policy": -41.80405981299933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24333442779049444, "mean_inference_ms": 0.45956772799109624, "mean_action_processing_ms": 0.08618365894760531, "mean_env_wait_ms": 8.353070994661708, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 52800, "timesteps_this_iter": 0, "agent_timesteps_total": 316800, "timers": {"sample_time_ms": 22233.125, "sample_throughput": 107.947, "load_time_ms": 0.133, "load_throughput": 18027094.556, "learn_time_ms": 116.58, "learn_throughput": 20586.728, "update_time_ms": 2.513}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31043.708984375, "policy_entropy": 12787.58935546875, "policy_loss": -15842.6005859375, "vf_loss": 3217.4715983072915}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 52800, "num_agent_steps_sampled": 316800, "num_steps_trained": 52800, "num_agent_steps_trained": 316800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 220, "training_iteration": 22, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-11-11", "timestamp": 1718187071, "time_this_iter_s": 22.275925874710083, "time_total_s": 487.44059443473816, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30ef453a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 487.44059443473816, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 4.0843750000000005, "ram_util_percent": 39.5}}
{"episode_reward_max": -209.83364727755313, "episode_reward_min": -281.0367712021121, "episode_reward_mean": -254.72295021069135, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -46.83946186701869}, "policy_reward_max": {"shared_policy": -34.97227454625889}, "policy_reward_mean": {"shared_policy": -42.453825035115244}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24336212889244077, "mean_inference_ms": 0.4594057750496592, "mean_action_processing_ms": 0.08618472166120345, "mean_env_wait_ms": 8.354868319830922, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 55200, "timesteps_this_iter": 0, "agent_timesteps_total": 331200, "timers": {"sample_time_ms": 22237.488, "sample_throughput": 107.926, "load_time_ms": 0.132, "load_throughput": 18222899.348, "learn_time_ms": 116.629, "learn_throughput": 20578.088, "update_time_ms": 2.47}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34741.22265625, "policy_entropy": 13240.762532552084, "policy_loss": -17274.793294270832, "vf_loss": 2957.723592122396}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 55200, "num_agent_steps_sampled": 331200, "num_steps_trained": 55200, "num_agent_steps_trained": 331200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 228, "training_iteration": 23, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-11-34", "timestamp": 1718187094, "time_this_iter_s": 22.233479976654053, "time_total_s": 509.6740744113922, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff303300820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 509.6740744113922, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 4.00625, "ram_util_percent": 39.7}}
{"episode_reward_max": -227.51491963843588, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -259.1030513432054, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -37.91915327307279}, "policy_reward_mean": {"shared_policy": -43.183841890534254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24336530090441144, "mean_inference_ms": 0.4592092994415964, "mean_action_processing_ms": 0.0861888176927251, "mean_env_wait_ms": 8.357832205877962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 57600, "timesteps_this_iter": 0, "agent_timesteps_total": 345600, "timers": {"sample_time_ms": 22258.397, "sample_throughput": 107.824, "load_time_ms": 0.134, "load_throughput": 17917995.016, "learn_time_ms": 117.034, "learn_throughput": 20506.852, "update_time_ms": 2.453}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39162.98046875, "policy_entropy": 13632.24169921875, "policy_loss": -16650.017659505207, "vf_loss": 3207.475545247396}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 57600, "num_agent_steps_sampled": 345600, "num_steps_trained": 57600, "num_agent_steps_trained": 345600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 24, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-11-56", "timestamp": 1718187116, "time_this_iter_s": 22.352242946624756, "time_total_s": 532.026317358017, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102ab4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 532.026317358017, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 4.151612903225806, "ram_util_percent": 39.90000000000001}}
{"episode_reward_max": -227.51491963843588, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -261.4030816473064, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -37.91915327307279}, "policy_reward_mean": {"shared_policy": -43.5671802745511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24336173784023316, "mean_inference_ms": 0.4590582448329481, "mean_action_processing_ms": 0.0861891950491351, "mean_env_wait_ms": 8.359323565931001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 22244.732, "sample_throughput": 107.891, "load_time_ms": 0.132, "load_throughput": 18124468.131, "learn_time_ms": 117.369, "learn_throughput": 20448.386, "update_time_ms": 2.45}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44246.98828125, "policy_entropy": 13977.417643229166, "policy_loss": -15830.426595052084, "vf_loss": 3437.745361328125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 360000, "num_steps_trained": 60000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 248, "training_iteration": 25, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-12-18", "timestamp": 1718187138, "time_this_iter_s": 22.255236625671387, "time_total_s": 554.2815539836884, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f2789d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 554.2815539836884, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 4.106249999999999, "ram_util_percent": 40.084375}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -263.96880679079715, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -43.99480113179954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2433487786248213, "mean_inference_ms": 0.45885065739582986, "mean_action_processing_ms": 0.08619236337313742, "mean_env_wait_ms": 8.361150626186813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 62400, "timesteps_this_iter": 0, "agent_timesteps_total": 374400, "timers": {"sample_time_ms": 22237.026, "sample_throughput": 107.928, "load_time_ms": 0.13, "load_throughput": 18500881.456, "learn_time_ms": 117.479, "learn_throughput": 20429.139, "update_time_ms": 2.47}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33804.20703125, "policy_entropy": 14264.05078125, "policy_loss": -14382.879801432291, "vf_loss": 3657.781209309896}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 62400, "num_agent_steps_sampled": 374400, "num_steps_trained": 62400, "num_agent_steps_trained": 374400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 260, "training_iteration": 26, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-12-41", "timestamp": 1718187161, "time_this_iter_s": 22.189717531204224, "time_total_s": 576.4712715148926, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3032b9b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 576.4712715148926, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 4.103125, "ram_util_percent": 40.2}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -264.7204389920529, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -44.120073165342156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24337831790817796, "mean_inference_ms": 0.4589716838882347, "mean_action_processing_ms": 0.08619752087969512, "mean_env_wait_ms": 8.362655035140351, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 64800, "timesteps_this_iter": 0, "agent_timesteps_total": 388800, "timers": {"sample_time_ms": 22286.944, "sample_throughput": 107.686, "load_time_ms": 0.13, "load_throughput": 18511087.9, "learn_time_ms": 117.258, "learn_throughput": 20467.753, "update_time_ms": 2.473}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39528.43359375, "policy_entropy": 14489.745279947916, "policy_loss": -16463.913411458332, "vf_loss": 3372.332560221354}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 64800, "num_agent_steps_sampled": 388800, "num_steps_trained": 64800, "num_agent_steps_trained": 388800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 268, "training_iteration": 27, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-13-03", "timestamp": 1718187183, "time_this_iter_s": 22.61351490020752, "time_total_s": 599.0847864151001, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f7a8dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 599.0847864151001, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 4.206250000000001, "ram_util_percent": 40.4}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -265.5627036603784, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -44.260450610063074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24341978954190832, "mean_inference_ms": 0.4591879539072041, "mean_action_processing_ms": 0.08620886932517566, "mean_env_wait_ms": 8.365025212440555, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 67200, "timesteps_this_iter": 0, "agent_timesteps_total": 403200, "timers": {"sample_time_ms": 22312.63, "sample_throughput": 107.562, "load_time_ms": 0.129, "load_throughput": 18631000.555, "learn_time_ms": 117.265, "learn_throughput": 20466.505, "update_time_ms": 2.519}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50100.40234375, "policy_entropy": 14687.328776041666, "policy_loss": -14975.102376302084, "vf_loss": 3455.36376953125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 67200, "num_agent_steps_sampled": 403200, "num_steps_trained": 67200, "num_agent_steps_trained": 403200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 28, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-13-26", "timestamp": 1718187206, "time_this_iter_s": 22.6165030002594, "time_total_s": 621.7012894153595, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3032b9af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 621.7012894153595, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 4.175000000000001, "ram_util_percent": 40.546875}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -265.9481304062368, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -44.32468840103948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2434635642927948, "mean_inference_ms": 0.4593435291380677, "mean_action_processing_ms": 0.08621834142489561, "mean_env_wait_ms": 8.3666613306267, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 69600, "timesteps_this_iter": 0, "agent_timesteps_total": 417600, "timers": {"sample_time_ms": 22326.54, "sample_throughput": 107.495, "load_time_ms": 0.128, "load_throughput": 18766460.85, "learn_time_ms": 117.132, "learn_throughput": 20489.646, "update_time_ms": 2.539}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53964.77734375, "policy_entropy": 14844.438802083334, "policy_loss": -17131.367350260418, "vf_loss": 3143.9667765299478}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 69600, "num_agent_steps_sampled": 417600, "num_steps_trained": 69600, "num_agent_steps_trained": 417600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 288, "training_iteration": 29, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-13-48", "timestamp": 1718187228, "time_this_iter_s": 22.30553102493286, "time_total_s": 644.0068204402924, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102ab4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 644.0068204402924, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 4.18125, "ram_util_percent": 40.803124999999994}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -267.0660784224598, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -44.51101307040997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2435502674908936, "mean_inference_ms": 0.4596559988425957, "mean_action_processing_ms": 0.08623477155860015, "mean_env_wait_ms": 8.36965035053107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"sample_time_ms": 22367.563, "sample_throughput": 107.298, "load_time_ms": 0.129, "load_throughput": 18603455.184, "learn_time_ms": 117.618, "learn_throughput": 20405.1, "update_time_ms": 2.558}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58951.98828125, "policy_entropy": 14980.671223958334, "policy_loss": -17026.393229166668, "vf_loss": 3286.7222900390625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 432000, "num_steps_trained": 72000, "num_agent_steps_trained": 432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 300, "training_iteration": 30, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-14-11", "timestamp": 1718187251, "time_this_iter_s": 22.503560781478882, "time_total_s": 666.5103812217712, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff309f661f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 666.5103812217712, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 4.2375, "ram_util_percent": 40.90625}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.78726259534994, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -44.631210432558326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24361953387600124, "mean_inference_ms": 0.4598555733089572, "mean_action_processing_ms": 0.08624585155963031, "mean_env_wait_ms": 8.37153712968538, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 74400, "timesteps_this_iter": 0, "agent_timesteps_total": 446400, "timers": {"sample_time_ms": 22367.332, "sample_throughput": 107.299, "load_time_ms": 0.129, "load_throughput": 18555446.267, "learn_time_ms": 118.278, "learn_throughput": 20291.17, "update_time_ms": 2.556}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43808.28125, "policy_entropy": 15075.41357421875, "policy_loss": -18675.450520833332, "vf_loss": 2843.2979736328125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 74400, "num_agent_steps_sampled": 446400, "num_steps_trained": 74400, "num_agent_steps_trained": 446400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 308, "training_iteration": 31, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-14-33", "timestamp": 1718187273, "time_this_iter_s": 22.184410095214844, "time_total_s": 688.6947913169861, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3032b9f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 688.6947913169861, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 3.9806451612903224, "ram_util_percent": 41.09999999999998}}
{"episode_reward_max": -236.35348607334606, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.26421461147845, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -39.39224767889106}, "policy_reward_mean": {"shared_policy": -44.54403576857974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24369025027817107, "mean_inference_ms": 0.46014476850560937, "mean_action_processing_ms": 0.08625978046380667, "mean_env_wait_ms": 8.373999934100876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 460800, "timers": {"sample_time_ms": 22353.754, "sample_throughput": 107.365, "load_time_ms": 0.13, "load_throughput": 18480502.295, "learn_time_ms": 118.333, "learn_throughput": 20281.779, "update_time_ms": 2.57}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67920.59375, "policy_entropy": 15172.479654947916, "policy_loss": -16360.409505208334, "vf_loss": 2997.0997721354165}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 460800, "num_steps_trained": 76800, "num_agent_steps_trained": 460800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 32, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-14-55", "timestamp": 1718187295, "time_this_iter_s": 22.13407802581787, "time_total_s": 710.828869342804, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102ab4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 710.828869342804, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 4.153124999999999, "ram_util_percent": 41.271874999999994}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -266.70372911494445, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.450621519157416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2437499878955163, "mean_inference_ms": 0.46036744451981837, "mean_action_processing_ms": 0.08626918225128727, "mean_env_wait_ms": 8.375730002886092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 79200, "timesteps_this_iter": 0, "agent_timesteps_total": 475200, "timers": {"sample_time_ms": 22376.123, "sample_throughput": 107.257, "load_time_ms": 0.13, "load_throughput": 18423004.392, "learn_time_ms": 118.227, "learn_throughput": 20299.939, "update_time_ms": 2.614}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66746.4140625, "policy_entropy": 15210.646321614584, "policy_loss": -14930.8564453125, "vf_loss": 3534.9537353515625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 79200, "num_agent_steps_sampled": 475200, "num_steps_trained": 79200, "num_agent_steps_trained": 475200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 328, "training_iteration": 33, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-15-17", "timestamp": 1718187317, "time_this_iter_s": 22.454742908477783, "time_total_s": 733.2836122512817, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102814c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 733.2836122512817, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 4.21875, "ram_util_percent": 41.40625}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.5590182243393, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.59316970405655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24383273180043724, "mean_inference_ms": 0.46068932978578325, "mean_action_processing_ms": 0.08628138622054812, "mean_env_wait_ms": 8.378041698255505, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 81600, "timesteps_this_iter": 0, "agent_timesteps_total": 489600, "timers": {"sample_time_ms": 22369.372, "sample_throughput": 107.29, "load_time_ms": 0.128, "load_throughput": 18728055.07, "learn_time_ms": 118.274, "learn_throughput": 20291.902, "update_time_ms": 2.626}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77358.203125, "policy_entropy": 15270.3798828125, "policy_loss": -12893.96044921875, "vf_loss": 3948.2352294921875}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 81600, "num_agent_steps_sampled": 489600, "num_steps_trained": 81600, "num_agent_steps_trained": 489600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 340, "training_iteration": 34, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-15-40", "timestamp": 1718187340, "time_this_iter_s": 22.285351753234863, "time_total_s": 755.5689640045166, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f2781f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 755.5689640045166, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 3.9645161290322584, "ram_util_percent": 41.587096774193526}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.16810360653864, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.52801726775644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2438931140374737, "mean_inference_ms": 0.4609105847008077, "mean_action_processing_ms": 0.08628776765894594, "mean_env_wait_ms": 8.379413677488053, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 84000, "timesteps_this_iter": 0, "agent_timesteps_total": 504000, "timers": {"sample_time_ms": 22361.851, "sample_throughput": 107.326, "load_time_ms": 0.13, "load_throughput": 18446636.614, "learn_time_ms": 118.057, "learn_throughput": 20329.099, "update_time_ms": 2.617}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72258.9140625, "policy_entropy": 15349.73388671875, "policy_loss": -15561.232991536459, "vf_loss": 3389.233601888021}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 84000, "num_agent_steps_sampled": 504000, "num_steps_trained": 84000, "num_agent_steps_trained": 504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 348, "training_iteration": 35, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-16-02", "timestamp": 1718187362, "time_this_iter_s": 22.177910566329956, "time_total_s": 777.7468745708466, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff303300e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 777.7468745708466, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 3.8625000000000003, "ram_util_percent": 41.803124999999994}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.2007285789049, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.533454763150814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2439829912382409, "mean_inference_ms": 0.46123804833188303, "mean_action_processing_ms": 0.08629544368492903, "mean_env_wait_ms": 8.381565103636103, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 86400, "timesteps_this_iter": 0, "agent_timesteps_total": 518400, "timers": {"sample_time_ms": 22373.962, "sample_throughput": 107.268, "load_time_ms": 0.132, "load_throughput": 18199836.558, "learn_time_ms": 118.019, "learn_throughput": 20335.744, "update_time_ms": 2.604}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 64633.51953125, "policy_entropy": 15387.702962239584, "policy_loss": -14141.839925130209, "vf_loss": 3653.215616861979}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 86400, "num_agent_steps_sampled": 518400, "num_steps_trained": 86400, "num_agent_steps_trained": 518400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 36, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-16-24", "timestamp": 1718187384, "time_this_iter_s": 22.312548875808716, "time_total_s": 800.0594234466553, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3032b9f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 800.0594234466553, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 4.025806451612904, "ram_util_percent": 41.90000000000002}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.3728431851631, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.56214053086054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.244022726421501, "mean_inference_ms": 0.46120347072208984, "mean_action_processing_ms": 0.08629646077966222, "mean_env_wait_ms": 8.382726752114209, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 88800, "timesteps_this_iter": 0, "agent_timesteps_total": 532800, "timers": {"sample_time_ms": 22334.098, "sample_throughput": 107.459, "load_time_ms": 0.132, "load_throughput": 18124468.131, "learn_time_ms": 117.869, "learn_throughput": 20361.531, "update_time_ms": 2.606}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72165.1328125, "policy_entropy": 15419.15380859375, "policy_loss": -16769.948404947918, "vf_loss": 3192.0154622395835}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 88800, "num_agent_steps_sampled": 532800, "num_steps_trained": 88800, "num_agent_steps_trained": 532800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 368, "training_iteration": 37, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-16-47", "timestamp": 1718187407, "time_this_iter_s": 22.215636253356934, "time_total_s": 822.2750597000122, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3103cb700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 822.2750597000122, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 3.984375, "ram_util_percent": 42.1}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.1604881973722, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.52674803289538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2440542229164318, "mean_inference_ms": 0.4611259372733228, "mean_action_processing_ms": 0.0862950485771553, "mean_env_wait_ms": 8.384028443919972, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 91200, "timesteps_this_iter": 0, "agent_timesteps_total": 547200, "timers": {"sample_time_ms": 22314.803, "sample_throughput": 107.552, "load_time_ms": 0.132, "load_throughput": 18166990.796, "learn_time_ms": 117.908, "learn_throughput": 20354.812, "update_time_ms": 2.552}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69888.5234375, "policy_entropy": 15444.742838541666, "policy_loss": -16059.679036458334, "vf_loss": 3232.2296142578125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 91200, "num_agent_steps_sampled": 547200, "num_steps_trained": 91200, "num_agent_steps_trained": 547200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 380, "training_iteration": 38, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-17-09", "timestamp": 1718187429, "time_this_iter_s": 22.4256751537323, "time_total_s": 844.7007348537445, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff310281a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 844.7007348537445, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 4.01875, "ram_util_percent": 42.29062499999999}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -266.5436833321326, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.42394722202212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2440781719174148, "mean_inference_ms": 0.46108934843601707, "mean_action_processing_ms": 0.08629419406441116, "mean_env_wait_ms": 8.384949847121515, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 93600, "timesteps_this_iter": 0, "agent_timesteps_total": 561600, "timers": {"sample_time_ms": 22328.903, "sample_throughput": 107.484, "load_time_ms": 0.133, "load_throughput": 18108166.217, "learn_time_ms": 117.642, "learn_throughput": 20400.869, "update_time_ms": 2.561}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50455.42578125, "policy_entropy": 15487.905598958334, "policy_loss": -17229.89111328125, "vf_loss": 2535.703572591146}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 93600, "num_agent_steps_sampled": 561600, "num_steps_trained": 93600, "num_agent_steps_trained": 561600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 388, "training_iteration": 39, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-17-31", "timestamp": 1718187451, "time_this_iter_s": 22.444056510925293, "time_total_s": 867.1447913646698, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff310281670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 867.1447913646698, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 4.10625, "ram_util_percent": 42.40625}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -265.69072121159985, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.28178686859997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24411857769781586, "mean_inference_ms": 0.46111057719383597, "mean_action_processing_ms": 0.08629595604952325, "mean_env_wait_ms": 8.386691790364761, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"sample_time_ms": 22376.835, "sample_throughput": 107.254, "load_time_ms": 0.131, "load_throughput": 18292439.76, "learn_time_ms": 117.213, "learn_throughput": 20475.584, "update_time_ms": 2.56}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70627.1953125, "policy_entropy": 15533.690592447916, "policy_loss": -14958.660400390625, "vf_loss": 2977.0108642578125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 576000, "num_steps_trained": 96000, "num_agent_steps_trained": 576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 40, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-17-54", "timestamp": 1718187474, "time_this_iter_s": 22.981159448623657, "time_total_s": 890.1259508132935, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f7625e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 890.1259508132935, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 4.3125, "ram_util_percent": 42.6}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -286.21832684437965, "episode_reward_mean": -265.45577439947374, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.703054474063116}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.24262906657898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24416887108387272, "mean_inference_ms": 0.4611873986862281, "mean_action_processing_ms": 0.08630110398472529, "mean_env_wait_ms": 8.388146896460615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 98400, "timesteps_this_iter": 0, "agent_timesteps_total": 590400, "timers": {"sample_time_ms": 22426.349, "sample_throughput": 107.017, "load_time_ms": 0.132, "load_throughput": 18249328.499, "learn_time_ms": 116.955, "learn_throughput": 20520.794, "update_time_ms": 2.58}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76946.03125, "policy_entropy": 15549.40673828125, "policy_loss": -13672.196085611979, "vf_loss": 3723.537109375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 98400, "num_agent_steps_sampled": 590400, "num_steps_trained": 98400, "num_agent_steps_trained": 590400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 408, "training_iteration": 41, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-18-17", "timestamp": 1718187497, "time_this_iter_s": 22.681607723236084, "time_total_s": 912.8075585365295, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff309f661f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 912.8075585365295, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 4.072727272727272, "ram_util_percent": 42.806060606060605}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -286.21832684437965, "episode_reward_mean": -265.97815130958196, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.703054474063116}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.32969188493034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.244300192663294, "mean_inference_ms": 0.46146037864902467, "mean_action_processing_ms": 0.08632328955767171, "mean_env_wait_ms": 8.391419589376632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 100800, "timesteps_this_iter": 0, "agent_timesteps_total": 604800, "timers": {"sample_time_ms": 22539.703, "sample_throughput": 106.479, "load_time_ms": 0.132, "load_throughput": 18134263.376, "learn_time_ms": 117.808, "learn_throughput": 20372.195, "update_time_ms": 2.587}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83792.9921875, "policy_entropy": 15574.2021484375, "policy_loss": -11576.363403320312, "vf_loss": 4302.3455810546875}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100800, "num_agent_steps_sampled": 604800, "num_steps_trained": 100800, "num_agent_steps_trained": 604800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 420, "training_iteration": 42, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-18-40", "timestamp": 1718187520, "time_this_iter_s": 23.27666139602661, "time_total_s": 936.0842199325562, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3103cb700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 936.0842199325562, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 4.151515151515151, "ram_util_percent": 43.00606060606061}}
{"episode_reward_max": -238.50207362604633, "episode_reward_min": -286.8203384202587, "episode_reward_mean": -266.6024923958398, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.80338973670989}, "policy_reward_max": {"shared_policy": -39.750345604341135}, "policy_reward_mean": {"shared_policy": -44.433748732639984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24441299638548422, "mean_inference_ms": 0.46168742004203744, "mean_action_processing_ms": 0.08634387304383422, "mean_env_wait_ms": 8.393895386002885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 103200, "timesteps_this_iter": 0, "agent_timesteps_total": 619200, "timers": {"sample_time_ms": 22603.39, "sample_throughput": 106.179, "load_time_ms": 0.134, "load_throughput": 17927568.299, "learn_time_ms": 117.489, "learn_throughput": 20427.373, "update_time_ms": 2.553}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58686.9375, "policy_entropy": 15574.79736328125, "policy_loss": -14553.977945963541, "vf_loss": 3519.991739908854}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 103200, "num_agent_steps_sampled": 619200, "num_steps_trained": 103200, "num_agent_steps_trained": 619200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 428, "training_iteration": 43, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-19-04", "timestamp": 1718187544, "time_this_iter_s": 23.077282667160034, "time_total_s": 959.1615025997162, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3103ff040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 959.1615025997162, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 4.199999999999999, "ram_util_percent": 43.2}}
{"episode_reward_max": -238.50207362604633, "episode_reward_min": -286.8203384202587, "episode_reward_mean": -266.47509669884477, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.80338973670989}, "policy_reward_max": {"shared_policy": -39.750345604341135}, "policy_reward_mean": {"shared_policy": -44.41251611647415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24457532973210433, "mean_inference_ms": 0.46202571036021345, "mean_action_processing_ms": 0.0863742579456837, "mean_env_wait_ms": 8.397476911786393, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 105600, "timesteps_this_iter": 0, "agent_timesteps_total": 633600, "timers": {"sample_time_ms": 22601.033, "sample_throughput": 106.19, "load_time_ms": 0.136, "load_throughput": 17691264.675, "learn_time_ms": 117.137, "learn_throughput": 20488.891, "update_time_ms": 2.54}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84687.0, "policy_entropy": 15584.817057291666, "policy_loss": -13569.533854166666, "vf_loss": 4067.823974609375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 105600, "num_agent_steps_sampled": 633600, "num_steps_trained": 105600, "num_agent_steps_trained": 633600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 440, "training_iteration": 44, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-19-26", "timestamp": 1718187566, "time_this_iter_s": 22.262912273406982, "time_total_s": 981.4244148731232, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102ab5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 981.4244148731232, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 4.09375, "ram_util_percent": 43.359375}}
{"episode_reward_max": -237.77630084133662, "episode_reward_min": -286.8203384202587, "episode_reward_mean": -266.32868361917286, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.80338973670989}, "policy_reward_max": {"shared_policy": -39.62938347355623}, "policy_reward_mean": {"shared_policy": -44.38811393652884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24468558801712922, "mean_inference_ms": 0.46225083224162217, "mean_action_processing_ms": 0.08639456932743476, "mean_env_wait_ms": 8.399897722473733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 108000, "timesteps_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"sample_time_ms": 22612.701, "sample_throughput": 106.135, "load_time_ms": 0.134, "load_throughput": 17930761.667, "learn_time_ms": 118.029, "learn_throughput": 20333.998, "update_time_ms": 2.545}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68193.4453125, "policy_entropy": 15594.437662760416, "policy_loss": -15092.864583333334, "vf_loss": 3082.277791341146}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 108000, "num_agent_steps_sampled": 648000, "num_steps_trained": 108000, "num_agent_steps_trained": 648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 448, "training_iteration": 45, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-19-48", "timestamp": 1718187588, "time_this_iter_s": 22.30601453781128, "time_total_s": 1003.7304294109344, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3032b9af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1003.7304294109344, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 4.028125, "ram_util_percent": 43.5}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -288.3924798661993, "episode_reward_mean": -266.18186313384075, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.06541331103312}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.36364385564015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2448567990488831, "mean_inference_ms": 0.46265662939594776, "mean_action_processing_ms": 0.08643296959635531, "mean_env_wait_ms": 8.403780063847144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 110400, "timesteps_this_iter": 0, "agent_timesteps_total": 662400, "timers": {"sample_time_ms": 22655.476, "sample_throughput": 105.935, "load_time_ms": 0.136, "load_throughput": 17613875.066, "learn_time_ms": 119.159, "learn_throughput": 20141.11, "update_time_ms": 2.562}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83355.0, "policy_entropy": 15609.745930989584, "policy_loss": -14798.821126302084, "vf_loss": 3219.070556640625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 110400, "num_agent_steps_sampled": 662400, "num_steps_trained": 110400, "num_agent_steps_trained": 662400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 460, "training_iteration": 46, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-20-11", "timestamp": 1718187611, "time_this_iter_s": 22.742749214172363, "time_total_s": 1026.4731786251068, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f2780d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1026.4731786251068, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 4.134375, "ram_util_percent": 43.7}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -288.3924798661993, "episode_reward_mean": -266.03971593724197, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.06541331103312}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.33995265620701}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24498012304320985, "mean_inference_ms": 0.4629652040014501, "mean_action_processing_ms": 0.08646025346695581, "mean_env_wait_ms": 8.406501762146355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 112800, "timesteps_this_iter": 0, "agent_timesteps_total": 676800, "timers": {"sample_time_ms": 22691.622, "sample_throughput": 105.766, "load_time_ms": 0.137, "load_throughput": 17552449.172, "learn_time_ms": 119.405, "learn_throughput": 20099.688, "update_time_ms": 2.593}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81581.0703125, "policy_entropy": 15639.788899739584, "policy_loss": -17187.53271484375, "vf_loss": 2636.1374715169272}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 112800, "num_agent_steps_sampled": 676800, "num_steps_trained": 112800, "num_agent_steps_trained": 676800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 468, "training_iteration": 47, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-20-33", "timestamp": 1718187633, "time_this_iter_s": 22.568722248077393, "time_total_s": 1049.0419008731842, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30fb36e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1049.0419008731842, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 4.340625, "ram_util_percent": 43.9}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.15687529766524, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.359479216277556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24514159900893084, "mean_inference_ms": 0.46338733546617356, "mean_action_processing_ms": 0.08649792348826123, "mean_env_wait_ms": 8.410453547743742, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 115200, "timesteps_this_iter": 0, "agent_timesteps_total": 691200, "timers": {"sample_time_ms": 22687.972, "sample_throughput": 105.783, "load_time_ms": 0.136, "load_throughput": 17583108.472, "learn_time_ms": 119.319, "learn_throughput": 20114.138, "update_time_ms": 2.584}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 95676.25, "policy_entropy": 15658.543619791666, "policy_loss": -15001.37929280599, "vf_loss": 3288.0231323242188}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 115200, "num_agent_steps_sampled": 691200, "num_steps_trained": 115200, "num_agent_steps_trained": 691200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 48, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-20-56", "timestamp": 1718187656, "time_this_iter_s": 22.38437056541443, "time_total_s": 1071.4262714385986, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30ff951f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1071.4262714385986, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 4.165625, "ram_util_percent": 44.0}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.39736210344205, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.399560350573694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24535073324477571, "mean_inference_ms": 0.4637793610938739, "mean_action_processing_ms": 0.08653407293561514, "mean_env_wait_ms": 8.41354727546202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 117600, "timesteps_this_iter": 0, "agent_timesteps_total": 705600, "timers": {"sample_time_ms": 22682.421, "sample_throughput": 105.809, "load_time_ms": 0.137, "load_throughput": 17488411.397, "learn_time_ms": 119.543, "learn_throughput": 20076.389, "update_time_ms": 2.566}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85397.6640625, "policy_entropy": 15661.671223958334, "policy_loss": -9231.867594401041, "vf_loss": 4567.202657063802}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 117600, "num_agent_steps_sampled": 705600, "num_steps_trained": 117600, "num_agent_steps_trained": 705600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 492, "training_iteration": 49, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-21-18", "timestamp": 1718187678, "time_this_iter_s": 22.391292333602905, "time_total_s": 1093.8175637722015, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff309f66040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1093.8175637722015, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 4.03125, "ram_util_percent": 44.2}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.45812285915036, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.40968714319176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24540505677375266, "mean_inference_ms": 0.46398425756052136, "mean_action_processing_ms": 0.0865512316149307, "mean_env_wait_ms": 8.41598103713762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 22631.522, "sample_throughput": 106.047, "load_time_ms": 0.137, "load_throughput": 17482336.923, "learn_time_ms": 119.879, "learn_throughput": 20020.178, "update_time_ms": 2.557}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93811.3984375, "policy_entropy": 15668.230794270834, "policy_loss": -12242.403844197592, "vf_loss": 3667.927978515625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 720000, "num_steps_trained": 120000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -249.321005438085, "episode_reward_min": -275.7620185295645, "episode_reward_mean": -262.5388544393219, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -45.96033642159409}, "policy_reward_max": {"shared_policy": -41.55350090634758}, "policy_reward_mean": {"shared_policy": -43.75647573988701}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-271.2515556345293, -249.321005438085, -264.8493322739079, -275.7620185295645, -273.98614030707716, -269.40588412474443, -269.30367536465644, -251.68890546074914, -249.38406479099422, -250.43596246891067], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.208592605755015, -45.208592605755015, -45.208592605755015, -45.208592605755015, -45.208592605755015, -45.208592605755015, -41.55350090634758, -41.55350090634758, -41.55350090634758, -41.55350090634758, -41.55350090634758, -41.55350090634758, -44.14155537898463, -44.14155537898463, -44.14155537898463, -44.14155537898463, -44.14155537898463, -44.14155537898463, -45.96033642159409, -45.96033642159409, -45.96033642159409, -45.96033642159409, -45.96033642159409, -45.96033642159409, -45.664356717846125, -45.664356717846125, -45.664356717846125, -45.664356717846125, -45.664356717846125, -45.664356717846125, -44.90098068745729, -44.90098068745729, -44.90098068745729, -44.90098068745729, -44.90098068745729, -44.90098068745729, -44.883945894109374, -44.883945894109374, -44.883945894109374, -44.883945894109374, -44.883945894109374, -44.883945894109374, -41.948150910124994, -41.948150910124994, -41.948150910124994, -41.948150910124994, -41.948150910124994, -41.948150910124994, -41.56401079849923, -41.56401079849923, -41.56401079849923, -41.56401079849923, -41.56401079849923, -41.56401079849923, -41.73932707815176, -41.73932707815176, -41.73932707815176, -41.73932707815176, -41.73932707815176, -41.73932707815176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1895391806455299, "mean_inference_ms": 0.4711931891543054, "mean_action_processing_ms": 0.08531227016090001, "mean_env_wait_ms": 8.302136775790174, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 500, "training_iteration": 50, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-22-02", "timestamp": 1718187722, "time_this_iter_s": 44.117348432540894, "time_total_s": 1137.9349122047424, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff303300c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1137.9349122047424, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 4.158730158730159, "ram_util_percent": 44.457142857142856}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -267.1410108088765, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.52350180147945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24558089171824116, "mean_inference_ms": 0.4642596207427087, "mean_action_processing_ms": 0.08658136118879396, "mean_env_wait_ms": 8.418365988972393, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 122400, "timesteps_this_iter": 0, "agent_timesteps_total": 734400, "timers": {"sample_time_ms": 24821.698, "sample_throughput": 96.69, "load_time_ms": 0.138, "load_throughput": 17385716.062, "learn_time_ms": 119.871, "learn_throughput": 20021.587, "update_time_ms": 2.547}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88096.09375, "policy_entropy": 15676.479654947916, "policy_loss": -11584.405192057291, "vf_loss": 4522.204895019531}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 122400, "num_agent_steps_sampled": 734400, "num_steps_trained": 122400, "num_agent_steps_trained": 734400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 512, "training_iteration": 51, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-22-25", "timestamp": 1718187745, "time_this_iter_s": 22.93411922454834, "time_total_s": 1160.8690314292908, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3033005e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1160.8690314292908, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 4.1625, "ram_util_percent": 44.55624999999999}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.50433996097587, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.417389993496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24561096057638687, "mean_inference_ms": 0.4644051762831982, "mean_action_processing_ms": 0.08659261929143809, "mean_env_wait_ms": 8.420433929894823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 124800, "timesteps_this_iter": 0, "agent_timesteps_total": 748800, "timers": {"sample_time_ms": 24764.568, "sample_throughput": 96.913, "load_time_ms": 0.138, "load_throughput": 17376712.584, "learn_time_ms": 118.928, "learn_throughput": 20180.349, "update_time_ms": 2.547}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 87172.5859375, "policy_entropy": 15700.79248046875, "policy_loss": -13942.722493489584, "vf_loss": 3376.796915690104}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124800, "num_agent_steps_sampled": 748800, "num_steps_trained": 124800, "num_agent_steps_trained": 748800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 520, "training_iteration": 52, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-22-48", "timestamp": 1718187768, "time_this_iter_s": 22.69847822189331, "time_total_s": 1183.567509651184, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff303300940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1183.567509651184, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 4.3062499999999995, "ram_util_percent": 44.7}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -267.0121373006699, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.502022883444994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24572482942023158, "mean_inference_ms": 0.46454261349281645, "mean_action_processing_ms": 0.08660725994565947, "mean_env_wait_ms": 8.421652740817906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 127200, "timesteps_this_iter": 0, "agent_timesteps_total": 763200, "timers": {"sample_time_ms": 24693.103, "sample_throughput": 97.193, "load_time_ms": 0.143, "load_throughput": 16782810.27, "learn_time_ms": 118.962, "learn_throughput": 20174.505, "update_time_ms": 2.563}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89428.1640625, "policy_entropy": 15696.187337239584, "policy_loss": -13900.506754557291, "vf_loss": 3847.756062825521}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 127200, "num_agent_steps_sampled": 763200, "num_steps_trained": 127200, "num_agent_steps_trained": 763200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 532, "training_iteration": 53, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-23-10", "timestamp": 1718187790, "time_this_iter_s": 22.376338243484497, "time_total_s": 1205.9438478946686, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30fb363a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1205.9438478946686, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 4.146875, "ram_util_percent": 44.9}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -267.02859678561634, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.50476613093606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2457319711918621, "mean_inference_ms": 0.4646350648914236, "mean_action_processing_ms": 0.08661258045653039, "mean_env_wait_ms": 8.423462771178054, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 129600, "timesteps_this_iter": 0, "agent_timesteps_total": 777600, "timers": {"sample_time_ms": 24726.503, "sample_throughput": 97.062, "load_time_ms": 0.143, "load_throughput": 16749300.499, "learn_time_ms": 119.692, "learn_throughput": 20051.495, "update_time_ms": 2.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88375.6953125, "policy_entropy": 15720.23388671875, "policy_loss": -15603.08203125, "vf_loss": 2871.2758992513022}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 129600, "num_agent_steps_sampled": 777600, "num_steps_trained": 129600, "num_agent_steps_trained": 777600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 540, "training_iteration": 54, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-23-33", "timestamp": 1718187813, "time_this_iter_s": 22.602843523025513, "time_total_s": 1228.546691417694, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3033005e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1228.546691417694, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 4.0375, "ram_util_percent": 45.1}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.6870614165579, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.44784356942632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24588417025728185, "mean_inference_ms": 0.4649231670913718, "mean_action_processing_ms": 0.08663635113000102, "mean_env_wait_ms": 8.425626137582533, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 132000, "timesteps_this_iter": 0, "agent_timesteps_total": 792000, "timers": {"sample_time_ms": 24851.662, "sample_throughput": 96.573, "load_time_ms": 0.144, "load_throughput": 16655078.756, "learn_time_ms": 119.898, "learn_throughput": 20016.997, "update_time_ms": 2.648}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56497.46875, "policy_entropy": 15738.565755208334, "policy_loss": -15936.579264322916, "vf_loss": 2724.2368774414062}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 132000, "num_agent_steps_sampled": 792000, "num_steps_trained": 132000, "num_agent_steps_trained": 792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 552, "training_iteration": 55, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-23-57", "timestamp": 1718187837, "time_this_iter_s": 23.553452968597412, "time_total_s": 1252.1001443862915, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102ab5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1252.1001443862915, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 4.097058823529412, "ram_util_percent": 45.29705882352941}}
{"episode_reward_max": -234.7991415140505, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.9694135251146, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.133190252341585}, "policy_reward_mean": {"shared_policy": -44.494902254185774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24591877471155194, "mean_inference_ms": 0.4651228906002015, "mean_action_processing_ms": 0.0866491381424371, "mean_env_wait_ms": 8.428069425847887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 134400, "timesteps_this_iter": 0, "agent_timesteps_total": 806400, "timers": {"sample_time_ms": 24865.815, "sample_throughput": 96.518, "load_time_ms": 0.143, "load_throughput": 16735377.556, "learn_time_ms": 119.271, "learn_throughput": 20122.268, "update_time_ms": 2.643}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65737.34375, "policy_entropy": 15733.137532552084, "policy_loss": -14151.743815104166, "vf_loss": 3164.2061157226562}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 134400, "num_agent_steps_sampled": 806400, "num_steps_trained": 134400, "num_agent_steps_trained": 806400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 560, "training_iteration": 56, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-24-20", "timestamp": 1718187860, "time_this_iter_s": 22.874682188034058, "time_total_s": 1274.9748265743256, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102abaf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1274.9748265743256, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 4.0625, "ram_util_percent": 45.4}}
{"episode_reward_max": -234.7991415140505, "episode_reward_min": -289.92327201439633, "episode_reward_mean": -266.5307158271932, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.32054533573257}, "policy_reward_max": {"shared_policy": -39.133190252341585}, "policy_reward_mean": {"shared_policy": -44.42178597119888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24606350983311073, "mean_inference_ms": 0.46538453400297236, "mean_action_processing_ms": 0.08667253551443188, "mean_env_wait_ms": 8.43001969619376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 136800, "timesteps_this_iter": 0, "agent_timesteps_total": 820800, "timers": {"sample_time_ms": 24853.724, "sample_throughput": 96.565, "load_time_ms": 0.143, "load_throughput": 16782810.27, "learn_time_ms": 119.384, "learn_throughput": 20103.26, "update_time_ms": 2.639}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 78454.0703125, "policy_entropy": 15753.049967447916, "policy_loss": -7828.5131098429365, "vf_loss": 5157.7210693359375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 136800, "num_agent_steps_sampled": 820800, "num_steps_trained": 136800, "num_agent_steps_trained": 820800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 572, "training_iteration": 57, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-24-42", "timestamp": 1718187882, "time_this_iter_s": 22.45364236831665, "time_total_s": 1297.4284689426422, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f2fc790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1297.4284689426422, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 3.96875, "ram_util_percent": 45.6}}
{"episode_reward_max": -234.7991415140505, "episode_reward_min": -289.92327201439633, "episode_reward_mean": -266.56005917711195, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.32054533573257}, "policy_reward_max": {"shared_policy": -39.133190252341585}, "policy_reward_mean": {"shared_policy": -44.42667652951867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24610661508099463, "mean_inference_ms": 0.4655743928184175, "mean_action_processing_ms": 0.08668740104181653, "mean_env_wait_ms": 8.432533465043294, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 139200, "timesteps_this_iter": 0, "agent_timesteps_total": 835200, "timers": {"sample_time_ms": 24870.102, "sample_throughput": 96.501, "load_time_ms": 0.144, "load_throughput": 16649569.302, "learn_time_ms": 119.546, "learn_throughput": 20075.981, "update_time_ms": 2.657}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 86374.8046875, "policy_entropy": 15742.207356770834, "policy_loss": -11760.131546020508, "vf_loss": 4011.425252278646}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 139200, "num_agent_steps_sampled": 835200, "num_steps_trained": 139200, "num_agent_steps_trained": 835200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 580, "training_iteration": 58, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-25-05", "timestamp": 1718187905, "time_this_iter_s": 22.549264669418335, "time_total_s": 1319.9777336120605, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102ab4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1319.9777336120605, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 4.0625, "ram_util_percent": 45.796875}}
{"episode_reward_max": -234.7991415140505, "episode_reward_min": -289.92327201439633, "episode_reward_mean": -267.2730106783173, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.32054533573257}, "policy_reward_max": {"shared_policy": -39.133190252341585}, "policy_reward_mean": {"shared_policy": -44.54550177971955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24622705554902385, "mean_inference_ms": 0.46590329675930975, "mean_action_processing_ms": 0.08671690748440034, "mean_env_wait_ms": 8.435680386912145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 141600, "timesteps_this_iter": 0, "agent_timesteps_total": 849600, "timers": {"sample_time_ms": 24935.164, "sample_throughput": 96.25, "load_time_ms": 0.144, "load_throughput": 16682680.809, "learn_time_ms": 120.007, "learn_throughput": 19998.879, "update_time_ms": 2.666}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69195.0234375, "policy_entropy": 15760.3115234375, "policy_loss": -9771.46533203125, "vf_loss": 4701.761311848958}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 141600, "num_agent_steps_sampled": 849600, "num_steps_trained": 141600, "num_agent_steps_trained": 849600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 592, "training_iteration": 59, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-25-28", "timestamp": 1718187928, "time_this_iter_s": 23.04492473602295, "time_total_s": 1343.0226583480835, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30fb36430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1343.0226583480835, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 4.121212121212121, "ram_util_percent": 45.96666666666667}}
{"episode_reward_max": -234.7991415140505, "episode_reward_min": -289.92327201439633, "episode_reward_mean": -267.17994112366915, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.32054533573257}, "policy_reward_max": {"shared_policy": -39.133190252341585}, "policy_reward_mean": {"shared_policy": -44.52999018727819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24632758753547798, "mean_inference_ms": 0.4661670293442559, "mean_action_processing_ms": 0.08673933324935276, "mean_env_wait_ms": 8.438010233120751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"sample_time_ms": 25000.125, "sample_throughput": 96.0, "load_time_ms": 0.145, "load_throughput": 16567362.739, "learn_time_ms": 119.919, "learn_throughput": 20013.451, "update_time_ms": 2.676}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80895.0078125, "policy_entropy": 15785.047688802084, "policy_loss": -12952.658854166666, "vf_loss": 3519.1292317708335}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 864000, "num_steps_trained": 144000, "num_agent_steps_trained": 864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 600, "training_iteration": 60, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-25-51", "timestamp": 1718187951, "time_this_iter_s": 23.117817878723145, "time_total_s": 1366.1404762268066, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f2fc790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1366.1404762268066, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 4.163636363636364, "ram_util_percent": 46.1}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.69743094142615, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.61623849023768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24646899706773134, "mean_inference_ms": 0.4665670671432466, "mean_action_processing_ms": 0.08677206533977694, "mean_env_wait_ms": 8.441447251443492, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 146400, "timesteps_this_iter": 0, "agent_timesteps_total": 878400, "timers": {"sample_time_ms": 22847.213, "sample_throughput": 105.046, "load_time_ms": 0.144, "load_throughput": 16702056.745, "learn_time_ms": 120.791, "learn_throughput": 19869.041, "update_time_ms": 2.703}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107315.7109375, "policy_entropy": 15791.979654947916, "policy_loss": -12663.299235026041, "vf_loss": 4004.5721842447915}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 146400, "num_agent_steps_sampled": 878400, "num_steps_trained": 146400, "num_agent_steps_trained": 878400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 612, "training_iteration": 61, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-26-14", "timestamp": 1718187974, "time_this_iter_s": 23.061506986618042, "time_total_s": 1389.2019832134247, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff303300ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1389.2019832134247, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 4.260606060606061, "ram_util_percent": 46.306060606060605}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.96618266701114, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.66103044450185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24662258198269768, "mean_inference_ms": 0.466827199341364, "mean_action_processing_ms": 0.08679344891714103, "mean_env_wait_ms": 8.443634441938203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 148800, "timesteps_this_iter": 0, "agent_timesteps_total": 892800, "timers": {"sample_time_ms": 22853.622, "sample_throughput": 105.016, "load_time_ms": 0.143, "load_throughput": 16796812.281, "learn_time_ms": 121.688, "learn_throughput": 19722.603, "update_time_ms": 2.741}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84821.25, "policy_entropy": 15810.775390625, "policy_loss": -14592.739908854166, "vf_loss": 2799.7547810872397}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 148800, "num_agent_steps_sampled": 892800, "num_steps_trained": 148800, "num_agent_steps_trained": 892800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 620, "training_iteration": 62, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-26-37", "timestamp": 1718187997, "time_this_iter_s": 22.76211380958557, "time_total_s": 1411.9640970230103, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30ff95430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1411.9640970230103, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 4.078125, "ram_util_percent": 46.46875}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.1798271580693, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.529971193011555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24685778042065473, "mean_inference_ms": 0.4672426764365628, "mean_action_processing_ms": 0.08682699247123543, "mean_env_wait_ms": 8.447081590927084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 151200, "timesteps_this_iter": 0, "agent_timesteps_total": 907200, "timers": {"sample_time_ms": 22888.836, "sample_throughput": 104.855, "load_time_ms": 0.139, "load_throughput": 17293127.641, "learn_time_ms": 122.391, "learn_throughput": 19609.23, "update_time_ms": 2.73}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89530.75, "policy_entropy": 15833.539876302084, "policy_loss": -14754.805501302084, "vf_loss": 2655.8277587890625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 151200, "num_agent_steps_sampled": 907200, "num_steps_trained": 151200, "num_agent_steps_trained": 907200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 632, "training_iteration": 63, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-26-59", "timestamp": 1718188019, "time_this_iter_s": 22.719723224639893, "time_total_s": 1434.6838202476501, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff303300940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1434.6838202476501, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 4.046875, "ram_util_percent": 46.6}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -266.98442476152445, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.49740412692073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24701259650865937, "mean_inference_ms": 0.46751041481080563, "mean_action_processing_ms": 0.08684836514991931, "mean_env_wait_ms": 8.449270106320904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 153600, "timesteps_this_iter": 0, "agent_timesteps_total": 921600, "timers": {"sample_time_ms": 22879.168, "sample_throughput": 104.899, "load_time_ms": 0.139, "load_throughput": 17302044.689, "learn_time_ms": 121.745, "learn_throughput": 19713.372, "update_time_ms": 2.691}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99721.7734375, "policy_entropy": 15850.87109375, "policy_loss": -13065.872395833334, "vf_loss": 3230.0233764648438}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 153600, "num_agent_steps_sampled": 921600, "num_steps_trained": 153600, "num_agent_steps_trained": 921600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 640, "training_iteration": 64, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-27-22", "timestamp": 1718188042, "time_this_iter_s": 22.4925320148468, "time_total_s": 1457.176352262497, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102aba60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1457.176352262497, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 4.003125, "ram_util_percent": 46.8}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.12807127442767, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.5213452124046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24721426273581937, "mean_inference_ms": 0.46780712649018286, "mean_action_processing_ms": 0.0868741536166951, "mean_env_wait_ms": 8.452003917313641, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 156000, "timesteps_this_iter": 0, "agent_timesteps_total": 936000, "timers": {"sample_time_ms": 22818.343, "sample_throughput": 105.179, "load_time_ms": 0.139, "load_throughput": 17269393.721, "learn_time_ms": 123.134, "learn_throughput": 19490.977, "update_time_ms": 2.718}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120120.4453125, "policy_entropy": 15875.141927083334, "policy_loss": -6784.484537760417, "vf_loss": 5811.3206787109375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 156000, "num_agent_steps_sampled": 936000, "num_steps_trained": 156000, "num_agent_steps_trained": 936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 652, "training_iteration": 65, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-27-45", "timestamp": 1718188065, "time_this_iter_s": 22.96597671508789, "time_total_s": 1480.1423289775848, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff310281160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1480.1423289775848, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 4.254545454545455, "ram_util_percent": 47.04242424242424}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.4697720830922, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.578295347182035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24736182309155003, "mean_inference_ms": 0.4680198872927036, "mean_action_processing_ms": 0.08689284927855909, "mean_env_wait_ms": 8.453960685891154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 158400, "timesteps_this_iter": 0, "agent_timesteps_total": 950400, "timers": {"sample_time_ms": 22869.095, "sample_throughput": 104.945, "load_time_ms": 0.138, "load_throughput": 17364722.443, "learn_time_ms": 123.497, "learn_throughput": 19433.654, "update_time_ms": 2.742}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70716.328125, "policy_entropy": 15881.264485677084, "policy_loss": -11169.085327148438, "vf_loss": 4294.070251464844}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 158400, "num_agent_steps_sampled": 950400, "num_steps_trained": 158400, "num_agent_steps_trained": 950400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 660, "training_iteration": 66, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-28-08", "timestamp": 1718188088, "time_this_iter_s": 23.371506452560425, "time_total_s": 1503.5138354301453, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3103cbee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1503.5138354301453, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 4.457575757575757, "ram_util_percent": 47.5030303030303}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.6040873012191, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.60068121686985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24760099865466853, "mean_inference_ms": 0.4684228101253488, "mean_action_processing_ms": 0.08692531820022383, "mean_env_wait_ms": 8.457211820880808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 160800, "timesteps_this_iter": 0, "agent_timesteps_total": 964800, "timers": {"sample_time_ms": 22934.317, "sample_throughput": 104.647, "load_time_ms": 0.14, "load_throughput": 17148772.743, "learn_time_ms": 123.313, "learn_throughput": 19462.736, "update_time_ms": 2.751}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91109.9765625, "policy_entropy": 15891.60107421875, "policy_loss": -8358.739990234375, "vf_loss": 5023.783711751302}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160800, "num_agent_steps_sampled": 964800, "num_steps_trained": 160800, "num_agent_steps_trained": 964800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 672, "training_iteration": 67, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-28-31", "timestamp": 1718188111, "time_this_iter_s": 23.101804494857788, "time_total_s": 1526.615639925003, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102818b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1526.615639925003, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 4.654545454545454, "ram_util_percent": 47.82121212121213}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -290.157506739972, "episode_reward_mean": -266.8380944246931, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.473015737448854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2477728668335678, "mean_inference_ms": 0.4687253249942714, "mean_action_processing_ms": 0.0869493420110555, "mean_env_wait_ms": 8.459628404524956, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 163200, "timesteps_this_iter": 0, "agent_timesteps_total": 979200, "timers": {"sample_time_ms": 23006.748, "sample_throughput": 104.317, "load_time_ms": 0.141, "load_throughput": 16983852.877, "learn_time_ms": 125.046, "learn_throughput": 19192.865, "update_time_ms": 2.776}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97446.8203125, "policy_entropy": 15930.0966796875, "policy_loss": -10864.460815429688, "vf_loss": 3427.4101765950522}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 163200, "num_agent_steps_sampled": 979200, "num_steps_trained": 163200, "num_agent_steps_trained": 979200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 680, "training_iteration": 68, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-28-55", "timestamp": 1718188135, "time_this_iter_s": 23.292940855026245, "time_total_s": 1549.9085807800293, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f2fc0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1549.9085807800293, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 5.590909090909091, "ram_util_percent": 51.24545454545455}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -290.157506739972, "episode_reward_mean": -266.59019622957726, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.431699371596196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24801101817669705, "mean_inference_ms": 0.46914258382007323, "mean_action_processing_ms": 0.08698299638820992, "mean_env_wait_ms": 8.463026039969352, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 165600, "timesteps_this_iter": 0, "agent_timesteps_total": 993600, "timers": {"sample_time_ms": 22990.204, "sample_throughput": 104.392, "load_time_ms": 0.142, "load_throughput": 16875657.334, "learn_time_ms": 125.84, "learn_throughput": 19071.863, "update_time_ms": 2.77}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 82152.6640625, "policy_entropy": 15960.308268229166, "policy_loss": -11130.3466796875, "vf_loss": 4019.6869099934897}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 165600, "num_agent_steps_sampled": 993600, "num_steps_trained": 165600, "num_agent_steps_trained": 993600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 692, "training_iteration": 69, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-29-18", "timestamp": 1718188158, "time_this_iter_s": 22.869324207305908, "time_total_s": 1572.7779049873352, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30ff95040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1572.7779049873352, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 4.365625, "ram_util_percent": 51.6}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -290.157506739972, "episode_reward_mean": -266.48795865455213, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.414659775758686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24816772761930145, "mean_inference_ms": 0.469427357276711, "mean_action_processing_ms": 0.08700681785801236, "mean_env_wait_ms": 8.465350782102474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 1008000, "timers": {"sample_time_ms": 23024.914, "sample_throughput": 104.235, "load_time_ms": 0.143, "load_throughput": 16782810.27, "learn_time_ms": 125.69, "learn_throughput": 19094.608, "update_time_ms": 2.789}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71003.6484375, "policy_entropy": 16010.295735677084, "policy_loss": -13670.41796875, "vf_loss": 2766.167195638021}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 1008000, "num_steps_trained": 168000, "num_agent_steps_trained": 1008000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 700, "training_iteration": 70, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-29-41", "timestamp": 1718188181, "time_this_iter_s": 23.4559166431427, "time_total_s": 1596.233821630478, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff309f663a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1596.233821630478, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 5.520588235294118, "ram_util_percent": 51.49411764705882}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -286.5458245508027, "episode_reward_mean": -265.5422650669581, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.75763742513379}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.25704417782635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2484056932633086, "mean_inference_ms": 0.4698556565747997, "mean_action_processing_ms": 0.08704307874010615, "mean_env_wait_ms": 8.469049193753147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 170400, "timesteps_this_iter": 0, "agent_timesteps_total": 1022400, "timers": {"sample_time_ms": 23075.575, "sample_throughput": 104.006, "load_time_ms": 0.149, "load_throughput": 16155239.287, "learn_time_ms": 125.946, "learn_throughput": 19055.718, "update_time_ms": 2.805}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68551.78125, "policy_entropy": 16040.66552734375, "policy_loss": -14389.313313802084, "vf_loss": 2627.3358154296875}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 170400, "num_agent_steps_sampled": 1022400, "num_steps_trained": 170400, "num_agent_steps_trained": 1022400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 712, "training_iteration": 71, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-30-05", "timestamp": 1718188205, "time_this_iter_s": 23.572118759155273, "time_total_s": 1619.8059403896332, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30ff953a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1619.8059403896332, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 5.148484848484848, "ram_util_percent": 50.33939393939395}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -286.5458245508027, "episode_reward_mean": -265.9439506739033, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.75763742513379}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.323991778983874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24851612198232986, "mean_inference_ms": 0.47016881292898577, "mean_action_processing_ms": 0.08707063395582541, "mean_env_wait_ms": 8.47171063185342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 172800, "timesteps_this_iter": 0, "agent_timesteps_total": 1036800, "timers": {"sample_time_ms": 23131.019, "sample_throughput": 103.757, "load_time_ms": 0.152, "load_throughput": 15810161.143, "learn_time_ms": 127.51, "learn_throughput": 18822.046, "update_time_ms": 2.799}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 82491.3515625, "policy_entropy": 16053.37744140625, "policy_loss": -13050.414388020834, "vf_loss": 3415.3317057291665}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172800, "num_agent_steps_sampled": 1036800, "num_steps_trained": 172800, "num_agent_steps_trained": 1036800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 720, "training_iteration": 72, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-30-28", "timestamp": 1718188228, "time_this_iter_s": 23.329038858413696, "time_total_s": 1643.1349792480469, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff309f0eee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1643.1349792480469, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 4.7272727272727275, "ram_util_percent": 50.6}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -286.5458245508027, "episode_reward_mean": -266.25599544944214, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.75763742513379}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.37599924157369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2486904879207033, "mean_inference_ms": 0.4706684395902926, "mean_action_processing_ms": 0.08711542950845734, "mean_env_wait_ms": 8.476055670134524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 175200, "timesteps_this_iter": 0, "agent_timesteps_total": 1051200, "timers": {"sample_time_ms": 23206.379, "sample_throughput": 103.42, "load_time_ms": 0.152, "load_throughput": 15755720.144, "learn_time_ms": 128.444, "learn_throughput": 18685.157, "update_time_ms": 2.805}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69670.953125, "policy_entropy": 16056.8857421875, "policy_loss": -5579.626871744792, "vf_loss": 6309.269775390625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 175200, "num_agent_steps_sampled": 1051200, "num_steps_trained": 175200, "num_agent_steps_trained": 1051200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 732, "training_iteration": 73, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-30-51", "timestamp": 1718188251, "time_this_iter_s": 23.47364616394043, "time_total_s": 1666.6086254119873, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3032b9ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1666.6086254119873, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 4.455882352941177, "ram_util_percent": 50.80294117647059}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -286.5458245508027, "episode_reward_mean": -266.31862303806537, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.75763742513379}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.3864371730109}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2488220842329013, "mean_inference_ms": 0.4710393584031985, "mean_action_processing_ms": 0.08714936784050556, "mean_env_wait_ms": 8.479236663170887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 177600, "timesteps_this_iter": 0, "agent_timesteps_total": 1065600, "timers": {"sample_time_ms": 23296.137, "sample_throughput": 103.021, "load_time_ms": 0.154, "load_throughput": 15580141.774, "learn_time_ms": 129.917, "learn_throughput": 18473.384, "update_time_ms": 2.821}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88492.1171875, "policy_entropy": 16098.33935546875, "policy_loss": -9245.453043619791, "vf_loss": 4411.421162923177}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 177600, "num_agent_steps_sampled": 1065600, "num_steps_trained": 177600, "num_agent_steps_trained": 1065600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 740, "training_iteration": 74, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-31-15", "timestamp": 1718188275, "time_this_iter_s": 23.394392728805542, "time_total_s": 1690.0030181407928, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f278a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1690.0030181407928, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 4.5, "ram_util_percent": 51.0}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -286.5458245508027, "episode_reward_mean": -266.098517441167, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.75763742513379}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.34975290686117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594, -269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24902659031424815, "mean_inference_ms": 0.47161563816984936, "mean_action_processing_ms": 0.08720191472237034, "mean_env_wait_ms": 8.484158948544797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 1080000, "timers": {"sample_time_ms": 23343.502, "sample_throughput": 102.812, "load_time_ms": 0.154, "load_throughput": 15546454.981, "learn_time_ms": 128.638, "learn_throughput": 18657.068, "update_time_ms": 2.765}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 119169.875, "policy_entropy": 16116.379231770834, "policy_loss": -7698.2397537231445, "vf_loss": 5465.4846598307295}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 1080000, "num_steps_trained": 180000, "num_agent_steps_trained": 1080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 752, "training_iteration": 75, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-31-38", "timestamp": 1718188298, "time_this_iter_s": 23.41058874130249, "time_total_s": 1713.4136068820953, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff303300430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1713.4136068820953, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 4.5636363636363635, "ram_util_percent": 51.1}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -285.17754581490084, "episode_reward_mean": -265.98778878576604, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.5295909691499}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.331298130960995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594, -269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307, -248.83184814567454, -275.18103124295595, -275.07586402324046, -277.6598626515851, -273.4704312757406, -277.9522970775527, -271.8878390567573, -263.9965293168343], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24915898979830733, "mean_inference_ms": 0.4719751818020872, "mean_action_processing_ms": 0.08723609123508844, "mean_env_wait_ms": 8.487399753774861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 182400, "timesteps_this_iter": 0, "agent_timesteps_total": 1094400, "timers": {"sample_time_ms": 23353.527, "sample_throughput": 102.768, "load_time_ms": 0.157, "load_throughput": 15270524.272, "learn_time_ms": 130.306, "learn_throughput": 18418.245, "update_time_ms": 2.769}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112669.5390625, "policy_entropy": 16132.99365234375, "policy_loss": -11431.525594075521, "vf_loss": 3801.7403564453125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 182400, "num_agent_steps_sampled": 1094400, "num_steps_trained": 182400, "num_agent_steps_trained": 1094400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 760, "training_iteration": 76, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-32-02", "timestamp": 1718188322, "time_this_iter_s": 23.502482414245605, "time_total_s": 1736.916089296341, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30f2fc160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1736.916089296341, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 4.758823529411764, "ram_util_percent": 51.305882352941175}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -285.17754581490084, "episode_reward_mean": -265.78029301155675, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.5295909691499}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.296715501926116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594, -269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307, -248.83184814567454, -275.18103124295595, -275.07586402324046, -277.6598626515851, -273.4704312757406, -277.9522970775527, -271.8878390567573, -263.9965293168343, -262.02079130638896, -274.1842955591486, -267.1425271429011, -236.97766294790603, -276.3482504161905, -241.19705747187166, -271.5746826355475, -252.55188369218004, -268.7707693246346, -279.9586312060408, -276.0904082740506, -266.53215204277876], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24936157989214627, "mean_inference_ms": 0.47251012276165766, "mean_action_processing_ms": 0.08728841924968415, "mean_env_wait_ms": 8.492366228818616, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 184800, "timesteps_this_iter": 0, "agent_timesteps_total": 1108800, "timers": {"sample_time_ms": 23396.041, "sample_throughput": 102.581, "load_time_ms": 0.158, "load_throughput": 15146448.39, "learn_time_ms": 132.245, "learn_throughput": 18148.093, "update_time_ms": 2.78}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116237.25, "policy_entropy": 16140.491536458334, "policy_loss": -10170.753051757812, "vf_loss": 4270.610493977864}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 184800, "num_agent_steps_sampled": 1108800, "num_steps_trained": 184800, "num_agent_steps_trained": 1108800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 772, "training_iteration": 77, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-32-25", "timestamp": 1718188345, "time_this_iter_s": 23.528451919555664, "time_total_s": 1760.4445412158966, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff303300790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1760.4445412158966, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 4.675757575757575, "ram_util_percent": 51.5}}
{"episode_reward_max": -236.97766294790603, "episode_reward_min": -285.17754581490084, "episode_reward_mean": -266.9644313778831, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.5295909691499}, "policy_reward_max": {"shared_policy": -39.49627715798437}, "policy_reward_mean": {"shared_policy": -44.49407189631385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594, -269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307, -248.83184814567454, -275.18103124295595, -275.07586402324046, -277.6598626515851, -273.4704312757406, -277.9522970775527, -271.8878390567573, -263.9965293168343, -262.02079130638896, -274.1842955591486, -267.1425271429011, -236.97766294790603, -276.3482504161905, -241.19705747187166, -271.5746826355475, -252.55188369218004, -268.7707693246346, -279.9586312060408, -276.0904082740506, -266.53215204277876, -265.28811162757756, -261.80771829803507, -270.03387508435867, -280.4291000702939, -267.3894898125016, -281.48097750279675, -273.83472455296635, -277.0863710502034], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24949969203960726, "mean_inference_ms": 0.47288075383086936, "mean_action_processing_ms": 0.08732478657232733, "mean_env_wait_ms": 8.495805101582333, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 187200, "timesteps_this_iter": 0, "agent_timesteps_total": 1123200, "timers": {"sample_time_ms": 23459.157, "sample_throughput": 102.305, "load_time_ms": 0.159, "load_throughput": 15137337.744, "learn_time_ms": 131.4, "learn_throughput": 18264.855, "update_time_ms": 2.757}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 87827.1640625, "policy_entropy": 16127.832845052084, "policy_loss": -13915.7099609375, "vf_loss": 2965.9659830729165}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 187200, "num_agent_steps_sampled": 1123200, "num_steps_trained": 187200, "num_agent_steps_trained": 1123200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 780, "training_iteration": 78, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-32-49", "timestamp": 1718188369, "time_this_iter_s": 23.894949913024902, "time_total_s": 1784.3394911289215, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff303300430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1784.3394911289215, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 4.773529411764706, "ram_util_percent": 51.670588235294126}}
{"episode_reward_max": -236.97766294790603, "episode_reward_min": -285.17754581490084, "episode_reward_mean": -267.6528382445775, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.5295909691499}, "policy_reward_max": {"shared_policy": -39.49627715798437}, "policy_reward_mean": {"shared_policy": -44.60880637409625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594, -269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307, -248.83184814567454, -275.18103124295595, -275.07586402324046, -277.6598626515851, -273.4704312757406, -277.9522970775527, -271.8878390567573, -263.9965293168343, -262.02079130638896, -274.1842955591486, -267.1425271429011, -236.97766294790603, -276.3482504161905, -241.19705747187166, -271.5746826355475, -252.55188369218004, -268.7707693246346, -279.9586312060408, -276.0904082740506, -266.53215204277876, -265.28811162757756, -261.80771829803507, -270.03387508435867, -280.4291000702939, -267.3894898125016, -281.48097750279675, -273.83472455296635, -277.0863710502034, -269.6804016525603, -264.6128628832158, -282.24325596510755, -272.00026393859036, -273.72561346078925, -272.03547001220943, -249.66461722299235, -277.2865102309873, -279.9837333810894, -271.2088235959092, -262.9174889995344, -275.7620978785478], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24971165898810643, "mean_inference_ms": 0.47345178952499595, "mean_action_processing_ms": 0.08737982775008206, "mean_env_wait_ms": 8.501030326814805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 189600, "timesteps_this_iter": 0, "agent_timesteps_total": 1137600, "timers": {"sample_time_ms": 23488.176, "sample_throughput": 102.179, "load_time_ms": 0.159, "load_throughput": 15141891.697, "learn_time_ms": 130.786, "learn_throughput": 18350.609, "update_time_ms": 2.776}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75571.7109375, "policy_entropy": 16113.561197916666, "policy_loss": -14173.61572265625, "vf_loss": 2757.0335286458335}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 189600, "num_agent_steps_sampled": 1137600, "num_steps_trained": 189600, "num_agent_steps_trained": 1137600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 792, "training_iteration": 79, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-33-12", "timestamp": 1718188392, "time_this_iter_s": 23.16046380996704, "time_total_s": 1807.4999549388885, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff310281940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1807.4999549388885, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 5.166666666666667, "ram_util_percent": 50.13636363636363}}
{"episode_reward_max": -236.97766294790603, "episode_reward_min": -285.17754581490084, "episode_reward_mean": -268.087864512315, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.5295909691499}, "policy_reward_max": {"shared_policy": -39.49627715798437}, "policy_reward_mean": {"shared_policy": -44.68131075205249}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594, -269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307, -248.83184814567454, -275.18103124295595, -275.07586402324046, -277.6598626515851, -273.4704312757406, -277.9522970775527, -271.8878390567573, -263.9965293168343, -262.02079130638896, -274.1842955591486, -267.1425271429011, -236.97766294790603, -276.3482504161905, -241.19705747187166, -271.5746826355475, -252.55188369218004, -268.7707693246346, -279.9586312060408, -276.0904082740506, -266.53215204277876, -265.28811162757756, -261.80771829803507, -270.03387508435867, -280.4291000702939, -267.3894898125016, -281.48097750279675, -273.83472455296635, -277.0863710502034, -269.6804016525603, -264.6128628832158, -282.24325596510755, -272.00026393859036, -273.72561346078925, -272.03547001220943, -249.66461722299235, -277.2865102309873, -279.9837333810894, -271.2088235959092, -262.9174889995344, -275.7620978785478, -277.8082008576189, -244.5360994695342, -274.03758684666025, -270.4521279943473, -283.91667023024326, -268.58109897188984, -246.27872213618147, -257.93467300933344], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24983229026980555, "mean_inference_ms": 0.4737708671372354, "mean_action_processing_ms": 0.08741126497600014, "mean_env_wait_ms": 8.504052916405065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 1152000, "timers": {"sample_time_ms": 23381.529, "sample_throughput": 102.645, "load_time_ms": 0.158, "load_throughput": 15185291.296, "learn_time_ms": 130.764, "learn_throughput": 18353.637, "update_time_ms": 2.772}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93391.9609375, "policy_entropy": 16116.080729166666, "policy_loss": -11326.059733072916, "vf_loss": 3508.3309122721353}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 1152000, "num_steps_trained": 192000, "num_agent_steps_trained": 1152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 800, "training_iteration": 80, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-33-35", "timestamp": 1718188415, "time_this_iter_s": 22.395559310913086, "time_total_s": 1829.8955142498016, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30fb36310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1829.8955142498016, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 3.98125, "ram_util_percent": 49.475}}
{"episode_reward_max": -235.4496948474253, "episode_reward_min": -284.5132340573988, "episode_reward_mean": -267.8888932627447, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.418872342899796}, "policy_reward_max": {"shared_policy": -39.241615807904076}, "policy_reward_mean": {"shared_policy": -44.648148877124115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594, -269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307, -248.83184814567454, -275.18103124295595, -275.07586402324046, -277.6598626515851, -273.4704312757406, -277.9522970775527, -271.8878390567573, -263.9965293168343, -262.02079130638896, -274.1842955591486, -267.1425271429011, -236.97766294790603, -276.3482504161905, -241.19705747187166, -271.5746826355475, -252.55188369218004, -268.7707693246346, -279.9586312060408, -276.0904082740506, -266.53215204277876, -265.28811162757756, -261.80771829803507, -270.03387508435867, -280.4291000702939, -267.3894898125016, -281.48097750279675, -273.83472455296635, -277.0863710502034, -269.6804016525603, -264.6128628832158, -282.24325596510755, -272.00026393859036, -273.72561346078925, -272.03547001220943, -249.66461722299235, -277.2865102309873, -279.9837333810894, -271.2088235959092, -262.9174889995344, -275.7620978785478, -277.8082008576189, -244.5360994695342, -274.03758684666025, -270.4521279943473, -283.91667023024326, -268.58109897188984, -246.27872213618147, -257.93467300933344, -267.25895833072644, -269.9021968918458, -255.80034866051164, -278.2987935555531, -256.14182485437, -281.2201037946448, -249.60293605976057, -235.4496948474253, -272.8394894791983, -265.234032243114, -275.6389638565527, -276.080805220446], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2499816559326352, "mean_inference_ms": 0.47415265060551304, "mean_action_processing_ms": 0.08745063205490337, "mean_env_wait_ms": 8.507890102310311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 194400, "timesteps_this_iter": 0, "agent_timesteps_total": 1166400, "timers": {"sample_time_ms": 23270.333, "sample_throughput": 103.136, "load_time_ms": 0.152, "load_throughput": 15837522.97, "learn_time_ms": 129.425, "learn_throughput": 18543.507, "update_time_ms": 2.737}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102428.3671875, "policy_entropy": 16114.753092447916, "policy_loss": -3608.8984375, "vf_loss": 6861.119140625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 194400, "num_agent_steps_sampled": 1166400, "num_steps_trained": 194400, "num_agent_steps_trained": 1166400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 812, "training_iteration": 81, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-33-57", "timestamp": 1718188437, "time_this_iter_s": 22.446458339691162, "time_total_s": 1852.3419725894928, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff309f66040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1852.3419725894928, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 4.075, "ram_util_percent": 49.60625}}
{"episode_reward_max": -233.0549196521888, "episode_reward_min": -284.5132340573988, "episode_reward_mean": -267.31686513165386, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.418872342899796}, "policy_reward_max": {"shared_policy": -38.84248660869816}, "policy_reward_mean": {"shared_policy": -44.55281085527564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594, -269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307, -248.83184814567454, -275.18103124295595, -275.07586402324046, -277.6598626515851, -273.4704312757406, -277.9522970775527, -271.8878390567573, -263.9965293168343, -262.02079130638896, -274.1842955591486, -267.1425271429011, -236.97766294790603, -276.3482504161905, -241.19705747187166, -271.5746826355475, -252.55188369218004, -268.7707693246346, -279.9586312060408, -276.0904082740506, -266.53215204277876, -265.28811162757756, -261.80771829803507, -270.03387508435867, -280.4291000702939, -267.3894898125016, -281.48097750279675, -273.83472455296635, -277.0863710502034, -269.6804016525603, -264.6128628832158, -282.24325596510755, -272.00026393859036, -273.72561346078925, -272.03547001220943, -249.66461722299235, -277.2865102309873, -279.9837333810894, -271.2088235959092, -262.9174889995344, -275.7620978785478, -277.8082008576189, -244.5360994695342, -274.03758684666025, -270.4521279943473, -283.91667023024326, -268.58109897188984, -246.27872213618147, -257.93467300933344, -267.25895833072644, -269.9021968918458, -255.80034866051164, -278.2987935555531, -256.14182485437, -281.2201037946448, -249.60293605976057, -235.4496948474253, -272.8394894791983, -265.234032243114, -275.6389638565527, -276.080805220446, -274.2807765903978, -233.0549196521888, -270.2158403875034, -248.96504228216463, -269.8243593015193, -266.7811829642823, -271.19124603978076, -260.6572310876673], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -45.713462765066254, -45.713462765066254, -45.713462765066254, -45.713462765066254, -45.713462765066254, -45.713462765066254, -38.84248660869816, -38.84248660869816, -38.84248660869816, -38.84248660869816, -38.84248660869816, -38.84248660869816, -45.03597339791723, -45.03597339791723, -45.03597339791723, -45.03597339791723, -45.03597339791723, -45.03597339791723, -41.49417371369402, -41.49417371369402, -41.49417371369402, -41.49417371369402, -41.49417371369402, -41.49417371369402, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.463530494047006, -44.463530494047006, -44.463530494047006, -44.463530494047006, -44.463530494047006, -44.463530494047006, -45.19854100663015, -45.19854100663015, -45.19854100663015, -45.19854100663015, -45.19854100663015, -45.19854100663015, -43.442871847944694, -43.442871847944694, -43.442871847944694, -43.442871847944694, -43.442871847944694, -43.442871847944694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2500869615697944, "mean_inference_ms": 0.47442462740608804, "mean_action_processing_ms": 0.08747658011289784, "mean_env_wait_ms": 8.510423717961482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 196800, "timesteps_this_iter": 0, "agent_timesteps_total": 1180800, "timers": {"sample_time_ms": 23285.721, "sample_throughput": 103.067, "load_time_ms": 0.149, "load_throughput": 16103550.792, "learn_time_ms": 127.759, "learn_throughput": 18785.418, "update_time_ms": 2.695}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 94010.0234375, "policy_entropy": 16142.148763020834, "policy_loss": -7924.236979166667, "vf_loss": 4707.7024332682295}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 196800, "num_agent_steps_sampled": 1180800, "num_steps_trained": 196800, "num_agent_steps_trained": 1180800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 820, "training_iteration": 82, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-34-21", "timestamp": 1718188461, "time_this_iter_s": 23.480949878692627, "time_total_s": 1875.8229224681854, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff3102813a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1875.8229224681854, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 4.112121212121212, "ram_util_percent": 49.8}}
{"episode_reward_max": -233.0549196521888, "episode_reward_min": -283.91667023024326, "episode_reward_mean": -266.84080353062086, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.319445038373566}, "policy_reward_max": {"shared_policy": -38.84248660869816}, "policy_reward_mean": {"shared_policy": -44.47346725510347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594, -269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307, -248.83184814567454, -275.18103124295595, -275.07586402324046, -277.6598626515851, -273.4704312757406, -277.9522970775527, -271.8878390567573, -263.9965293168343, -262.02079130638896, -274.1842955591486, -267.1425271429011, -236.97766294790603, -276.3482504161905, -241.19705747187166, -271.5746826355475, -252.55188369218004, -268.7707693246346, -279.9586312060408, -276.0904082740506, -266.53215204277876, -265.28811162757756, -261.80771829803507, -270.03387508435867, -280.4291000702939, -267.3894898125016, -281.48097750279675, -273.83472455296635, -277.0863710502034, -269.6804016525603, -264.6128628832158, -282.24325596510755, -272.00026393859036, -273.72561346078925, -272.03547001220943, -249.66461722299235, -277.2865102309873, -279.9837333810894, -271.2088235959092, -262.9174889995344, -275.7620978785478, -277.8082008576189, -244.5360994695342, -274.03758684666025, -270.4521279943473, -283.91667023024326, -268.58109897188984, -246.27872213618147, -257.93467300933344, -267.25895833072644, -269.9021968918458, -255.80034866051164, -278.2987935555531, -256.14182485437, -281.2201037946448, -249.60293605976057, -235.4496948474253, -272.8394894791983, -265.234032243114, -275.6389638565527, -276.080805220446, -274.2807765903978, -233.0549196521888, -270.2158403875034, -248.96504228216463, -269.8243593015193, -266.7811829642823, -271.19124603978076, -260.6572310876673, -271.8372810311233, -262.5464518266477, -257.9482588685657, -266.7266213729131, -274.5022021838551, -246.62321023978612, -266.41580727311555, -281.4108217056642, -282.5344818154669, -271.6828672609189, -257.72163799255634, -251.94168666466044], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -45.713462765066254, -45.713462765066254, -45.713462765066254, -45.713462765066254, -45.713462765066254, -45.713462765066254, -38.84248660869816, -38.84248660869816, -38.84248660869816, -38.84248660869816, -38.84248660869816, -38.84248660869816, -45.03597339791723, -45.03597339791723, -45.03597339791723, -45.03597339791723, -45.03597339791723, -45.03597339791723, -41.49417371369402, -41.49417371369402, -41.49417371369402, -41.49417371369402, -41.49417371369402, -41.49417371369402, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.463530494047006, -44.463530494047006, -44.463530494047006, -44.463530494047006, -44.463530494047006, -44.463530494047006, -45.19854100663015, -45.19854100663015, -45.19854100663015, -45.19854100663015, -45.19854100663015, -45.19854100663015, -43.442871847944694, -43.442871847944694, -43.442871847944694, -43.442871847944694, -43.442871847944694, -43.442871847944694, -45.30621350518708, -45.30621350518708, -45.30621350518708, -45.30621350518708, -45.30621350518708, -45.30621350518708, -43.75774197110801, -43.75774197110801, -43.75774197110801, -43.75774197110801, -43.75774197110801, -43.75774197110801, -42.99137647809437, -42.99137647809437, -42.99137647809437, -42.99137647809437, -42.99137647809437, -42.99137647809437, -44.45443689548548, -44.45443689548548, -44.45443689548548, -44.45443689548548, -44.45443689548548, -44.45443689548548, -45.75036703064252, -45.75036703064252, -45.75036703064252, -45.75036703064252, -45.75036703064252, -45.75036703064252, -41.1038683732976, -41.1038683732976, -41.1038683732976, -41.1038683732976, -41.1038683732976, -41.1038683732976, -44.402634545518964, -44.402634545518964, -44.402634545518964, -44.402634545518964, -44.402634545518964, -44.402634545518964, -46.901803617610604, -46.901803617610604, -46.901803617610604, -46.901803617610604, -46.901803617610604, -46.901803617610604, -47.089080302577855, -47.089080302577855, -47.089080302577855, -47.089080302577855, -47.089080302577855, -47.089080302577855, -45.28047787681981, -45.28047787681981, -45.28047787681981, -45.28047787681981, -45.28047787681981, -45.28047787681981, -42.95360633209266, -42.95360633209266, -42.95360633209266, -42.95360633209266, -42.95360633209266, -42.95360633209266, -41.99028111077663, -41.99028111077663, -41.99028111077663, -41.99028111077663, -41.99028111077663, -41.99028111077663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2503001893151081, "mean_inference_ms": 0.4748296729548474, "mean_action_processing_ms": 0.08751535938451996, "mean_env_wait_ms": 8.513971748764112, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 199200, "timesteps_this_iter": 0, "agent_timesteps_total": 1195200, "timers": {"sample_time_ms": 23269.511, "sample_throughput": 103.139, "load_time_ms": 0.15, "load_throughput": 16044516.417, "learn_time_ms": 126.708, "learn_throughput": 18941.201, "update_time_ms": 2.706}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113578.2578125, "policy_entropy": 16181.129231770834, "policy_loss": -6118.387542724609, "vf_loss": 5833.319814046224}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 199200, "num_agent_steps_sampled": 1195200, "num_steps_trained": 199200, "num_agent_steps_trained": 1195200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 832, "training_iteration": 83, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-34-44", "timestamp": 1718188484, "time_this_iter_s": 23.317367792129517, "time_total_s": 1899.140290260315, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff309f664c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1899.140290260315, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 3.9181818181818175, "ram_util_percent": 50.0}}
{"episode_reward_max": -233.0549196521888, "episode_reward_min": -283.91667023024326, "episode_reward_mean": -267.08525878382795, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.319445038373566}, "policy_reward_max": {"shared_policy": -38.84248660869816}, "policy_reward_mean": {"shared_policy": -44.51420979730465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307, -248.83184814567454, -275.18103124295595, -275.07586402324046, -277.6598626515851, -273.4704312757406, -277.9522970775527, -271.8878390567573, -263.9965293168343, -262.02079130638896, -274.1842955591486, -267.1425271429011, -236.97766294790603, -276.3482504161905, -241.19705747187166, -271.5746826355475, -252.55188369218004, -268.7707693246346, -279.9586312060408, -276.0904082740506, -266.53215204277876, -265.28811162757756, -261.80771829803507, -270.03387508435867, -280.4291000702939, -267.3894898125016, -281.48097750279675, -273.83472455296635, -277.0863710502034, -269.6804016525603, -264.6128628832158, -282.24325596510755, -272.00026393859036, -273.72561346078925, -272.03547001220943, -249.66461722299235, -277.2865102309873, -279.9837333810894, -271.2088235959092, -262.9174889995344, -275.7620978785478, -277.8082008576189, -244.5360994695342, -274.03758684666025, -270.4521279943473, -283.91667023024326, -268.58109897188984, -246.27872213618147, -257.93467300933344, -267.25895833072644, -269.9021968918458, -255.80034866051164, -278.2987935555531, -256.14182485437, -281.2201037946448, -249.60293605976057, -235.4496948474253, -272.8394894791983, -265.234032243114, -275.6389638565527, -276.080805220446, -274.2807765903978, -233.0549196521888, -270.2158403875034, -248.96504228216463, -269.8243593015193, -266.7811829642823, -271.19124603978076, -260.6572310876673, -271.8372810311233, -262.5464518266477, -257.9482588685657, -266.7266213729131, -274.5022021838551, -246.62321023978612, -266.41580727311555, -281.4108217056642, -282.5344818154669, -271.6828672609189, -257.72163799255634, -251.94168666466044, -270.1554159677428, -250.06332096940034, -280.0959570311497, -272.67909860762313, -278.77775634300957, -269.8521354894057, -281.4269021507269, -264.3627480550731], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -41.4719746909456, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.86350520715935, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -45.84597733720652, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -46.27664377526422, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -45.57840521262325, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -46.32538284625882, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -45.314639842792936, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.99942155280572, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -43.67013188439818, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -45.69738259319158, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -44.52375452381676, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -39.49627715798437, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -46.05804173603189, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -40.19950957864531, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -45.2624471059247, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -42.09198061536333, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -44.7951282207726, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.65977186767359, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -46.01506804567506, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.42202534046328, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -44.21468527126307, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -43.63461971633942, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -45.005645847393126, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -46.738183345049045, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -44.56491496875015, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -46.91349625046619, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -45.639120758827595, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -46.181061841700604, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.946733608759935, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -44.10214381386955, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -47.040542660851436, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.33337732309854, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.62093557679833, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -45.33924500203464, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -41.61076953716561, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.214418371831236, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -46.66395556351484, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -45.20147059931819, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -43.81958149992242, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -45.96034964642438, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -46.30136680960312, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -40.756016578255476, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.67293114110998, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -45.07535466572448, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -47.319445038373566, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -44.76351649531514, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -41.04645368936357, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -42.98911216822183, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.543159721787575, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -44.983699481974355, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -42.63339144341863, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -46.38313225925901, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -42.690304142395014, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -46.870017299107516, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -41.600489343293354, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -39.241615807904076, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -45.47324824653306, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -44.20567204051888, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -45.939827309425525, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -46.013467536740926, -45.713462765066254, -45.713462765066254, -45.713462765066254, -45.713462765066254, -45.713462765066254, -45.713462765066254, -38.84248660869816, -38.84248660869816, -38.84248660869816, -38.84248660869816, -38.84248660869816, -38.84248660869816, -45.03597339791723, -45.03597339791723, -45.03597339791723, -45.03597339791723, -45.03597339791723, -45.03597339791723, -41.49417371369402, -41.49417371369402, -41.49417371369402, -41.49417371369402, -41.49417371369402, -41.49417371369402, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.97072655025305, -44.463530494047006, -44.463530494047006, -44.463530494047006, -44.463530494047006, -44.463530494047006, -44.463530494047006, -45.19854100663015, -45.19854100663015, -45.19854100663015, -45.19854100663015, -45.19854100663015, -45.19854100663015, -43.442871847944694, -43.442871847944694, -43.442871847944694, -43.442871847944694, -43.442871847944694, -43.442871847944694, -45.30621350518708, -45.30621350518708, -45.30621350518708, -45.30621350518708, -45.30621350518708, -45.30621350518708, -43.75774197110801, -43.75774197110801, -43.75774197110801, -43.75774197110801, -43.75774197110801, -43.75774197110801, -42.99137647809437, -42.99137647809437, -42.99137647809437, -42.99137647809437, -42.99137647809437, -42.99137647809437, -44.45443689548548, -44.45443689548548, -44.45443689548548, -44.45443689548548, -44.45443689548548, -44.45443689548548, -45.75036703064252, -45.75036703064252, -45.75036703064252, -45.75036703064252, -45.75036703064252, -45.75036703064252, -41.1038683732976, -41.1038683732976, -41.1038683732976, -41.1038683732976, -41.1038683732976, -41.1038683732976, -44.402634545518964, -44.402634545518964, -44.402634545518964, -44.402634545518964, -44.402634545518964, -44.402634545518964, -46.901803617610604, -46.901803617610604, -46.901803617610604, -46.901803617610604, -46.901803617610604, -46.901803617610604, -47.089080302577855, -47.089080302577855, -47.089080302577855, -47.089080302577855, -47.089080302577855, -47.089080302577855, -45.28047787681981, -45.28047787681981, -45.28047787681981, -45.28047787681981, -45.28047787681981, -45.28047787681981, -42.95360633209266, -42.95360633209266, -42.95360633209266, -42.95360633209266, -42.95360633209266, -42.95360633209266, -41.99028111077663, -41.99028111077663, -41.99028111077663, -41.99028111077663, -41.99028111077663, -41.99028111077663, -45.02590266129023, -45.02590266129023, -45.02590266129023, -45.02590266129023, -45.02590266129023, -45.02590266129023, -41.67722016156685, -41.67722016156685, -41.67722016156685, -41.67722016156685, -41.67722016156685, -41.67722016156685, -46.682659505191566, -46.682659505191566, -46.682659505191566, -46.682659505191566, -46.682659505191566, -46.682659505191566, -45.44651643460392, -45.44651643460392, -45.44651643460392, -45.44651643460392, -45.44651643460392, -45.44651643460392, -46.46295939050177, -46.46295939050177, -46.46295939050177, -46.46295939050177, -46.46295939050177, -46.46295939050177, -44.97535591490092, -44.97535591490092, -44.97535591490092, -44.97535591490092, -44.97535591490092, -44.97535591490092, -46.9044836917879, -46.9044836917879, -46.9044836917879, -46.9044836917879, -46.9044836917879, -46.9044836917879, -44.06045800917877, -44.06045800917877, -44.06045800917877, -44.06045800917877, -44.06045800917877, -44.06045800917877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2504298114316702, "mean_inference_ms": 0.47505570769496586, "mean_action_processing_ms": 0.08753678528388412, "mean_env_wait_ms": 8.51599158735072, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 201600, "timesteps_this_iter": 0, "agent_timesteps_total": 1209600, "timers": {"sample_time_ms": 23183.521, "sample_throughput": 103.522, "load_time_ms": 0.148, "load_throughput": 16236015.484, "learn_time_ms": 125.15, "learn_throughput": 19176.986, "update_time_ms": 2.682}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105334.1953125, "policy_entropy": 16197.323567708334, "policy_loss": -10706.258324941, "vf_loss": 4029.7975056966147}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 201600, "num_agent_steps_sampled": 1209600, "num_steps_trained": 201600, "num_agent_steps_trained": 1209600, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 840, "training_iteration": 84, "trial_id": "eb956_00000", "experiment_id": "de21b0d142a14372b44c898ffd8424ad", "date": "2024-06-12_19-35-07", "timestamp": 1718188507, "time_this_iter_s": 22.53122115135193, "time_total_s": 1921.6715114116669, "pid": 255929, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff30ff95430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1921.6715114116669, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 3.915625, "ram_util_percent": 50.1}}
