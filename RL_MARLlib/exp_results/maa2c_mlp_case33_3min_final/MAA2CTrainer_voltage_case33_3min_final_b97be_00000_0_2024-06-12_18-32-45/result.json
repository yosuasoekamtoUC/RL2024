{"episode_reward_max": -170.88553582144272, "episode_reward_min": -188.65446690106913, "episode_reward_mean": -179.02316853050326, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -31.442411150178263}, "policy_reward_max": {"shared_policy": -28.48092263690724}, "policy_reward_mean": {"shared_policy": -29.83719475508393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23799093313106087, "mean_inference_ms": 0.4693988754031266, "mean_action_processing_ms": 0.08742057543229342, "mean_env_wait_ms": 8.330536166364064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2400, "timesteps_this_iter": 0, "agent_timesteps_total": 14400, "timers": {"sample_time_ms": 25673.287, "sample_throughput": 93.482, "load_time_ms": 0.252, "load_throughput": 9514489.225, "learn_time_ms": 139.708, "learn_throughput": 17178.652, "update_time_ms": 2.451}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7042.74755859375, "policy_entropy": 3423.6127115885415, "policy_loss": -4149.783365885417, "vf_loss": 2236.9866536458335}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2400, "num_agent_steps_sampled": 14400, "num_steps_trained": 2400, "num_agent_steps_trained": 14400}, "done": false, "episodes_total": 8, "training_iteration": 1, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-33-25", "timestamp": 1718184805, "time_this_iter_s": 22.154619216918945, "time_total_s": 22.154619216918945, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f751132e670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 22.154619216918945, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 4.15, "ram_util_percent": 35.690625000000004}}
{"episode_reward_max": -166.37368068035727, "episode_reward_min": -188.65446690106913, "episode_reward_mean": -176.5555980606255, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -31.442411150178263}, "policy_reward_max": {"shared_policy": -27.72894678005953}, "policy_reward_mean": {"shared_policy": -29.425933010104306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24457428824015834, "mean_inference_ms": 0.4745178435799125, "mean_action_processing_ms": 0.08789682718087848, "mean_env_wait_ms": 8.391516548019784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 4800, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"sample_time_ms": 24199.276, "sample_throughput": 99.177, "load_time_ms": 0.194, "load_throughput": 12374099.078, "learn_time_ms": 132.15, "learn_throughput": 18161.14, "update_time_ms": 2.508}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9302.375, "policy_entropy": 3452.4952392578125, "policy_loss": -3984.7099609375, "vf_loss": 2015.0628458658855}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4800, "num_agent_steps_sampled": 28800, "num_steps_trained": 4800, "num_agent_steps_trained": 28800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-33-48", "timestamp": 1718184828, "time_this_iter_s": 22.692919969558716, "time_total_s": 44.84753918647766, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7559d6f670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 44.84753918647766, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 4.109375, "ram_util_percent": 35.865625}}
{"episode_reward_max": -166.37368068035727, "episode_reward_min": -193.68692443880894, "episode_reward_mean": -178.8335751983177, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -32.28115407313476}, "policy_reward_max": {"shared_policy": -27.72894678005953}, "policy_reward_mean": {"shared_policy": -29.805595866386323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24448561677365688, "mean_inference_ms": 0.47398724894173766, "mean_action_processing_ms": 0.08776782202472456, "mean_env_wait_ms": 8.385024870472618, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 7200, "timesteps_this_iter": 0, "agent_timesteps_total": 43200, "timers": {"sample_time_ms": 23425.263, "sample_throughput": 102.453, "load_time_ms": 0.168, "load_throughput": 14258257.224, "learn_time_ms": 128.232, "learn_throughput": 18716.135, "update_time_ms": 2.522}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12910.2236328125, "policy_entropy": 3494.503173828125, "policy_loss": -4204.6619059244795, "vf_loss": 2109.4650065104165}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 7200, "num_agent_steps_sampled": 43200, "num_steps_trained": 7200, "num_agent_steps_trained": 43200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28, "training_iteration": 3, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-34-10", "timestamp": 1718184850, "time_this_iter_s": 21.860039234161377, "time_total_s": 66.70757842063904, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516fa51f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 66.70757842063904, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 3.990322580645161, "ram_util_percent": 36.099999999999994}}
{"episode_reward_max": -166.37368068035727, "episode_reward_min": -199.23858736860112, "episode_reward_mean": -179.52655860748283, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -33.20643122810015}, "policy_reward_max": {"shared_policy": -27.72894678005953}, "policy_reward_mean": {"shared_policy": -29.921093101247166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24501641345116526, "mean_inference_ms": 0.4733983420234654, "mean_action_processing_ms": 0.08761480765076635, "mean_env_wait_ms": 8.377413454835317, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"sample_time_ms": 23108.141, "sample_throughput": 103.86, "load_time_ms": 0.156, "load_throughput": 15397827.304, "learn_time_ms": 124.842, "learn_throughput": 19224.265, "update_time_ms": 2.504}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15076.32421875, "policy_entropy": 3527.3045654296875, "policy_loss": -4017.6875, "vf_loss": 1877.6637369791667}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 57600, "num_steps_trained": 9600, "num_agent_steps_trained": 57600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-34-32", "timestamp": 1718184872, "time_this_iter_s": 22.134589195251465, "time_total_s": 88.8421676158905, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f750a685e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 88.8421676158905, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 4.053125, "ram_util_percent": 36.3}}
{"episode_reward_max": -163.25057026873898, "episode_reward_min": -199.23858736860112, "episode_reward_mean": -179.68705867358577, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -33.20643122810015}, "policy_reward_max": {"shared_policy": -27.208428378123084}, "policy_reward_mean": {"shared_policy": -29.947843112264323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24492868621433228, "mean_inference_ms": 0.4729936652792827, "mean_action_processing_ms": 0.08753472705666948, "mean_env_wait_ms": 8.374270434207181, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 12000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"sample_time_ms": 22918.567, "sample_throughput": 104.719, "load_time_ms": 0.149, "load_throughput": 16065000.958, "learn_time_ms": 123.765, "learn_throughput": 19391.642, "update_time_ms": 2.484}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16870.759765625, "policy_entropy": 3561.625040690104, "policy_loss": -4002.8546142578125, "vf_loss": 1810.5602213541667}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 12000, "num_agent_steps_sampled": 72000, "num_steps_trained": 12000, "num_agent_steps_trained": 72000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 48, "training_iteration": 5, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-34-54", "timestamp": 1718184894, "time_this_iter_s": 22.148485898971558, "time_total_s": 110.99065351486206, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f751776b160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 110.99065351486206, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 4.2064516129032254, "ram_util_percent": 36.5}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.23858736860112, "episode_reward_mean": -179.47571933995596, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -33.20643122810015}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -29.912619889992666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24521000317147276, "mean_inference_ms": 0.4723568760778537, "mean_action_processing_ms": 0.087446122631821, "mean_env_wait_ms": 8.368813902767055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 14400, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"sample_time_ms": 22773.729, "sample_throughput": 105.385, "load_time_ms": 0.146, "load_throughput": 16399125.061, "learn_time_ms": 122.976, "learn_throughput": 19516.062, "update_time_ms": 2.491}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17387.177734375, "policy_entropy": 3609.633015950521, "policy_loss": -3901.0524088541665, "vf_loss": 1688.5033365885417}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 14400, "num_agent_steps_sampled": 86400, "num_steps_trained": 14400, "num_agent_steps_trained": 86400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-35-16", "timestamp": 1718184916, "time_this_iter_s": 22.03628921508789, "time_total_s": 133.02694272994995, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bd7790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 133.02694272994995, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 4.067741935483871, "ram_util_percent": 36.70000000000001}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.23858736860112, "episode_reward_mean": -179.13610548091702, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -33.20643122810015}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -29.856017580152848}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24529710550163722, "mean_inference_ms": 0.4722604983504115, "mean_action_processing_ms": 0.08741847140629336, "mean_env_wait_ms": 8.367526837134513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 16800, "timesteps_this_iter": 0, "agent_timesteps_total": 100800, "timers": {"sample_time_ms": 22718.359, "sample_throughput": 105.641, "load_time_ms": 0.143, "load_throughput": 16765240.828, "learn_time_ms": 122.936, "learn_throughput": 19522.276, "update_time_ms": 2.508}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18664.865234375, "policy_entropy": 3667.208984375, "policy_loss": -4006.5923665364585, "vf_loss": 1713.2052815755208}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16800, "num_agent_steps_sampled": 100800, "num_steps_trained": 16800, "num_agent_steps_trained": 100800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 68, "training_iteration": 7, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-35-38", "timestamp": 1718184938, "time_this_iter_s": 22.37501573562622, "time_total_s": 155.40195846557617, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7559d6f820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 155.40195846557617, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 3.921875, "ram_util_percent": 36.9}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.7379133461239, "episode_reward_mean": -179.53693557815555, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -33.28965222435408}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -29.922822596359264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24563272053366805, "mean_inference_ms": 0.472376906400373, "mean_action_processing_ms": 0.08739912477213604, "mean_env_wait_ms": 8.368269616212292, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"sample_time_ms": 22697.27, "sample_throughput": 105.74, "load_time_ms": 0.14, "load_throughput": 17094170.41, "learn_time_ms": 122.333, "learn_throughput": 19618.569, "update_time_ms": 2.535}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18224.005859375, "policy_entropy": 3742.9801432291665, "policy_loss": -3916.0833333333335, "vf_loss": 1643.1142171223958}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 115200, "num_steps_trained": 19200, "num_agent_steps_trained": 115200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-36-01", "timestamp": 1718184961, "time_this_iter_s": 22.530414581298828, "time_total_s": 177.932373046875, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b89d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 177.932373046875, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 3.9437499999999996, "ram_util_percent": 37.1}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.7379133461239, "episode_reward_mean": -179.62070261507927, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -33.28965222435408}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -29.936783769179883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2457295447359562, "mean_inference_ms": 0.4723907163798309, "mean_action_processing_ms": 0.08738517757583751, "mean_env_wait_ms": 8.368342514532806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 21600, "timesteps_this_iter": 0, "agent_timesteps_total": 129600, "timers": {"sample_time_ms": 22635.702, "sample_throughput": 106.027, "load_time_ms": 0.138, "load_throughput": 17355740.69, "learn_time_ms": 121.744, "learn_throughput": 19713.481, "update_time_ms": 2.548}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17467.37890625, "policy_entropy": 3880.724365234375, "policy_loss": -3793.582316080729, "vf_loss": 1569.966552734375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 21600, "num_agent_steps_sampled": 129600, "num_steps_trained": 21600, "num_agent_steps_trained": 129600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 88, "training_iteration": 9, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-36-23", "timestamp": 1718184983, "time_this_iter_s": 22.12664246559143, "time_total_s": 200.05901551246643, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bd7c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 200.05901551246643, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 3.9593749999999996, "ram_util_percent": 37.3}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.7379133461239, "episode_reward_mean": -180.31868713896844, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -33.28965222435408}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -30.053114523161415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.15337552536138, -188.65446690106913, -174.4572815431902, -182.7181362039064, -181.67830514356052, -183.9430036803994, -175.69524342509635, -170.88553582144272, -182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -29.025562587560295, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -31.442411150178263, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -29.076213590531612, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.453022700651072, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.279717523926756, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -30.657167280066602, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -29.282540570849616, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -28.48092263690724, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24592304929684541, "mean_inference_ms": 0.47232606814117056, "mean_action_processing_ms": 0.0873588390058036, "mean_env_wait_ms": 8.368120050976193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 22589.088, "sample_throughput": 106.246, "load_time_ms": 0.138, "load_throughput": 17445978.51, "learn_time_ms": 121.258, "learn_throughput": 19792.544, "update_time_ms": 2.604}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16587.134765625, "policy_entropy": 4132.267985026042, "policy_loss": -3815.282267252604, "vf_loss": 1625.5616048177083}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 144000, "num_steps_trained": 24000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-36-45", "timestamp": 1718185005, "time_this_iter_s": 22.155433416366577, "time_total_s": 222.214448928833, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f756d45aaf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 222.214448928833, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 4.038709677419355, "ram_util_percent": 37.5}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -199.78810646701513, "episode_reward_mean": -181.21692598516384, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -33.298017744502474}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -30.202820997527304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.25454877028238, -173.19924804317645, -174.00638736242956, -175.77069223228986, -166.37368068035727, -171.3896736309378, -166.6307170950389, -186.92079431182407, -183.6894196177746, -181.81121740507763, -169.851074614932, -167.02915920436348, -175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -30.37575812838048, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -28.86654134052954, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.00106456040505, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -29.29511537204833, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -27.72894678005953, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -28.564945605156396, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -27.77178618250654, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -31.153465718637406, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.614903269629185, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -30.301869567512945, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -28.30851243582209, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -27.83819320072718, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24662475209040755, "mean_inference_ms": 0.472502007445408, "mean_action_processing_ms": 0.0873358377991393, "mean_env_wait_ms": 8.370984997878843, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 26400, "timesteps_this_iter": 0, "agent_timesteps_total": 158400, "timers": {"sample_time_ms": 22242.373, "sample_throughput": 107.902, "load_time_ms": 0.126, "load_throughput": 19093948.407, "learn_time_ms": 118.779, "learn_throughput": 20205.618, "update_time_ms": 2.613}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17911.013671875, "policy_entropy": 4528.635498046875, "policy_loss": -4382.694010416667, "vf_loss": 1719.9583943684895}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 26400, "num_agent_steps_sampled": 158400, "num_steps_trained": 26400, "num_agent_steps_trained": 158400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 108, "training_iteration": 11, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-37-07", "timestamp": 1718185027, "time_this_iter_s": 22.189446210861206, "time_total_s": 244.4038951396942, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f750a685c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 244.4038951396942, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 4.09375, "ram_util_percent": 37.6625}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -217.58335104535448, "episode_reward_mean": -184.5453269159735, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -36.26389184089261}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -30.75755448599557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.61475668451885, -185.36364710971148, -190.1918837766064, -191.6020010315754, -181.1728754126818, -193.68692443880894, -171.8110091600642, -186.78504672641853, -186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -29.26912611408662, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -30.893941184951856, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.698647296101164, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -31.93366683859589, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -30.19547923544701, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -32.28115407313476, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -28.63516819334389, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.130841121069643, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24644373462629365, "mean_inference_ms": 0.47170940527296634, "mean_action_processing_ms": 0.08720148072293704, "mean_env_wait_ms": 8.36253835872283, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 172800, "timers": {"sample_time_ms": 22180.298, "sample_throughput": 108.204, "load_time_ms": 0.126, "load_throughput": 19101194.687, "learn_time_ms": 117.902, "learn_throughput": 20355.812, "update_time_ms": 2.601}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18483.708984375, "policy_entropy": 5124.100830078125, "policy_loss": -5110.056559244792, "vf_loss": 1982.5441080729167}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 172800, "num_steps_trained": 28800, "num_agent_steps_trained": 172800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 12, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-37-29", "timestamp": 1718185049, "time_this_iter_s": 22.090762615203857, "time_total_s": 266.49465775489807, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75112eb430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 266.49465775489807, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 3.9774193548387107, "ram_util_percent": 37.635483870967754}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -230.7552304436114, "episode_reward_mean": -187.30973457132578, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -38.45920507393532}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -31.21828909522096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.85710888806318, -168.99552338242157, -175.96563203940457, -183.92670592988136, -182.61363446232883, -182.15351752732303, -189.28016932340324, -184.56342474415615, -199.23858736860112, -171.85504260614806, -173.5447134955802, -174.7281789791065, -167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -31.142851481343786, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -28.16592056373688, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -29.327605339900817, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.65445098831349, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.435605743721595, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -30.358919587887232, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -31.546694887233844, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -30.760570790692725, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -33.20643122810015, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.642507101024623, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -28.924118915930112, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -29.12136316318439, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2466475074168584, "mean_inference_ms": 0.4715696773598042, "mean_action_processing_ms": 0.08717183684471567, "mean_env_wait_ms": 8.362077621094691, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 31200, "timesteps_this_iter": 0, "agent_timesteps_total": 187200, "timers": {"sample_time_ms": 22215.861, "sample_throughput": 108.031, "load_time_ms": 0.128, "load_throughput": 18728055.07, "learn_time_ms": 118.276, "learn_throughput": 20291.562, "update_time_ms": 2.597}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21979.810546875, "policy_entropy": 5842.876057942708, "policy_loss": -6667.722574869792, "vf_loss": 2351.238240559896}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 31200, "num_agent_steps_sampled": 187200, "num_steps_trained": 31200, "num_agent_steps_trained": 187200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 128, "training_iteration": 13, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-37-52", "timestamp": 1718185072, "time_this_iter_s": 22.226313829421997, "time_total_s": 288.72097158432007, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bd7820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 288.72097158432007, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 3.940625, "ram_util_percent": 37.787499999999994}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -248.15850612608585, "episode_reward_mean": -192.88286331077626, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -41.35975102101435}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -32.14714388512938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.6558482479305, -192.1604264576291, -180.31718018526118, -190.35610991877041, -163.25057026873898, -177.00187756602202, -191.61611219567007, -181.55834719278295, -175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -27.942641374655082, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -32.02673774293824, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -30.052863364210154, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -31.72601831979512, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -27.208428378123084, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -29.500312927670418, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -31.93601869927824, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -30.2597245321304, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24678056591189637, "mean_inference_ms": 0.47136861704873895, "mean_action_processing_ms": 0.08714234189496847, "mean_env_wait_ms": 8.361997311506638, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 33600, "timesteps_this_iter": 0, "agent_timesteps_total": 201600, "timers": {"sample_time_ms": 22210.22, "sample_throughput": 108.058, "load_time_ms": 0.132, "load_throughput": 18193257.907, "learn_time_ms": 118.78, "learn_throughput": 20205.492, "update_time_ms": 2.611}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22326.650390625, "policy_entropy": 6746.379720052083, "policy_loss": -7727.942545572917, "vf_loss": 2471.803670247396}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 33600, "num_agent_steps_sampled": 201600, "num_steps_trained": 33600, "num_agent_steps_trained": 201600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 140, "training_iteration": 14, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-38-14", "timestamp": 1718185094, "time_this_iter_s": 22.080793619155884, "time_total_s": 310.80176520347595, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7559d6f1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 310.80176520347595, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 3.9516129032258065, "ram_util_percent": 37.935483870967744}}
{"episode_reward_max": -160.81787702126832, "episode_reward_min": -256.97349593309593, "episode_reward_mean": -197.7730413287355, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -42.82891598884934}, "policy_reward_max": {"shared_policy": -26.80297950354461}, "policy_reward_mean": {"shared_policy": -32.962173554789246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.23172255714982, -174.76542108227318, -178.72083674976363, -174.2828087912495, -178.86685617736487, -191.29139946915018, -179.62590999913783, -183.64225685088059, -172.7762499724859, -160.81787702126832, -181.60672405639383, -191.93628133811907, -174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.205287092858267, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.127570180378935, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.786806124960652, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.047134798541627, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -29.811142696227574, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -31.881899911524993, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -29.937651666523067, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -30.607042808480138, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -28.796041662080786, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -26.80297950354461, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -30.267787342732213, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -31.989380223019815, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24695961200025918, "mean_inference_ms": 0.47129367247698006, "mean_action_processing_ms": 0.0871311113721577, "mean_env_wait_ms": 8.362222073173111, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 36000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"sample_time_ms": 22221.467, "sample_throughput": 108.004, "load_time_ms": 0.134, "load_throughput": 17975588.571, "learn_time_ms": 119.374, "learn_throughput": 20104.858, "update_time_ms": 2.63}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25087.884765625, "policy_entropy": 7655.599446614583, "policy_loss": -9770.9638671875, "vf_loss": 2760.0977376302085}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 36000, "num_agent_steps_sampled": 216000, "num_steps_trained": 36000, "num_agent_steps_trained": 216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 148, "training_iteration": 15, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-38-36", "timestamp": 1718185116, "time_this_iter_s": 22.264872074127197, "time_total_s": 333.06663727760315, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b8280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 333.06663727760315, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 3.965625, "ram_util_percent": 38.150000000000006}}
{"episode_reward_max": -162.5849580968339, "episode_reward_min": -263.02550053054284, "episode_reward_mean": -206.15265981065616, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -43.837583421757046}, "policy_reward_max": {"shared_policy": -27.097493016139037}, "policy_reward_mean": {"shared_policy": -34.35877663510935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.77892411016333, -170.05683584475798, -181.19046745125047, -181.60313748856578, -169.4104022799989, -181.10988417719554, -178.76154813636617, -175.80081281670397, -199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -29.129820685027074, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -28.34280597412624, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.198411241875082, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -30.267189581427587, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -28.23506704666644, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -30.184980696199112, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.79359135606114, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -29.300135469450712, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24707756527765326, "mean_inference_ms": 0.47129215060499996, "mean_action_processing_ms": 0.08711797135264428, "mean_env_wait_ms": 8.364187768696327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 230400, "timers": {"sample_time_ms": 22248.889, "sample_throughput": 107.871, "load_time_ms": 0.135, "load_throughput": 17822821.53, "learn_time_ms": 119.817, "learn_throughput": 20030.567, "update_time_ms": 2.628}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24667.677734375, "policy_entropy": 8632.152669270834, "policy_loss": -10824.371988932291, "vf_loss": 2947.6011962890625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 230400, "num_steps_trained": 38400, "num_agent_steps_trained": 230400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 16, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-38-58", "timestamp": 1718185138, "time_this_iter_s": 22.307451486587524, "time_total_s": 355.3740887641907, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bde280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 355.3740887641907, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 4.041935483870967, "ram_util_percent": 38.35806451612904}}
{"episode_reward_max": -162.5849580968339, "episode_reward_min": -267.2357927830909, "episode_reward_mean": -212.68170824928737, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -44.53929879718188}, "policy_reward_max": {"shared_policy": -27.097493016139037}, "policy_reward_mean": {"shared_policy": -35.44695137488123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.7379133461239, -188.96443226257068, -186.0873711973172, -187.4125086032014, -178.34068836432945, -182.69053557560684, -177.9973734599761, -162.5849580968339, -170.57542630395815, -176.9000692308859, -184.01917018206484, -186.3892269272179, -181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -33.28965222435408, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.494072043761744, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.014561866219623, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -31.23541810053344, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -29.723448060721623, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -30.448422595934495, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -29.66622890999598, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -27.097493016139037, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -28.42923771732634, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -29.48334487181444, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -30.669861697010678, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -31.06487115453617, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24714906131076708, "mean_inference_ms": 0.4711339526736662, "mean_action_processing_ms": 0.08709791086959036, "mean_env_wait_ms": 8.364653354639008, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 40800, "timesteps_this_iter": 0, "agent_timesteps_total": 244800, "timers": {"sample_time_ms": 22232.29, "sample_throughput": 107.951, "load_time_ms": 0.136, "load_throughput": 17644749.518, "learn_time_ms": 119.264, "learn_throughput": 20123.427, "update_time_ms": 2.62}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24669.611328125, "policy_entropy": 9480.43896484375, "policy_loss": -11638.561604817709, "vf_loss": 3205.198201497396}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40800, "num_agent_steps_sampled": 244800, "num_steps_trained": 40800, "num_agent_steps_trained": 244800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 168, "training_iteration": 17, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-39-21", "timestamp": 1718185161, "time_this_iter_s": 22.19947338104248, "time_total_s": 377.57356214523315, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7559d6f1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 377.57356214523315, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 4.00625, "ram_util_percent": 38.456250000000004}}
{"episode_reward_max": -164.145192847411, "episode_reward_min": -279.0093834215262, "episode_reward_mean": -222.25125851470048, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -46.501563903587666}, "policy_reward_max": {"shared_policy": -27.3575321412351}, "policy_reward_mean": {"shared_policy": -37.04187641911676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.32225895508194, -182.97944298917452, -174.40789475864935, -187.19290282147605, -174.87842860777766, -189.28757027446773, -189.4532926204955, -164.145192847411, -182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.220376492513676, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -30.49657383152903, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -29.067982459775024, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -31.198817136912677, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -29.146404767962803, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.547928379077703, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -31.57554877008252, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -27.3575321412351, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24719096176501562, "mean_inference_ms": 0.47086093937034507, "mean_action_processing_ms": 0.08706695034415789, "mean_env_wait_ms": 8.364547373886195, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 43200, "timesteps_this_iter": 0, "agent_timesteps_total": 259200, "timers": {"sample_time_ms": 22243.446, "sample_throughput": 107.897, "load_time_ms": 0.136, "load_throughput": 17669527.12, "learn_time_ms": 119.129, "learn_throughput": 20146.165, "update_time_ms": 2.606}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24534.28125, "policy_entropy": 10308.453776041666, "policy_loss": -12218.147623697916, "vf_loss": 3417.271240234375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 43200, "num_agent_steps_sampled": 259200, "num_steps_trained": 43200, "num_agent_steps_trained": 259200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 180, "training_iteration": 18, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-39-43", "timestamp": 1718185183, "time_this_iter_s": 22.647058486938477, "time_total_s": 400.22062063217163, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7559d838b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 400.22062063217163, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 4.112500000000001, "ram_util_percent": 38.653125}}
{"episode_reward_max": -167.42691146070004, "episode_reward_min": -279.0093834215262, "episode_reward_mean": -228.73860004406376, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -46.501563903587666}, "policy_reward_max": {"shared_policy": -27.90448524344995}, "policy_reward_mean": {"shared_policy": -38.123100007343986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.50688909623665, -198.63612288132168, -190.8080813521512, -188.58189201159365, -190.52224869176675, -167.81405858436244, -185.45559424337733, -175.03418603951692, -191.5681949646636, -187.39621775961677, -199.49648668456211, -167.42691146070004, -181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -30.41781484937283, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -33.10602048022037, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.80134689202527, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.43031533526566, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -31.753708115294387, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -27.96900976406037, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -30.909265707229608, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -29.17236433991947, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.928032494110585, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -31.23270295993613, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -33.24941444742705, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -27.90448524344995, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24725232602253222, "mean_inference_ms": 0.47071289061684907, "mean_action_processing_ms": 0.0870507174334381, "mean_env_wait_ms": 8.364874211474067, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 45600, "timesteps_this_iter": 0, "agent_timesteps_total": 273600, "timers": {"sample_time_ms": 22258.364, "sample_throughput": 107.825, "load_time_ms": 0.138, "load_throughput": 17452027.739, "learn_time_ms": 120.372, "learn_throughput": 19938.21, "update_time_ms": 2.61}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24695.970703125, "policy_entropy": 11056.896647135416, "policy_loss": -13397.61181640625, "vf_loss": 3126.902872721354}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 45600, "num_agent_steps_sampled": 273600, "num_steps_trained": 45600, "num_agent_steps_trained": 273600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 188, "training_iteration": 19, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-40-06", "timestamp": 1718185206, "time_this_iter_s": 22.290458917617798, "time_total_s": 422.51107954978943, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f756d45a550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 422.51107954978943, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 4.06875, "ram_util_percent": 38.89375}}
{"episode_reward_max": -174.7362677665594, "episode_reward_min": -279.0093834215262, "episode_reward_mean": -237.58074837698777, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -46.501563903587666}, "policy_reward_max": {"shared_policy": -29.122711294426573}, "policy_reward_mean": {"shared_policy": -39.59679139616465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.49017528859488, -199.78810646701513, -184.72174880285073, -193.60823224455748, -194.781551803483, -198.00584647354907, -174.7362677665594, -194.87730401695399, -195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -30.24836254809903, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -33.298017744502474, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -30.78695813380854, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.268038707426214, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -32.46359196724716, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -33.00097441225811, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -29.122711294426573, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.47955066949234, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2473170123612802, "mean_inference_ms": 0.47054899767805625, "mean_action_processing_ms": 0.08703488918788746, "mean_env_wait_ms": 8.366194000089443, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 22288.972, "sample_throughput": 107.677, "load_time_ms": 0.138, "load_throughput": 17394728.875, "learn_time_ms": 120.553, "learn_throughput": 19908.222, "update_time_ms": 2.549}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24964.666015625, "policy_entropy": 11733.910807291666, "policy_loss": -13238.121907552084, "vf_loss": 3091.6575927734375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 288000, "num_steps_trained": 48000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 20, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-40-28", "timestamp": 1718185228, "time_this_iter_s": 22.451040744781494, "time_total_s": 444.9621202945709, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bd75e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 444.9621202945709, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 4.12258064516129, "ram_util_percent": 38.993548387096766}}
{"episode_reward_max": -179.8736305309754, "episode_reward_min": -279.0093834215262, "episode_reward_mean": -243.26314367986254, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -46.501563903587666}, "policy_reward_max": {"shared_policy": -29.97893842182934}, "policy_reward_mean": {"shared_policy": -40.54385727997712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.69199104293244, -199.79500757671335, -199.4739923154443, -179.8736305309754, -205.6558650441933, -209.5447653503316, -207.0123741171173, -217.58335104535448, -212.1515382567723, -198.94895459285922, -198.3112926372131, -207.72394353953814, -212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -32.61533184048877, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.29916792945215, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -33.245665385907415, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -29.97893842182934, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.27597750736554, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.9241275583886, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -34.502062352853095, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -36.26389184089261, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -35.358589709462166, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.158159098809925, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -33.0518821062021, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -34.62065725658974, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24738194932631757, "mean_inference_ms": 0.47045091861489896, "mean_action_processing_ms": 0.08702876154269919, "mean_env_wait_ms": 8.367451411679973, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 50400, "timesteps_this_iter": 0, "agent_timesteps_total": 302400, "timers": {"sample_time_ms": 22315.197, "sample_throughput": 107.55, "load_time_ms": 0.139, "load_throughput": 17290157.334, "learn_time_ms": 120.919, "learn_throughput": 19848.062, "update_time_ms": 2.554}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28634.625, "policy_entropy": 12304.390787760416, "policy_loss": -15545.71826171875, "vf_loss": 3125.6834716796875}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 50400, "num_agent_steps_sampled": 302400, "num_steps_trained": 50400, "num_agent_steps_trained": 302400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 208, "training_iteration": 21, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-40-51", "timestamp": 1718185251, "time_this_iter_s": 22.453577280044556, "time_total_s": 467.4156975746155, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f750a685c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 467.4156975746155, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 4.071875, "ram_util_percent": 39.215625}}
{"episode_reward_max": -207.15387214236273, "episode_reward_min": -281.0367712021121, "episode_reward_mean": -250.8243588779958, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -46.83946186701869}, "policy_reward_max": {"shared_policy": -34.52564535706054}, "policy_reward_mean": {"shared_policy": -41.80405981299933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-212.0444177447361, -212.40198479721508, -207.15387214236273, -225.94394367224024, -230.00019877069928, -230.7552304436114, -217.6459555178608, -216.72330678689403, -227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.34073629078939, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -35.40033079953568, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -34.52564535706054, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -37.65732394537335, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.33336646178315, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -38.45920507393532, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.27432591964359, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -36.12055113114895, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24745356213349165, "mean_inference_ms": 0.47036259967936156, "mean_action_processing_ms": 0.08702797148264069, "mean_env_wait_ms": 8.370158940551994, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 52800, "timesteps_this_iter": 0, "agent_timesteps_total": 316800, "timers": {"sample_time_ms": 22347.147, "sample_throughput": 107.396, "load_time_ms": 0.137, "load_throughput": 17482336.923, "learn_time_ms": 121.197, "learn_throughput": 19802.43, "update_time_ms": 2.579}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31043.708984375, "policy_entropy": 12787.58935546875, "policy_loss": -15842.6005859375, "vf_loss": 3217.4715983072915}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 52800, "num_agent_steps_sampled": 316800, "num_steps_trained": 52800, "num_agent_steps_trained": 316800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 220, "training_iteration": 22, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-41-13", "timestamp": 1718185273, "time_this_iter_s": 22.408933639526367, "time_total_s": 489.82463121414185, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f751776bee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 489.82463121414185, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 4.1125, "ram_util_percent": 39.428124999999994}}
{"episode_reward_max": -209.83364727755313, "episode_reward_min": -281.0367712021121, "episode_reward_mean": -254.72295021069135, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -46.83946186701869}, "policy_reward_max": {"shared_policy": -34.97227454625889}, "policy_reward_mean": {"shared_policy": -42.453825035115244}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-227.13866722373385, -231.367757389585, -209.83364727755313, -234.72630202375288, -214.36730092094695, -233.09648449844536, -237.69198542741404, -226.2852123901243, -225.10186085350682, -218.66768252183138, -224.59970603849075, -248.15850612608585, -241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -37.8564445372889, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -38.561292898264206, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -34.97227454625889, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -39.12105033729221, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -35.727883486824446, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -38.84941408307416, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -39.615330904569, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.71420206502067, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -37.51697680891778, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -36.44461375363848, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -37.4332843397486, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -41.35975102101435, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2475385789361571, "mean_inference_ms": 0.47039511560489006, "mean_action_processing_ms": 0.08703314292307221, "mean_env_wait_ms": 8.372352704077535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 55200, "timesteps_this_iter": 0, "agent_timesteps_total": 331200, "timers": {"sample_time_ms": 22388.547, "sample_throughput": 107.198, "load_time_ms": 0.136, "load_throughput": 17647842.917, "learn_time_ms": 120.803, "learn_throughput": 19867.017, "update_time_ms": 2.571}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34741.22265625, "policy_entropy": 13240.762532552084, "policy_loss": -17274.793294270832, "vf_loss": 2957.723592122396}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 55200, "num_agent_steps_sampled": 331200, "num_steps_trained": 55200, "num_agent_steps_trained": 331200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 228, "training_iteration": 23, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-41-36", "timestamp": 1718185296, "time_this_iter_s": 22.632850408554077, "time_total_s": 512.4574816226959, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7559d6f1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 512.4574816226959, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 4.106249999999999, "ram_util_percent": 39.571875}}
{"episode_reward_max": -227.51491963843588, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -259.1030513432054, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -37.91915327307279}, "policy_reward_mean": {"shared_policy": -43.183841890534254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-241.54342830837652, -238.89490772920578, -236.40927348870366, -243.19281466888918, -240.56392621487373, -246.7179082623433, -256.97349593309593, -228.63851922323357, -252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -40.25723805139616, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.815817954867796, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -39.401545581450684, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.53213577814805, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -40.093987702478906, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -41.11965137705726, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -42.82891598884934, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -38.10641987053895, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.247749672814953, "mean_inference_ms": 0.4708993523959061, "mean_action_processing_ms": 0.08707524472708625, "mean_env_wait_ms": 8.377869086185505, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 57600, "timesteps_this_iter": 0, "agent_timesteps_total": 345600, "timers": {"sample_time_ms": 22518.335, "sample_throughput": 106.58, "load_time_ms": 0.133, "load_throughput": 18010967.257, "learn_time_ms": 120.557, "learn_throughput": 19907.549, "update_time_ms": 2.592}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39162.98046875, "policy_entropy": 13632.24169921875, "policy_loss": -16650.017659505207, "vf_loss": 3207.475545247396}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 57600, "num_agent_steps_sampled": 345600, "num_steps_trained": 57600, "num_agent_steps_trained": 345600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 24, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-41-59", "timestamp": 1718185319, "time_this_iter_s": 23.381316900253296, "time_total_s": 535.8387985229492, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bd7d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 535.8387985229492, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 4.170588235294117, "ram_util_percent": 39.75882352941177}}
{"episode_reward_max": -227.51491963843588, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -261.4030816473064, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -37.91915327307279}, "policy_reward_mean": {"shared_policy": -43.5671802745511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-252.57386684070366, -239.84194520296668, -250.24308174935766, -250.75877860208612, -239.62203337670832, -245.5456354608363, -227.51491963843588, -263.02550053054284, -256.555228381935, -260.30359011263573, -261.03472107496617, -234.5068912861268, -242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -42.095644473450584, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -39.97365753382791, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.70718029155957, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -41.79312976701448, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -39.93700556278465, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -40.924272576806004, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -37.91915327307279, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -43.837583421757046, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -42.75920473032256, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.38393168543917, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -43.50578684582761, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -39.08448188102107, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24795040489058365, "mean_inference_ms": 0.4713511204740062, "mean_action_processing_ms": 0.08711036494267183, "mean_env_wait_ms": 8.382017815159504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 22581.907, "sample_throughput": 106.28, "load_time_ms": 0.134, "load_throughput": 17946745.587, "learn_time_ms": 120.172, "learn_throughput": 19971.406, "update_time_ms": 2.587}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44246.98828125, "policy_entropy": 13977.417643229166, "policy_loss": -15830.426595052084, "vf_loss": 3437.745361328125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 360000, "num_steps_trained": 60000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 248, "training_iteration": 25, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-42-22", "timestamp": 1718185342, "time_this_iter_s": 22.898764848709106, "time_total_s": 558.7375633716583, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f750a685e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 558.7375633716583, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 4.103125, "ram_util_percent": 39.809374999999996}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -263.96880679079715, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -43.99480113179954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-242.93999668381784, -254.16324452281103, -256.9303380892384, -260.63533673156815, -261.84781740695195, -267.0090225985167, -267.2357927830909, -254.85530735212973, -254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -40.489999447302885, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.36054075380196, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -42.82172301487319, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.43922278859471, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -43.64130290115871, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.50150376641953, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -44.53929879718188, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.475884558688286, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2482832861850119, "mean_inference_ms": 0.4724880918394307, "mean_action_processing_ms": 0.08717664223952931, "mean_env_wait_ms": 8.389096565978267, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 62400, "timesteps_this_iter": 0, "agent_timesteps_total": 374400, "timers": {"sample_time_ms": 22671.838, "sample_throughput": 105.858, "load_time_ms": 0.134, "load_throughput": 17848102.128, "learn_time_ms": 120.025, "learn_throughput": 19995.772, "update_time_ms": 2.59}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33804.20703125, "policy_entropy": 14264.05078125, "policy_loss": -14382.879801432291, "vf_loss": 3657.781209309896}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 62400, "num_agent_steps_sampled": 374400, "num_steps_trained": 62400, "num_agent_steps_trained": 374400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 260, "training_iteration": 26, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-42-45", "timestamp": 1718185365, "time_this_iter_s": 23.20286250114441, "time_total_s": 581.9404258728027, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f751776be50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 581.9404258728027, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 4.290909090909091, "ram_util_percent": 40.04545454545455}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -264.7204389920529, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -44.120073165342156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.37479568672492, -269.4905327685944, -261.5555677213147, -250.4455609514292, -268.5112281850902, -268.2195856532756, -265.01174587612616, -269.9128713624084, -235.74497224682187, -279.0093834215262, -257.1468286966492, -259.2316275214412, -269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -42.39579928112096, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -44.91508879476562, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -43.59259462021922, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -41.74092682523806, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.75187136418181, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.703264275546054, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.16862431268777, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -44.9854785604014, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -39.29082870780379, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -46.501563903587666, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -42.857804782774856, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -43.20527125357356, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24852976457307172, "mean_inference_ms": 0.4732843302720643, "mean_action_processing_ms": 0.08722462512055912, "mean_env_wait_ms": 8.394096415798732, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 64800, "timesteps_this_iter": 0, "agent_timesteps_total": 388800, "timers": {"sample_time_ms": 22715.081, "sample_throughput": 105.657, "load_time_ms": 0.134, "load_throughput": 17917995.016, "learn_time_ms": 120.057, "learn_throughput": 19990.431, "update_time_ms": 2.628}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39528.43359375, "policy_entropy": 14489.745279947916, "policy_loss": -16463.913411458332, "vf_loss": 3372.332560221354}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 64800, "num_agent_steps_sampled": 388800, "num_steps_trained": 64800, "num_agent_steps_trained": 388800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 268, "training_iteration": 27, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-43-08", "timestamp": 1718185388, "time_this_iter_s": 22.63356113433838, "time_total_s": 604.5739870071411, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f750a685b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 604.5739870071411, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 3.9749999999999996, "ram_util_percent": 40.171875}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -265.5627036603784, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -44.260450610063074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.22879297868354, -271.0536145761444, -264.2923677355505, -267.90957300737534, -262.12655986478785, -265.87365540003344, -254.84066539878555, -237.0759078494994, -261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -44.87146549644735, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -45.175602429357525, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.04872795592516, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -44.651595501229366, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -43.6877599774646, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -44.312275900005424, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -42.473444233130934, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -39.51265130825, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24883284499699335, "mean_inference_ms": 0.474336038333462, "mean_action_processing_ms": 0.08729064415510171, "mean_env_wait_ms": 8.401146903612469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 67200, "timesteps_this_iter": 0, "agent_timesteps_total": 403200, "timers": {"sample_time_ms": 22720.759, "sample_throughput": 105.63, "load_time_ms": 0.135, "load_throughput": 17759932.251, "learn_time_ms": 120.485, "learn_throughput": 19919.438, "update_time_ms": 2.646}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50100.40234375, "policy_entropy": 14687.328776041666, "policy_loss": -14975.102376302084, "vf_loss": 3455.36376953125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 67200, "num_agent_steps_sampled": 403200, "num_steps_trained": 67200, "num_agent_steps_trained": 403200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 28, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-43-31", "timestamp": 1718185411, "time_this_iter_s": 22.707294702529907, "time_total_s": 627.281281709671, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b81f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 627.281281709671, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 3.9575757575757575, "ram_util_percent": 40.39393939393939}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -265.9481304062368, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -44.32468840103948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-261.9020893415703, -271.6892870475254, -243.13579356814571, -252.78794880354894, -250.67372579201992, -261.15276978040384, -269.7912165974835, -253.69924010576415, -253.26649508094542, -243.72109994379232, -278.43186085610455, -269.2101901449627, -259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -43.6503482235951, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -45.281547841254344, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -40.522632261357764, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -42.131324800591536, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -41.77895429866997, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -43.525461630067326, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -44.965202766247266, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.28320668429407, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -42.21108251349092, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -40.6201833239655, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -46.405310142683994, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -44.86836502416042, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24905016709112573, "mean_inference_ms": 0.4750468979266394, "mean_action_processing_ms": 0.08733407643780822, "mean_env_wait_ms": 8.40570433502935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 69600, "timesteps_this_iter": 0, "agent_timesteps_total": 417600, "timers": {"sample_time_ms": 22730.424, "sample_throughput": 105.585, "load_time_ms": 0.134, "load_throughput": 17905246.531, "learn_time_ms": 119.6, "learn_throughput": 20066.896, "update_time_ms": 2.637}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53964.77734375, "policy_entropy": 14844.438802083334, "policy_loss": -17131.367350260418, "vf_loss": 3143.9667765299478}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 69600, "num_agent_steps_sampled": 417600, "num_steps_trained": 69600, "num_agent_steps_trained": 417600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 288, "training_iteration": 29, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-43-53", "timestamp": 1718185433, "time_this_iter_s": 22.37329125404358, "time_total_s": 649.6545729637146, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b84c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 649.6545729637146, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 4.038709677419354, "ram_util_percent": 40.54193548387095}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.7169585814086, "episode_reward_mean": -267.0660784224598, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.11949309690127}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -44.51101307040997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-259.8135411107261, -241.23315722750732, -256.5601575398946, -277.83914548863424, -267.15969549909386, -267.9534981254901, -247.0717207586846, -272.6178474010134, -254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -43.3022568517877, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -40.20552620458463, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -42.76002625664915, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -46.30652424810571, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.52661591651557, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -44.65891635424842, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -41.17862012644748, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -45.43630790016888, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24937644937781223, "mean_inference_ms": 0.47618306015894435, "mean_action_processing_ms": 0.08740398844145215, "mean_env_wait_ms": 8.412636313212445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"sample_time_ms": 22767.49, "sample_throughput": 105.413, "load_time_ms": 0.134, "load_throughput": 17949945.792, "learn_time_ms": 119.447, "learn_throughput": 20092.623, "update_time_ms": 2.632}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58951.98828125, "policy_entropy": 14980.671223958334, "policy_loss": -17026.393229166668, "vf_loss": 3286.7222900390625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 432000, "num_steps_trained": 72000, "num_agent_steps_trained": 432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 300, "training_iteration": 30, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-44-16", "timestamp": 1718185456, "time_this_iter_s": 22.82814383506775, "time_total_s": 672.4827167987823, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bd78b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 672.4827167987823, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 4.021212121212121, "ram_util_percent": 40.68484848484849}}
{"episode_reward_max": -233.91104291647991, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.78726259534994, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.985173819413305}, "policy_reward_mean": {"shared_policy": -44.631210432558326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.15053097878277, -267.19505992205137, -274.78654170241026, -258.5106386096934, -272.86513406907244, -278.8626009478568, -281.0367712021121, -263.2939985228091, -269.2668805674009, -262.95509799757866, -271.05392842652685, -233.91104291647991, -273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -42.35842182979705, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -44.53250998700853, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -45.797756950401535, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -43.08510643494888, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -45.477522344845305, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.4771001579763, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -46.83946186701869, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -43.88233308713467, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -44.877813427900186, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -43.82584966626311, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -45.17565473775464, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -38.985173819413305, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.249602425532299, "mean_inference_ms": 0.4769452977780758, "mean_action_processing_ms": 0.08745045688178045, "mean_env_wait_ms": 8.417237081860678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 74400, "timesteps_this_iter": 0, "agent_timesteps_total": 446400, "timers": {"sample_time_ms": 22793.501, "sample_throughput": 105.293, "load_time_ms": 0.133, "load_throughput": 18095145.785, "learn_time_ms": 119.599, "learn_throughput": 20067.048, "update_time_ms": 2.633}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43808.28125, "policy_entropy": 15075.41357421875, "policy_loss": -18675.450520833332, "vf_loss": 2843.2979736328125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 74400, "num_agent_steps_sampled": 446400, "num_steps_trained": 74400, "num_agent_steps_trained": 446400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 308, "training_iteration": 31, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-44-38", "timestamp": 1718185478, "time_this_iter_s": 22.716447353363037, "time_total_s": 695.1991641521454, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b85e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 695.1991641521454, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 3.984375, "ram_util_percent": 40.95625}}
{"episode_reward_max": -236.35348607334606, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.26421461147845, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -39.39224767889106}, "policy_reward_mean": {"shared_policy": -44.54403576857974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273.31717590727135, -263.7891571393075, -263.19239769268916, -278.0359243164013, -249.45861322968742, -266.9877681728558, -271.19741475952424, -276.5495919274329, -247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -45.55286265121189, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.96485952321801, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -43.865399615448226, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -46.339320719400355, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -41.57643553828115, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -44.49796136214271, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -45.199569126587285, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -46.09159865457204, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2499184700856774, "mean_inference_ms": 0.47806258263215595, "mean_action_processing_ms": 0.0875197044060496, "mean_env_wait_ms": 8.42420412174379, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 460800, "timers": {"sample_time_ms": 22819.11, "sample_throughput": 105.175, "load_time_ms": 0.134, "load_throughput": 17908431.952, "learn_time_ms": 119.714, "learn_throughput": 20047.753, "update_time_ms": 2.614}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67920.59375, "policy_entropy": 15172.479654947916, "policy_loss": -16360.409505208334, "vf_loss": 2997.0997721354165}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 460800, "num_steps_trained": 76800, "num_agent_steps_trained": 460800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 32, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-45-01", "timestamp": 1718185501, "time_this_iter_s": 22.66483473777771, "time_total_s": 717.8639988899231, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b8430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 717.8639988899231, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 3.971875, "ram_util_percent": 41.103125}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -266.70372911494445, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.450621519157416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-247.39999890051496, -270.37796633981384, -266.7603362963714, -259.09330703208377, -278.04717889650044, -271.4876410253039, -269.4174955313748, -288.7169585814086, -261.92269605963025, -245.74547093818276, -247.0977282930727, -262.9784480486178, -279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -41.23333315008588, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -45.062994389969205, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -44.46005604939508, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -43.182217838680586, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -46.34119648275, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -45.247940170883965, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -44.90291592189585, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -48.11949309690127, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -43.653782676605076, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -40.95757848969732, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -41.18295471551206, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -43.82974134143641, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.250126041867057, "mean_inference_ms": 0.4787350513006844, "mean_action_processing_ms": 0.0875614646624006, "mean_env_wait_ms": 8.42863514552292, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 79200, "timesteps_this_iter": 0, "agent_timesteps_total": 475200, "timers": {"sample_time_ms": 22823.893, "sample_throughput": 105.153, "load_time_ms": 0.136, "load_throughput": 17598478.322, "learn_time_ms": 119.429, "learn_throughput": 20095.607, "update_time_ms": 2.636}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66746.4140625, "policy_entropy": 15210.646321614584, "policy_loss": -14930.8564453125, "vf_loss": 3534.9537353515625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 79200, "num_agent_steps_sampled": 475200, "num_steps_trained": 79200, "num_agent_steps_trained": 475200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 328, "training_iteration": 33, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-45-24", "timestamp": 1718185524, "time_this_iter_s": 22.677830696105957, "time_total_s": 740.541829586029, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516748160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 740.541829586029, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 4.0375, "ram_util_percent": 41.190625000000004}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.5590182243393, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.59316970405655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.5956151499933, -260.37414117406087, -256.969882257565, -274.22207043335146, -268.71139022415423, -280.1712636430689, -262.84958243719274, -280.04335891943833, -269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -46.59926919166546, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -43.395690195676956, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -42.828313709594106, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -45.7036784055587, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -44.78523170402578, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -46.695210607178254, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -43.80826373953224, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -46.67389315323971, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2503228061733351, "mean_inference_ms": 0.4793613121173379, "mean_action_processing_ms": 0.08760115887023774, "mean_env_wait_ms": 8.434185284147887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 81600, "timesteps_this_iter": 0, "agent_timesteps_total": 489600, "timers": {"sample_time_ms": 22775.986, "sample_throughput": 105.374, "load_time_ms": 0.137, "load_throughput": 17549389.121, "learn_time_ms": 119.3, "learn_throughput": 20117.326, "update_time_ms": 2.601}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77358.203125, "policy_entropy": 15270.3798828125, "policy_loss": -12893.96044921875, "vf_loss": 3948.2352294921875}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 81600, "num_agent_steps_sampled": 489600, "num_steps_trained": 81600, "num_agent_steps_trained": 489600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 340, "training_iteration": 34, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-45-47", "timestamp": 1718185547, "time_this_iter_s": 22.9039945602417, "time_total_s": 763.4458241462708, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7559d6f700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 763.4458241462708, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 3.987878787878788, "ram_util_percent": 41.45454545454545}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.16810360653864, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.52801726775644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.7487381401988, -274.79443031545594, -269.4833980601061, -274.02701162354975, -275.21009990874376, -280.28306692041224, -256.79299255613637, -277.92230588934456, -269.9587441872122, -265.3604125112936, -257.59583887914624, -266.9216676147713, -246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -44.95812302336632, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -45.799071719242505, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -44.91389967668434, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.67116860392488, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -45.868349984790655, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -46.713844486735276, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -42.7988320926895, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -46.32038431489078, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.99312403120201, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -44.22673541854896, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -42.932639813190825, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -44.486944602461996, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25042923824398317, "mean_inference_ms": 0.4796793519979331, "mean_action_processing_ms": 0.08762168267912768, "mean_env_wait_ms": 8.437279806038712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 84000, "timesteps_this_iter": 0, "agent_timesteps_total": 504000, "timers": {"sample_time_ms": 22734.578, "sample_throughput": 105.566, "load_time_ms": 0.136, "load_throughput": 17601555.517, "learn_time_ms": 119.033, "learn_throughput": 20162.532, "update_time_ms": 2.612}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72258.9140625, "policy_entropy": 15349.73388671875, "policy_loss": -15561.232991536459, "vf_loss": 3389.233601888021}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 84000, "num_agent_steps_sampled": 504000, "num_steps_trained": 84000, "num_agent_steps_trained": 504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 348, "training_iteration": 35, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-46-09", "timestamp": 1718185569, "time_this_iter_s": 22.48356556892395, "time_total_s": 785.9293897151947, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bde430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 785.9293897151947, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 3.9937499999999995, "ram_util_percent": 41.643750000000004}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.2007285789049, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.533454763150814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-246.3745970926777, -279.40189483098857, -267.58660720769706, -273.22070216561866, -250.37774212100933, -279.45143235050494, -271.0988956644169, -273.26820486078674, -266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -41.06243284877957, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -46.566982471831416, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -44.59776786794936, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -45.53678369426956, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -41.72962368683473, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -46.57523872508427, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.18314927740276, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -45.54470081013105, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25050970517683757, "mean_inference_ms": 0.4797054805025312, "mean_action_processing_ms": 0.08763875303932814, "mean_env_wait_ms": 8.441065081783082, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 86400, "timesteps_this_iter": 0, "agent_timesteps_total": 518400, "timers": {"sample_time_ms": 22676.865, "sample_throughput": 105.835, "load_time_ms": 0.136, "load_throughput": 17697485.232, "learn_time_ms": 118.774, "learn_throughput": 20206.453, "update_time_ms": 2.605}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 64633.51953125, "policy_entropy": 15387.702962239584, "policy_loss": -14141.839925130209, "vf_loss": 3653.215616861979}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 86400, "num_agent_steps_sampled": 518400, "num_steps_trained": 86400, "num_agent_steps_trained": 518400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 36, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-46-32", "timestamp": 1718185592, "time_this_iter_s": 22.63077402114868, "time_total_s": 808.5601637363434, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f750a685e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 808.5601637363434, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 4.003125, "ram_util_percent": 41.778125}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.3728431851631, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.56214053086054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-266.0897628016805, -253.1345632108761, -266.2420653265681, -277.01166564546577, -256.13214921914323, -283.48499147453094, -276.85615265801766, -281.1291118214279, -273.0175559921093, -281.5214173235493, -251.024518228162, -257.2372132224234, -275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -44.34829380028005, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -42.189093868479354, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -44.37367755442813, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -46.16861094091113, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -42.688691536524004, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -47.247498579088465, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.14269210966957, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -46.85485197023807, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -45.50292599868487, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -46.92023622059165, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -41.83741970469382, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -42.87286887040385, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25055434981290836, "mean_inference_ms": 0.47968290707424754, "mean_action_processing_ms": 0.08764635459932636, "mean_env_wait_ms": 8.443281892060511, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 88800, "timesteps_this_iter": 0, "agent_timesteps_total": 532800, "timers": {"sample_time_ms": 22654.244, "sample_throughput": 105.94, "load_time_ms": 0.136, "load_throughput": 17694374.407, "learn_time_ms": 118.818, "learn_throughput": 20198.908, "update_time_ms": 2.574}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72165.1328125, "policy_entropy": 15419.15380859375, "policy_loss": -16769.948404947918, "vf_loss": 3192.0154622395835}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 88800, "num_agent_steps_sampled": 532800, "num_steps_trained": 88800, "num_agent_steps_trained": 532800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 368, "training_iteration": 37, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-46-54", "timestamp": 1718185614, "time_this_iter_s": 22.408976793289185, "time_total_s": 830.9691405296326, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7559d6f700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 830.9691405296326, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 4.078125, "ram_util_percent": 41.91875}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -267.1604881973722, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.52674803289538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.795010202875, -240.67666253513457, -266.54958980203656, -253.05740444587963, -279.0741017774662, -279.7613280552789, -284.2193483405466, -251.81036623748548, -276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -45.9658350338125, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -40.11277708918915, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -44.424931633672855, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -42.17623407431344, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.51235029624414, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -46.626888009213076, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -47.3698913900912, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -41.968394372914084, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25058743599494626, "mean_inference_ms": 0.4796204990545884, "mean_action_processing_ms": 0.08765305532134882, "mean_env_wait_ms": 8.446302079991462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 91200, "timesteps_this_iter": 0, "agent_timesteps_total": 547200, "timers": {"sample_time_ms": 22643.914, "sample_throughput": 105.989, "load_time_ms": 0.135, "load_throughput": 17741151.921, "learn_time_ms": 119.261, "learn_throughput": 20123.885, "update_time_ms": 2.56}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69888.5234375, "policy_entropy": 15444.742838541666, "policy_loss": -16059.679036458334, "vf_loss": 3232.2296142578125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 91200, "num_agent_steps_sampled": 547200, "num_steps_trained": 91200, "num_agent_steps_trained": 547200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 380, "training_iteration": 38, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-47-17", "timestamp": 1718185637, "time_this_iter_s": 22.60756802558899, "time_total_s": 853.5767085552216, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75167481f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 853.5767085552216, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 4.00625, "ram_util_percent": 42.125}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -266.5436833321326, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.42394722202212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276.1157314229648, -280.40263404142723, -236.35348607334606, -243.8463318221249, -274.8502819434328, -275.0386380836687, -268.5824928227287, -267.2869543189967, -265.9519178024506, -284.51258612435055, -260.34345628434124, -287.97200794473156, -254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.01928857049418, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -46.733772340237756, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -39.39224767889106, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -40.641055303687416, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.80838032390556, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -45.839773013944516, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.763748803788246, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.54782571983267, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -44.32531963374198, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -47.418764354058354, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -43.3905760473902, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -47.995334657455366, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2506142443226366, "mean_inference_ms": 0.47956710188821966, "mean_action_processing_ms": 0.08765696582633713, "mean_env_wait_ms": 8.4484409944641, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 93600, "timesteps_this_iter": 0, "agent_timesteps_total": 561600, "timers": {"sample_time_ms": 22663.768, "sample_throughput": 105.896, "load_time_ms": 0.137, "load_throughput": 17467169.183, "learn_time_ms": 118.794, "learn_throughput": 20202.966, "update_time_ms": 2.567}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50455.42578125, "policy_entropy": 15487.905598958334, "policy_loss": -17229.89111328125, "vf_loss": 2535.703572591146}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 93600, "num_agent_steps_sampled": 561600, "num_steps_trained": 93600, "num_agent_steps_trained": 561600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 388, "training_iteration": 39, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-47-40", "timestamp": 1718185660, "time_this_iter_s": 22.562134504318237, "time_total_s": 876.1388430595398, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f750a685b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 876.1388430595398, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 4.028124999999999, "ram_util_percent": 42.3}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -288.87755980926534, "episode_reward_mean": -265.69072121159985, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.14625996821089}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.28178686859997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.19717582179965, -260.80725397518125, -281.3761693911695, -275.0267232702297, -288.87755980926534, -269.1357654826778, -262.3491490089441, -270.59738368079525, -266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -42.36619597030001, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -43.46787566253002, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -46.89602823186165, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -45.837787211705, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -48.14625996821089, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -44.85596091377975, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -43.72485816815746, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -45.099563946799016, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2506308210121339, "mean_inference_ms": 0.4794446521578676, "mean_action_processing_ms": 0.08766613223733827, "mean_env_wait_ms": 8.451141486349394, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"sample_time_ms": 22638.469, "sample_throughput": 106.014, "load_time_ms": 0.137, "load_throughput": 17479301.268, "learn_time_ms": 119.114, "learn_throughput": 20148.802, "update_time_ms": 2.578}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70627.1953125, "policy_entropy": 15533.690592447916, "policy_loss": -14958.660400390625, "vf_loss": 2977.0108642578125}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 576000, "num_steps_trained": 96000, "num_agent_steps_trained": 576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 40, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-48-02", "timestamp": 1718185682, "time_this_iter_s": 22.583488702774048, "time_total_s": 898.7223317623138, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bd7c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 898.7223317623138, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 3.9454545454545453, "ram_util_percent": 42.46060606060606}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -286.21832684437965, "episode_reward_mean": -265.45577439947374, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.703054474063116}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.24262906657898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-266.16104241372227, -265.2437508255234, -259.12598759560825, -269.636261832475, -248.15394678599728, -267.6091800341153, -248.5026280373235, -267.21453954259744, -273.0743973528391, -269.52443006210365, -256.9609603360873, -244.3763026572274, -252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.36017373562054, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -44.20729180425396, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -43.187664599267876, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -44.939376972079245, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -41.35899113099945, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -44.60153000568587, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -41.417104672887206, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -44.53575659043284, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -45.51239955880639, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -44.92073834368384, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -42.826826722681254, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -40.72938377620448, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25072730109310987, "mean_inference_ms": 0.4793434298145873, "mean_action_processing_ms": 0.08766922970902342, "mean_env_wait_ms": 8.452498692698121, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 98400, "timesteps_this_iter": 0, "agent_timesteps_total": 590400, "timers": {"sample_time_ms": 22607.51, "sample_throughput": 106.159, "load_time_ms": 0.139, "load_throughput": 17290157.334, "learn_time_ms": 119.216, "learn_throughput": 20131.492, "update_time_ms": 2.593}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76946.03125, "policy_entropy": 15549.40673828125, "policy_loss": -13672.196085611979, "vf_loss": 3723.537109375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 98400, "num_agent_steps_sampled": 590400, "num_steps_trained": 98400, "num_agent_steps_trained": 590400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 408, "training_iteration": 41, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-48-25", "timestamp": 1718185705, "time_this_iter_s": 22.405534267425537, "time_total_s": 921.1278660297394, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f751132ef70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 921.1278660297394, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 3.870967741935484, "ram_util_percent": 42.5806451612903}}
{"episode_reward_max": -233.59153271741263, "episode_reward_min": -286.21832684437965, "episode_reward_mean": -265.97815130958196, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.703054474063116}, "policy_reward_max": {"shared_policy": -38.93192211956887}, "policy_reward_mean": {"shared_policy": -44.32969188493034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-252.514358623622, -233.59153271741263, -284.54230238926203, -271.5780859109661, -261.71366195382797, -238.5036018404545, -260.3457294764211, -283.6902205798071, -274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -42.085726437270345, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -38.93192211956887, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -47.42371706487711, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -45.26301431849424, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -43.618943658971354, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -39.750600306742605, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -43.39095491273683, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -47.28170342996801, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2508790494725821, "mean_inference_ms": 0.4792330590040587, "mean_action_processing_ms": 0.08767423589051467, "mean_env_wait_ms": 8.454592642168578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 100800, "timesteps_this_iter": 0, "agent_timesteps_total": 604800, "timers": {"sample_time_ms": 22628.452, "sample_throughput": 106.061, "load_time_ms": 0.139, "load_throughput": 17307994.498, "learn_time_ms": 118.934, "learn_throughput": 20179.277, "update_time_ms": 2.587}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83792.9921875, "policy_entropy": 15574.2021484375, "policy_loss": -11576.363403320312, "vf_loss": 4302.3455810546875}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100800, "num_agent_steps_sampled": 604800, "num_steps_trained": 100800, "num_agent_steps_trained": 604800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 420, "training_iteration": 42, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-48-47", "timestamp": 1718185727, "time_this_iter_s": 22.87031102180481, "time_total_s": 943.9981770515442, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bdeb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 943.9981770515442, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 3.8999999999999995, "ram_util_percent": 42.84242424242425}}
{"episode_reward_max": -238.50207362604633, "episode_reward_min": -286.8203384202587, "episode_reward_mean": -266.6024923958398, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.80338973670989}, "policy_reward_max": {"shared_policy": -39.750345604341135}, "policy_reward_mean": {"shared_policy": -44.433748732639984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-274.47362009257233, -271.73276490445454, -271.23788673780774, -274.5037137058781, -247.12172387501462, -278.9899509487825, -278.9112999944566, -272.2664817261435, -255.2387325226107, -279.51140102991235, -281.23461382034884, -269.3519475243788, -279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.74560334876206, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.28879415074242, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.20631445630117, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -45.75061895097973, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -41.18695397916905, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.49832515813043, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -46.48521666574274, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -45.37774695435744, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -42.539788753768335, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.585233504985496, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -46.872435636724624, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -44.89199125406318, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.250987446759374, "mean_inference_ms": 0.47917739324471936, "mean_action_processing_ms": 0.0876784887902128, "mean_env_wait_ms": 8.455923152232245, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 103200, "timesteps_this_iter": 0, "agent_timesteps_total": 619200, "timers": {"sample_time_ms": 22635.056, "sample_throughput": 106.03, "load_time_ms": 0.14, "load_throughput": 17189770.492, "learn_time_ms": 119.682, "learn_throughput": 20053.172, "update_time_ms": 2.571}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58686.9375, "policy_entropy": 15574.79736328125, "policy_loss": -14553.977945963541, "vf_loss": 3519.991739908854}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 103200, "num_agent_steps_sampled": 619200, "num_steps_trained": 103200, "num_agent_steps_trained": 619200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 428, "training_iteration": 43, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-49-10", "timestamp": 1718185750, "time_this_iter_s": 22.753393411636353, "time_total_s": 966.7515704631805, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516748940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 966.7515704631805, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 3.890625, "ram_util_percent": 42.98125}}
{"episode_reward_max": -238.50207362604633, "episode_reward_min": -286.8203384202587, "episode_reward_mean": -266.47509669884477, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.80338973670989}, "policy_reward_max": {"shared_policy": -39.750345604341135}, "policy_reward_mean": {"shared_policy": -44.41251611647415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.23888738200725, -239.54371096502283, -286.21832684437965, -270.9228809949578, -276.518981282656, -240.74074372860682, -277.2184954656938, -253.44381579543432, -252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -46.53981456366781, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -39.92395182750393, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -47.703054474063116, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -45.153813499159654, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -46.08649688044261, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -40.12345728810112, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -46.20308257761578, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.240635965905874, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25113618759994705, "mean_inference_ms": 0.4790762122640085, "mean_action_processing_ms": 0.08768031818944742, "mean_env_wait_ms": 8.457489968110782, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 105600, "timesteps_this_iter": 0, "agent_timesteps_total": 633600, "timers": {"sample_time_ms": 22613.225, "sample_throughput": 106.133, "load_time_ms": 0.144, "load_throughput": 16677153.082, "learn_time_ms": 119.931, "learn_throughput": 20011.482, "update_time_ms": 2.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84687.0, "policy_entropy": 15584.817057291666, "policy_loss": -13569.533854166666, "vf_loss": 4067.823974609375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 105600, "num_agent_steps_sampled": 633600, "num_steps_trained": 105600, "num_agent_steps_trained": 633600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 440, "training_iteration": 44, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-49-33", "timestamp": 1718185773, "time_this_iter_s": 22.68026614189148, "time_total_s": 989.431836605072, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bdea60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 989.431836605072, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 4.265625, "ram_util_percent": 43.13125}}
{"episode_reward_max": -237.77630084133662, "episode_reward_min": -286.8203384202587, "episode_reward_mean": -266.32868361917286, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.80338973670989}, "policy_reward_max": {"shared_policy": -39.62938347355623}, "policy_reward_mean": {"shared_policy": -44.38811393652884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-252.94954009145587, -264.136358660295, -265.61941239969826, -283.83394416456906, -271.88787001980774, -266.5392118807183, -275.1747969336088, -271.3925334702689, -276.6294186905883, -276.7020002115992, -265.1244032807984, -271.3717140395859, -269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -42.15825668190913, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.022726443382346, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -44.26990206661649, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -47.305657360761515, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -45.31464500330133, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -44.42320198011963, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.8624661556015, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -45.23208891171136, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.10490311509798, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -46.117000035266685, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -44.18740054679989, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -45.22861900659781, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512372987048104, "mean_inference_ms": 0.4790092340746189, "mean_action_processing_ms": 0.08768181445335006, "mean_env_wait_ms": 8.458574770460595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 108000, "timesteps_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"sample_time_ms": 22623.962, "sample_throughput": 106.082, "load_time_ms": 0.142, "load_throughput": 16901157.824, "learn_time_ms": 120.521, "learn_throughput": 19913.483, "update_time_ms": 2.598}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68193.4453125, "policy_entropy": 15594.437662760416, "policy_loss": -15092.864583333334, "vf_loss": 3082.277791341146}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 108000, "num_agent_steps_sampled": 648000, "num_steps_trained": 108000, "num_agent_steps_trained": 648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 448, "training_iteration": 45, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-49-56", "timestamp": 1718185796, "time_this_iter_s": 22.5913507938385, "time_total_s": 1012.0231873989105, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bde310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1012.0231873989105, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 4.206250000000001, "ram_util_percent": 43.340625}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -288.3924798661993, "episode_reward_mean": -266.18186313384075, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.06541331103312}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.36364385564015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.11985218244143, -259.9702179010506, -261.49263741418537, -275.7876564062263, -261.56068574620224, -279.5549922642111, -267.05820199935107, -283.44729300585396, -273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -44.853308697073444, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.328369650175134, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -43.58210623569767, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -45.96460940103793, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -43.59344762436705, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -46.59249871070184, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -44.50970033322517, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -47.24121550097567, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2513856380684793, "mean_inference_ms": 0.4789197715000297, "mean_action_processing_ms": 0.08768626196287696, "mean_env_wait_ms": 8.460207070492713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 110400, "timesteps_this_iter": 0, "agent_timesteps_total": 662400, "timers": {"sample_time_ms": 22633.991, "sample_throughput": 106.035, "load_time_ms": 0.143, "load_throughput": 16794010.01, "learn_time_ms": 120.411, "learn_throughput": 19931.806, "update_time_ms": 2.624}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83355.0, "policy_entropy": 15609.745930989584, "policy_loss": -14798.821126302084, "vf_loss": 3219.070556640625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 110400, "num_agent_steps_sampled": 662400, "num_steps_trained": 110400, "num_agent_steps_trained": 662400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 460, "training_iteration": 46, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-50-18", "timestamp": 1718185818, "time_this_iter_s": 22.726327180862427, "time_total_s": 1034.749514579773, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f750a679280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1034.749514579773, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 3.9606060606060605, "ram_util_percent": 43.527272727272724}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -288.3924798661993, "episode_reward_mean": -266.03971593724197, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.06541331103312}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.33995265620701}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273.6473020138193, -277.7788801455715, -269.070199376593, -276.5105159947563, -272.6715462041036, -270.78040679698097, -255.38547583912018, -271.68613585255156, -249.42197915416887, -245.01170500878465, -278.0077083873528, -261.6738133710641, -251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -45.60788366896991, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -46.296480024261776, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -44.845033229432005, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -46.085085999126086, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.445257700683925, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -45.13006779949695, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -42.56424597318677, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -45.281022642091806, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -41.57032985902831, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -40.835284168130826, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -46.334618064558825, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -43.6123022285107, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514912746248043, "mean_inference_ms": 0.4788766729708135, "mean_action_processing_ms": 0.08769125742086434, "mean_env_wait_ms": 8.461386897547792, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 112800, "timesteps_this_iter": 0, "agent_timesteps_total": 676800, "timers": {"sample_time_ms": 22652.571, "sample_throughput": 105.948, "load_time_ms": 0.148, "load_throughput": 16243875.424, "learn_time_ms": 120.735, "learn_throughput": 19878.226, "update_time_ms": 2.63}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81581.0703125, "policy_entropy": 15639.788899739584, "policy_loss": -17187.53271484375, "vf_loss": 2636.1374715169272}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 112800, "num_agent_steps_sampled": 676800, "num_steps_trained": 112800, "num_agent_steps_trained": 676800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 468, "training_iteration": 47, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-50-41", "timestamp": 1718185841, "time_this_iter_s": 22.600057125091553, "time_total_s": 1057.3495717048645, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b8a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1057.3495717048645, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 4.1156250000000005, "ram_util_percent": 43.665625}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.15687529766524, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.359479216277556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-251.58658352108068, -264.96554067375433, -271.3212634043206, -257.8007744599854, -274.5688829002945, -265.9979419630303, -244.52026432423537, -238.50207362604633, -267.24629944657, -258.295503501325, -242.38085791390841, -274.54045563092916, -251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -41.93109725351331, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -44.16092344562568, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -45.220210567386836, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -42.966795743331055, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -45.76148048338232, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -44.332990327171856, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -40.75337738737248, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -39.750345604341135, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -44.54104990776168, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -43.049250583554276, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -40.396809652317984, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -45.756742605154784, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516412490556564, "mean_inference_ms": 0.47883042899139683, "mean_action_processing_ms": 0.08770157081737114, "mean_env_wait_ms": 8.463200229556518, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 115200, "timesteps_this_iter": 0, "agent_timesteps_total": 691200, "timers": {"sample_time_ms": 22665.834, "sample_throughput": 105.886, "load_time_ms": 0.151, "load_throughput": 15945397.751, "learn_time_ms": 120.124, "learn_throughput": 19979.302, "update_time_ms": 2.616}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 95676.25, "policy_entropy": 15658.543619791666, "policy_loss": -15001.37929280599, "vf_loss": 3288.0231323242188}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 115200, "num_agent_steps_sampled": 691200, "num_steps_trained": 115200, "num_agent_steps_trained": 691200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 48, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-51-04", "timestamp": 1718185864, "time_this_iter_s": 22.730499029159546, "time_total_s": 1080.080070734024, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bd7dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1080.080070734024, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 4.24375, "ram_util_percent": 43.821875}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.39736210344205, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.399560350573694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-251.46621938803835, -239.4989579769496, -250.935255475827, -271.9469059482773, -280.09930565856064, -270.8562614537441, -248.37071300909165, -280.3235712280551, -274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -41.91103656467303, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -39.916492996158155, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -41.822542579304525, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -45.32448432471291, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -46.683217609760085, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -45.14271024229063, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -41.39511883484865, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -46.720595204675796, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2518258550116225, "mean_inference_ms": 0.47868768994276467, "mean_action_processing_ms": 0.08770492985670279, "mean_env_wait_ms": 8.463109560608823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 117600, "timesteps_this_iter": 0, "agent_timesteps_total": 705600, "timers": {"sample_time_ms": 22678.797, "sample_throughput": 105.826, "load_time_ms": 0.151, "load_throughput": 15940347.743, "learn_time_ms": 121.317, "learn_throughput": 19782.921, "update_time_ms": 2.628}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85397.6640625, "policy_entropy": 15661.671223958334, "policy_loss": -9231.867594401041, "vf_loss": 4567.202657063802}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 117600, "num_agent_steps_sampled": 705600, "num_steps_trained": 117600, "num_agent_steps_trained": 705600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 492, "training_iteration": 49, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-51-26", "timestamp": 1718185886, "time_this_iter_s": 22.712092876434326, "time_total_s": 1102.7921636104584, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f756d45a670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1102.7921636104584, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 4.1090909090909085, "ram_util_percent": 44.05454545454545}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.45812285915036, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.40968714319176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-274.05463761534696, -271.70937751361413, -254.06116664054161, -276.1778761390165, -253.39571248947829, -259.69979866556366, -268.8355936467823, -280.93833651711486, -244.08042242716724, -266.83731484060627, -271.7001122525583, -256.4065060144774, -275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.675772935891125, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -45.284896252269114, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -42.343527773423595, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -46.029646023169384, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -42.232618748246466, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -43.28329977759412, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -44.80593227446372, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -46.82305608618608, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -40.68007040452794, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -44.47288580676757, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -45.283352042093206, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -42.734417669079434, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2519157923742478, "mean_inference_ms": 0.4787336183339282, "mean_action_processing_ms": 0.08771124151466492, "mean_env_wait_ms": 8.466255866276914, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 22681.093, "sample_throughput": 105.815, "load_time_ms": 0.153, "load_throughput": 15726182.784, "learn_time_ms": 121.331, "learn_throughput": 19780.662, "update_time_ms": 2.658}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93811.3984375, "policy_entropy": 15668.230794270834, "policy_loss": -12242.403844197592, "vf_loss": 3667.927978515625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 720000, "num_steps_trained": 120000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -249.321005438085, "episode_reward_min": -275.7620185295645, "episode_reward_mean": -262.5388544393219, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -45.96033642159409}, "policy_reward_max": {"shared_policy": -41.55350090634758}, "policy_reward_mean": {"shared_policy": -43.75647573988701}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-271.2515556345293, -249.321005438085, -264.8493322739079, -275.7620185295645, -273.98614030707716, -269.40588412474443, -269.30367536465644, -251.68890546074914, -249.38406479099422, -250.43596246891067], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.208592605755015, -45.208592605755015, -45.208592605755015, -45.208592605755015, -45.208592605755015, -45.208592605755015, -41.55350090634758, -41.55350090634758, -41.55350090634758, -41.55350090634758, -41.55350090634758, -41.55350090634758, -44.14155537898463, -44.14155537898463, -44.14155537898463, -44.14155537898463, -44.14155537898463, -44.14155537898463, -45.96033642159409, -45.96033642159409, -45.96033642159409, -45.96033642159409, -45.96033642159409, -45.96033642159409, -45.664356717846125, -45.664356717846125, -45.664356717846125, -45.664356717846125, -45.664356717846125, -45.664356717846125, -44.90098068745729, -44.90098068745729, -44.90098068745729, -44.90098068745729, -44.90098068745729, -44.90098068745729, -44.883945894109374, -44.883945894109374, -44.883945894109374, -44.883945894109374, -44.883945894109374, -44.883945894109374, -41.948150910124994, -41.948150910124994, -41.948150910124994, -41.948150910124994, -41.948150910124994, -41.948150910124994, -41.56401079849923, -41.56401079849923, -41.56401079849923, -41.56401079849923, -41.56401079849923, -41.56401079849923, -41.73932707815176, -41.73932707815176, -41.73932707815176, -41.73932707815176, -41.73932707815176, -41.73932707815176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1916778680920252, "mean_inference_ms": 0.482583135702978, "mean_action_processing_ms": 0.0854734096104308, "mean_env_wait_ms": 8.301782787519238, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 500, "training_iteration": 50, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-52-11", "timestamp": 1718185931, "time_this_iter_s": 44.28241014480591, "time_total_s": 1147.0745737552643, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516a7a550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1147.0745737552643, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 3.866129032258064, "ram_util_percent": 44.29193548387097}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -267.1410108088765, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.52350180147945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.1482734192475, -275.35431470396134, -262.75055733303134, -258.8661372423925, -249.08765681662638, -277.74225430581447, -283.8601053646524, -265.9874637659043, -270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.85804556987449, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -45.89238578399367, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.79175955550528, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -43.14435620706538, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -41.514609469437616, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -46.29037571763573, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -47.310017560775506, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -44.33124396098412, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2519998893369288, "mean_inference_ms": 0.4785825228274173, "mean_action_processing_ms": 0.08770641715708224, "mean_env_wait_ms": 8.465752834562963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 122400, "timesteps_this_iter": 0, "agent_timesteps_total": 734400, "timers": {"sample_time_ms": 24825.73, "sample_throughput": 96.674, "load_time_ms": 0.153, "load_throughput": 15645523.158, "learn_time_ms": 121.611, "learn_throughput": 19735.127, "update_time_ms": 2.634}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88096.09375, "policy_entropy": 15676.479654947916, "policy_loss": -11584.405192057291, "vf_loss": 4522.204895019531}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 122400, "num_agent_steps_sampled": 734400, "num_steps_trained": 122400, "num_agent_steps_trained": 734400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 512, "training_iteration": 51, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-52-33", "timestamp": 1718185953, "time_this_iter_s": 22.161927461624146, "time_total_s": 1169.2365012168884, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bde820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1169.2365012168884, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 3.903125, "ram_util_percent": 44.36875}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.50433996097587, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.417389993496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-270.2466062745291, -264.3564707120887, -268.05214680740994, -259.4694834724311, -257.74425440531115, -273.5579750136151, -268.66632701191367, -286.8203384202587, -272.39914041209255, -266.2501509511285, -284.52413511653674, -264.06179911215014, -273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -45.04110104575498, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.05941178534817, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -44.67535780123494, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -43.24491391207201, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -42.957375734218665, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -45.59299583560248, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -44.77772116865239, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -47.80338973670989, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -45.39985673534888, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -44.37502515852127, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -47.42068918608963, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -44.01029985202513, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2519488173464216, "mean_inference_ms": 0.47861299859341244, "mean_action_processing_ms": 0.08770701455050489, "mean_env_wait_ms": 8.46872506726769, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 124800, "timesteps_this_iter": 0, "agent_timesteps_total": 748800, "timers": {"sample_time_ms": 24800.181, "sample_throughput": 96.773, "load_time_ms": 0.155, "load_throughput": 15458122.85, "learn_time_ms": 121.536, "learn_throughput": 19747.264, "update_time_ms": 2.675}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 87172.5859375, "policy_entropy": 15700.79248046875, "policy_loss": -13942.722493489584, "vf_loss": 3376.796915690104}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124800, "num_agent_steps_sampled": 748800, "num_steps_trained": 124800, "num_agent_steps_trained": 748800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 520, "training_iteration": 52, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-52-55", "timestamp": 1718185975, "time_this_iter_s": 22.611669301986694, "time_total_s": 1191.8481705188751, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516f01ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1191.8481705188751, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 4.20625, "ram_util_percent": 44.621875}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -267.0121373006699, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.502022883444994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273.27930677784803, -265.9335013815072, -273.6179048253659, -277.4798239518038, -283.80180231439954, -266.80894055570707, -262.7246522159161, -250.9534095684008, -274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -45.54655112964137, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -44.32225023025106, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -45.60298413756083, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -46.24663732530068, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -47.3003003857335, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -44.468156759284554, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -43.787442035986096, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -41.82556826140012, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25201574567331175, "mean_inference_ms": 0.47844153574546155, "mean_action_processing_ms": 0.08769719334942427, "mean_env_wait_ms": 8.467513039027654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 127200, "timesteps_this_iter": 0, "agent_timesteps_total": 763200, "timers": {"sample_time_ms": 24768.634, "sample_throughput": 96.897, "load_time_ms": 0.158, "load_throughput": 15222031.756, "learn_time_ms": 121.12, "learn_throughput": 19814.985, "update_time_ms": 2.698}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89428.1640625, "policy_entropy": 15696.187337239584, "policy_loss": -13900.506754557291, "vf_loss": 3847.756062825521}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 127200, "num_agent_steps_sampled": 763200, "num_steps_trained": 127200, "num_agent_steps_trained": 763200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 532, "training_iteration": 53, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-53-18", "timestamp": 1718185998, "time_this_iter_s": 22.433268308639526, "time_total_s": 1214.2814388275146, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bd7790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1214.2814388275146, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 4.16875, "ram_util_percent": 44.703125}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -267.02859678561634, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.50476613093606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-274.60378662238384, -281.69411790516557, -277.5419416606532, -237.77630084133662, -250.31277390460116, -239.21448993002184, -282.8837710023558, -265.17735262505533, -288.3924798661993, -273.28019264394965, -278.33486563497695, -273.94834055633925, -278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -45.76729777039742, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.949019650860976, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -46.256990276775426, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -39.62938347355623, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -41.71879565076689, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -39.86908165500367, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -47.14729516705924, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -44.1962254375093, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -48.06541331103312, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -45.54669877399194, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -46.389144272496175, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -45.65805675938998, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2519601958574043, "mean_inference_ms": 0.47845992196997955, "mean_action_processing_ms": 0.08769675195690793, "mean_env_wait_ms": 8.470162508621982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 129600, "timesteps_this_iter": 0, "agent_timesteps_total": 777600, "timers": {"sample_time_ms": 24744.17, "sample_throughput": 96.993, "load_time_ms": 0.153, "load_throughput": 15686971.482, "learn_time_ms": 121.01, "learn_throughput": 19833.026, "update_time_ms": 2.684}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88375.6953125, "policy_entropy": 15720.23388671875, "policy_loss": -15603.08203125, "vf_loss": 2871.2758992513022}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 129600, "num_agent_steps_sampled": 777600, "num_steps_trained": 129600, "num_agent_steps_trained": 777600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 540, "training_iteration": 54, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-53-40", "timestamp": 1718186020, "time_this_iter_s": 22.437721967697144, "time_total_s": 1236.7191607952118, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7559d838b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1236.7191607952118, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 4.159375000000001, "ram_util_percent": 44.8875}}
{"episode_reward_max": -234.00798671823244, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.6870614165579, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.00133111970536}, "policy_reward_mean": {"shared_policy": -44.44784356942632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-278.44582355450785, -234.00798671823244, -277.22261347442077, -272.8783451241466, -240.44589875291365, -261.3334696775469, -277.4719488475918, -270.91719045895326, -261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -46.40763725908469, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -39.00133111970536, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -46.20376891240341, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -45.479724187357995, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -40.07431645881882, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -43.55557827959124, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -46.245324807931695, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -45.15286507649209, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2520165051301386, "mean_inference_ms": 0.47829992694422396, "mean_action_processing_ms": 0.0876852940117231, "mean_env_wait_ms": 8.468375574306716, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 132000, "timesteps_this_iter": 0, "agent_timesteps_total": 792000, "timers": {"sample_time_ms": 24720.282, "sample_throughput": 97.086, "load_time_ms": 0.156, "load_throughput": 15413152.044, "learn_time_ms": 120.263, "learn_throughput": 19956.187, "update_time_ms": 2.662}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56497.46875, "policy_entropy": 15738.565755208334, "policy_loss": -15936.579264322916, "vf_loss": 2724.2368774414062}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 132000, "num_agent_steps_sampled": 792000, "num_steps_trained": 132000, "num_agent_steps_trained": 792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 552, "training_iteration": 55, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-54-03", "timestamp": 1718186043, "time_this_iter_s": 22.348164081573486, "time_total_s": 1259.0673248767853, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bd7550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1259.0673248767853, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 4.1375, "ram_util_percent": 45.08125}}
{"episode_reward_max": -234.7991415140505, "episode_reward_min": -293.9668369762247, "episode_reward_mean": -266.9694135251146, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.99447282937083}, "policy_reward_max": {"shared_policy": -39.133190252341585}, "policy_reward_mean": {"shared_policy": -44.494902254185774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-261.3548728393644, -253.10055957338616, -273.73546389279505, -268.25353056131445, -283.9303857468847, -279.34822238758807, -272.4210975119787, -251.63268474633477, -251.54553591117275, -293.9668369762247, -271.3458757082555, -263.9018715647113, -271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -43.559145473227254, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -42.183426595564214, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -45.62257731546568, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -44.70892176021912, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -47.32173095781407, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -46.55803706459811, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -45.40351625199638, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.93878079105562, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -41.92425598519555, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -48.99447282937083, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -45.22431261804249, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -43.98364526078527, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25195353914101354, "mean_inference_ms": 0.4783052586128961, "mean_action_processing_ms": 0.08768170383659112, "mean_env_wait_ms": 8.47071236845863, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 134400, "timesteps_this_iter": 0, "agent_timesteps_total": 806400, "timers": {"sample_time_ms": 24689.754, "sample_throughput": 97.206, "load_time_ms": 0.161, "load_throughput": 14899836.59, "learn_time_ms": 120.547, "learn_throughput": 19909.167, "update_time_ms": 2.637}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65737.34375, "policy_entropy": 15733.137532552084, "policy_loss": -14151.743815104166, "vf_loss": 3164.2061157226562}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 134400, "num_agent_steps_sampled": 806400, "num_steps_trained": 134400, "num_agent_steps_trained": 806400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 560, "training_iteration": 56, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-54-25", "timestamp": 1718186065, "time_this_iter_s": 22.430769443511963, "time_total_s": 1281.4980943202972, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75167488b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1281.4980943202972, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 4.087096774193548, "ram_util_percent": 45.1225806451613}}
{"episode_reward_max": -234.7991415140505, "episode_reward_min": -289.92327201439633, "episode_reward_mean": -266.5307158271932, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.32054533573257}, "policy_reward_max": {"shared_policy": -39.133190252341585}, "policy_reward_mean": {"shared_policy": -44.42178597119888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-271.00112483514016, -250.03805637523806, -280.02445514925324, -243.06106555825346, -282.72381937743285, -261.9918325672669, -261.48488096774776, -282.2762491964956, -267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -45.166854139190114, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -41.673009395873, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -46.670742524875465, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -40.51017759304226, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -47.12063656290534, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.66530542787789, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -43.58081349462459, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -47.046041532749214, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2519909740510261, "mean_inference_ms": 0.47813424344855826, "mean_action_processing_ms": 0.08766503497842416, "mean_env_wait_ms": 8.468301475393202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 136800, "timesteps_this_iter": 0, "agent_timesteps_total": 820800, "timers": {"sample_time_ms": 24656.886, "sample_throughput": 97.336, "load_time_ms": 0.157, "load_throughput": 15265892.63, "learn_time_ms": 120.38, "learn_throughput": 19936.938, "update_time_ms": 2.63}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 78454.0703125, "policy_entropy": 15753.049967447916, "policy_loss": -7828.5131098429365, "vf_loss": 5157.7210693359375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 136800, "num_agent_steps_sampled": 820800, "num_steps_trained": 136800, "num_agent_steps_trained": 820800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 572, "training_iteration": 57, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-54-47", "timestamp": 1718186087, "time_this_iter_s": 22.26660943031311, "time_total_s": 1303.7647037506104, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bde8b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1303.7647037506104, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 4.14375, "ram_util_percent": 45.38125}}
{"episode_reward_max": -234.7991415140505, "episode_reward_min": -289.92327201439633, "episode_reward_mean": -266.56005917711195, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.32054533573257}, "policy_reward_max": {"shared_policy": -39.133190252341585}, "policy_reward_mean": {"shared_policy": -44.42667652951867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-267.57812319438443, -252.84970159814205, -279.34199839289477, -264.47810755359956, -246.7463995926954, -272.9950182499783, -248.33559249433088, -253.98382926262016, -255.7250487301105, -264.94896261263335, -276.04641169187727, -252.74592856989437, -258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -44.59635386573068, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -42.14161693302371, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -46.556999732149045, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -44.07968459226646, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -41.124399932116035, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -45.499169708329966, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -41.38926541572193, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.330638210436874, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -42.620841455018336, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -44.158160435439044, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -46.00773528197964, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -42.12432142831581, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25192200991025976, "mean_inference_ms": 0.4781242109796633, "mean_action_processing_ms": 0.08765747176655275, "mean_env_wait_ms": 8.470187668472157, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 139200, "timesteps_this_iter": 0, "agent_timesteps_total": 835200, "timers": {"sample_time_ms": 24607.281, "sample_throughput": 97.532, "load_time_ms": 0.156, "load_throughput": 15406075.298, "learn_time_ms": 120.405, "learn_throughput": 19932.758, "update_time_ms": 2.637}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 86374.8046875, "policy_entropy": 15742.207356770834, "policy_loss": -11760.131546020508, "vf_loss": 4011.425252278646}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 139200, "num_agent_steps_sampled": 835200, "num_steps_trained": 139200, "num_agent_steps_trained": 835200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 580, "training_iteration": 58, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-55-10", "timestamp": 1718186110, "time_this_iter_s": 22.235366821289062, "time_total_s": 1326.0000705718994, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516f01ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1326.0000705718994, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 4.140625, "ram_util_percent": 45.546875}}
{"episode_reward_max": -234.7991415140505, "episode_reward_min": -289.92327201439633, "episode_reward_mean": -267.2730106783173, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.32054533573257}, "policy_reward_max": {"shared_policy": -39.133190252341585}, "policy_reward_mean": {"shared_policy": -44.54550177971955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-258.4988331957939, -270.30926624484266, -245.13852848944964, -270.09787574096305, -270.9560224378108, -279.95061939359005, -239.04403704149448, -265.5780831654338, -269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -43.083138865965545, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -45.05154437414057, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -40.85642141490838, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.01631262349382, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -45.1593370729685, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -46.65843656559819, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -39.84067284024928, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.26301386090573, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2518772215399967, "mean_inference_ms": 0.47800690661925105, "mean_action_processing_ms": 0.08763940107820062, "mean_env_wait_ms": 8.469327044669972, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 141600, "timesteps_this_iter": 0, "agent_timesteps_total": 849600, "timers": {"sample_time_ms": 24567.666, "sample_throughput": 97.689, "load_time_ms": 0.154, "load_throughput": 15572910.891, "learn_time_ms": 119.656, "learn_throughput": 20057.532, "update_time_ms": 2.645}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69195.0234375, "policy_entropy": 15760.3115234375, "policy_loss": -9771.46533203125, "vf_loss": 4701.761311848958}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 141600, "num_agent_steps_sampled": 849600, "num_steps_trained": 141600, "num_agent_steps_trained": 849600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 592, "training_iteration": 59, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-55-32", "timestamp": 1718186132, "time_this_iter_s": 22.30662512779236, "time_total_s": 1348.3066956996918, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b80d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1348.3066956996918, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 3.953125, "ram_util_percent": 45.64687500000001}}
{"episode_reward_max": -234.7991415140505, "episode_reward_min": -289.92327201439633, "episode_reward_mean": -267.17994112366915, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.32054533573257}, "policy_reward_max": {"shared_policy": -39.133190252341585}, "policy_reward_mean": {"shared_policy": -44.52999018727819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.48656317556805, -277.93686090413553, -277.70484418175147, -273.2672204461481, -281.239112007107, -280.7141931520554, -234.7991415140505, -238.9616911264139, -275.1474925950671, -273.5942522617601, -277.31363257667914, -286.0206457941423, -279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -44.91442719592778, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.32281015068934, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -46.284140696958545, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -45.54453674102487, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.87318533451781, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -46.78569885867622, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.133190252341585, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -39.8269485210688, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.85791543251131, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -45.599042043626795, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -46.21893876277989, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -47.670107632356995, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25184458664237214, "mean_inference_ms": 0.47792308823280183, "mean_action_processing_ms": 0.08762606761646097, "mean_env_wait_ms": 8.468588121548175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"sample_time_ms": 24534.638, "sample_throughput": 97.821, "load_time_ms": 0.153, "load_throughput": 15723726.336, "learn_time_ms": 119.069, "learn_throughput": 20156.412, "update_time_ms": 2.608}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80895.0078125, "policy_entropy": 15785.047688802084, "policy_loss": -12952.658854166666, "vf_loss": 3519.1292317708335}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 864000, "num_steps_trained": 144000, "num_agent_steps_trained": 864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 600, "training_iteration": 60, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-55-54", "timestamp": 1718186154, "time_this_iter_s": 22.265251636505127, "time_total_s": 1370.571947336197, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f756d45aaf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1370.571947336197, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 4.1096774193548375, "ram_util_percent": 45.890322580645176}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.69743094142615, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.61623849023768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.1321305017141, -273.8300413699383, -269.58964139947267, -252.7057642761798, -259.0579635985207, -249.27745924577653, -246.0834443959215, -255.4532333740474, -265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -46.52202175028576, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -45.63834022832303, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -44.93160689991206, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -42.11762737936329, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -43.17632726642007, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.54624320762947, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -41.01390739932017, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -42.57553889567465, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517942611728753, "mean_inference_ms": 0.4778019653424447, "mean_action_processing_ms": 0.08760952762608597, "mean_env_wait_ms": 8.46776117971067, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 146400, "timesteps_this_iter": 0, "agent_timesteps_total": 878400, "timers": {"sample_time_ms": 22389.955, "sample_throughput": 107.191, "load_time_ms": 0.152, "load_throughput": 15815128.987, "learn_time_ms": 118.369, "learn_throughput": 20275.541, "update_time_ms": 2.614}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107315.7109375, "policy_entropy": 15791.979654947916, "policy_loss": -12663.299235026041, "vf_loss": 4004.5721842447915}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 146400, "num_agent_steps_sampled": 878400, "num_steps_trained": 146400, "num_agent_steps_trained": 878400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 612, "training_iteration": 61, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-56-17", "timestamp": 1718186177, "time_this_iter_s": 22.40636372566223, "time_total_s": 1392.9783110618591, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bdeaf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1392.9783110618591, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 4.253125, "ram_util_percent": 46.08749999999999}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.96618266701114, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.66103044450185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-265.7327193521458, -277.35392258786885, -265.3501575490481, -272.7238180803032, -275.6891338392342, -272.2112790093217, -289.92327201439633, -285.1524751421785, -277.51585597879745, -271.86348438224707, -272.9676052227418, -260.4448385205804, -240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -44.288786558691015, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -46.22565376464473, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -44.22502625817472, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.45396968005051, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.94818897320571, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -45.36854650155359, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -48.32054533573257, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -47.525412523696616, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -46.252642663132896, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.310580730374326, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -45.49460087045695, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -43.4074730867635, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517553353047489, "mean_inference_ms": 0.47769748639004034, "mean_action_processing_ms": 0.08759727993707632, "mean_env_wait_ms": 8.467017356260781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 148800, "timesteps_this_iter": 0, "agent_timesteps_total": 892800, "timers": {"sample_time_ms": 22348.071, "sample_throughput": 107.392, "load_time_ms": 0.151, "load_throughput": 15869982.027, "learn_time_ms": 118.45, "learn_throughput": 20261.686, "update_time_ms": 2.624}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84821.25, "policy_entropy": 15810.775390625, "policy_loss": -14592.739908854166, "vf_loss": 2799.7547810872397}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 148800, "num_agent_steps_sampled": 892800, "num_steps_trained": 148800, "num_agent_steps_trained": 892800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 620, "training_iteration": 62, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-56-39", "timestamp": 1718186199, "time_this_iter_s": 22.200340270996094, "time_total_s": 1415.1786513328552, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f751776b790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1415.1786513328552, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 4.46875, "ram_util_percent": 46.203125}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.1798271580693, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.529971193011555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-240.83625247156007, -270.44892840343874, -268.69598498812576, -270.90817977847433, -280.1692391270058, -279.5585460351783, -267.689650194861, -277.93850908694355, -257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -40.13937541192654, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -45.07482140057321, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -44.78266416468777, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -45.1513632964123, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.69487318783438, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -46.59309100586328, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -44.614941699143515, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -46.32308484782393, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516927716813095, "mean_inference_ms": 0.47753554440496143, "mean_action_processing_ms": 0.08757795776442925, "mean_env_wait_ms": 8.465897200301809, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 151200, "timesteps_this_iter": 0, "agent_timesteps_total": 907200, "timers": {"sample_time_ms": 22341.665, "sample_throughput": 107.423, "load_time_ms": 0.147, "load_throughput": 16328190.754, "learn_time_ms": 118.509, "learn_throughput": 20251.678, "update_time_ms": 2.612}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89530.75, "policy_entropy": 15833.539876302084, "policy_loss": -14754.805501302084, "vf_loss": 2655.8277587890625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 151200, "num_agent_steps_sampled": 907200, "num_steps_trained": 151200, "num_agent_steps_trained": 907200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 632, "training_iteration": 63, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-57-01", "timestamp": 1718186221, "time_this_iter_s": 22.370461225509644, "time_total_s": 1437.5491125583649, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b85e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1437.5491125583649, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 4.016129032258063, "ram_util_percent": 46.34838709677421}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -266.98442476152445, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.49740412692073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-257.56366097550745, -255.15074088848763, -283.79393037712015, -241.8324686385996, -286.53091051054537, -251.00169217735805, -273.41107572676714, -278.9052829662548, -261.8448475145091, -262.2023044592824, -267.6005918290981, -269.16937022367046, -277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.927276829251234, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -42.52512348141458, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -47.29898839618649, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -40.30541143976667, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -47.755151751757715, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -41.83361536289296, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -45.56851262112779, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -46.48421382770903, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.64080791908469, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -43.70038407654717, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.60009863818297, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -44.86156170394488, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516440316042927, "mean_inference_ms": 0.4774150597760832, "mean_action_processing_ms": 0.0875639559606363, "mean_env_wait_ms": 8.465164826673647, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 153600, "timesteps_this_iter": 0, "agent_timesteps_total": 921600, "timers": {"sample_time_ms": 22336.635, "sample_throughput": 107.447, "load_time_ms": 0.148, "load_throughput": 16212481.237, "learn_time_ms": 118.296, "learn_throughput": 20288.103, "update_time_ms": 2.61}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99721.7734375, "policy_entropy": 15850.87109375, "policy_loss": -13065.872395833334, "vf_loss": 3230.0233764648438}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 153600, "num_agent_steps_sampled": 921600, "num_steps_trained": 153600, "num_agent_steps_trained": 921600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 640, "training_iteration": 64, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-57-24", "timestamp": 1718186244, "time_this_iter_s": 22.385618925094604, "time_total_s": 1459.9347314834595, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f751776b940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1459.9347314834595, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 4.271875, "ram_util_percent": 46.599999999999994}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.12807127442767, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.5213452124046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-277.6377348718863, -282.4775599209102, -260.8852810066423, -248.8497799920812, -278.2638951796487, -243.5118477376368, -270.8737682929376, -278.45862046223897, -244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -46.27295581198104, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -47.07959332015178, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -43.4808801677737, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -41.474963332013424, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -46.37731586327463, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -40.58530795627287, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -45.145628048822985, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -46.40977007703999, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2515762423941311, "mean_inference_ms": 0.4772460931993963, "mean_action_processing_ms": 0.08754383137730587, "mean_env_wait_ms": 8.464075297148064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 156000, "timesteps_this_iter": 0, "agent_timesteps_total": 936000, "timers": {"sample_time_ms": 22334.279, "sample_throughput": 107.458, "load_time_ms": 0.147, "load_throughput": 16320249.027, "learn_time_ms": 118.569, "learn_throughput": 20241.335, "update_time_ms": 2.622}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120120.4453125, "policy_entropy": 15875.141927083334, "policy_loss": -6784.484537760417, "vf_loss": 5811.3206787109375}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 156000, "num_agent_steps_sampled": 936000, "num_steps_trained": 156000, "num_agent_steps_trained": 936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 652, "training_iteration": 65, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-57-46", "timestamp": 1718186266, "time_this_iter_s": 22.32811665534973, "time_total_s": 1482.2628481388092, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516f01dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1482.2628481388092, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 4.0625, "ram_util_percent": 46.78125}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.4697720830922, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.578295347182035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-244.88569953847994, -276.9835822847842, -253.9237296303641, -269.43370697454685, -260.60609154144936, -271.3678736590764, -273.59216543871514, -252.8186443436175, -276.06229450392095, -245.34369195331647, -275.17235560386104, -280.4773321557415, -240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -40.81428325641331, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -46.16393038079722, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -42.32062160506082, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -44.90561782909122, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -43.4343485902416, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.227978943179366, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -45.59869423978595, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -42.13644072393614, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -46.01038241732019, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -40.89061532555248, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -45.8620592673102, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -46.7462220259571, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25154658096573934, "mean_inference_ms": 0.4771670968309085, "mean_action_processing_ms": 0.08753323373588678, "mean_env_wait_ms": 8.463557476165683, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 158400, "timesteps_this_iter": 0, "agent_timesteps_total": 950400, "timers": {"sample_time_ms": 22382.778, "sample_throughput": 107.225, "load_time_ms": 0.144, "load_throughput": 16704828.41, "learn_time_ms": 118.087, "learn_throughput": 20324.047, "update_time_ms": 2.703}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70716.328125, "policy_entropy": 15881.264485677084, "policy_loss": -11169.085327148438, "vf_loss": 4294.070251464844}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 158400, "num_agent_steps_sampled": 950400, "num_steps_trained": 158400, "num_agent_steps_trained": 950400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 660, "training_iteration": 66, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-58-09", "timestamp": 1718186289, "time_this_iter_s": 22.908353805541992, "time_total_s": 1505.1712019443512, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f756d45aaf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1505.1712019443512, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 4.087878787878787, "ram_util_percent": 46.88181818181818}}
{"episode_reward_max": -240.15185311763994, "episode_reward_min": -290.157506739972, "episode_reward_mean": -267.6040873012191, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -40.025308852939986}, "policy_reward_mean": {"shared_policy": -44.60068121686985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-240.15185311763994, -281.5006343256645, -275.8756042444834, -266.0716180945911, -240.65581121225566, -275.8322461660507, -283.6126334040733, -271.8354184539439, -249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -40.025308852939986, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -46.916772387610834, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -45.9792673740807, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -44.345269682431635, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -40.10930186870942, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -45.97204102767517, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -47.26877223401229, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -45.30590307565736, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2515127429093228, "mean_inference_ms": 0.47706121953552405, "mean_action_processing_ms": 0.08751878923648723, "mean_env_wait_ms": 8.463065457683392, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 160800, "timesteps_this_iter": 0, "agent_timesteps_total": 964800, "timers": {"sample_time_ms": 22418.473, "sample_throughput": 107.055, "load_time_ms": 0.147, "load_throughput": 16330839.714, "learn_time_ms": 118.432, "learn_throughput": 20264.72, "update_time_ms": 2.71}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91109.9765625, "policy_entropy": 15891.60107421875, "policy_loss": -8358.739990234375, "vf_loss": 5023.783711751302}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160800, "num_agent_steps_sampled": 964800, "num_steps_trained": 160800, "num_agent_steps_trained": 964800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 672, "training_iteration": 67, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-58-32", "timestamp": 1718186312, "time_this_iter_s": 22.628485679626465, "time_total_s": 1527.7996876239777, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f750a685e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1527.7996876239777, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 4.10625, "ram_util_percent": 47.05624999999999}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -290.157506739972, "episode_reward_mean": -266.8380944246931, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.473015737448854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-249.6281057357634, -274.6146447996079, -271.75073115020706, -272.31280618685275, -240.964360603789, -267.2979703131239, -275.3834709431923, -284.91777518249154, -264.9570439149378, -274.02239987656026, -266.883262735508, -264.33770062165655, -275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -41.604684289294006, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.769107466601284, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.291788525034434, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -45.38546769780869, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -40.16072676729816, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -44.54966171885413, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -45.897245157198626, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -47.486295863748666, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -44.15950731915637, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -45.67039997942675, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.48054378925125, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -44.05628343694266, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2515000890451867, "mean_inference_ms": 0.47700751517504597, "mean_action_processing_ms": 0.08751144228435366, "mean_env_wait_ms": 8.462922425503363, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 163200, "timesteps_this_iter": 0, "agent_timesteps_total": 979200, "timers": {"sample_time_ms": 22456.732, "sample_throughput": 106.872, "load_time_ms": 0.147, "load_throughput": 16307029.969, "learn_time_ms": 118.49, "learn_throughput": 20254.812, "update_time_ms": 2.73}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97446.8203125, "policy_entropy": 15930.0966796875, "policy_loss": -10864.460815429688, "vf_loss": 3427.4101765950522}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 163200, "num_agent_steps_sampled": 979200, "num_steps_trained": 163200, "num_agent_steps_trained": 979200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 680, "training_iteration": 68, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-58-54", "timestamp": 1718186334, "time_this_iter_s": 22.617027044296265, "time_total_s": 1550.416714668274, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b8820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1550.416714668274, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 4.378125000000001, "ram_util_percent": 47.268750000000004}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -290.157506739972, "episode_reward_mean": -266.59019622957726, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.431699371596196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.68331821365234, -246.63977547355228, -267.50067385079404, -264.185542011938, -253.15608963874013, -270.81755420419574, -266.46845747445894, -245.81489937722964, -275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -45.94721970227554, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -41.1066292455919, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.58344564179915, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -44.03092366865643, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -42.19268160645657, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -45.13625903403257, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -44.41140957907645, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -40.969149896204904, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514845702396002, "mean_inference_ms": 0.4769534465429671, "mean_action_processing_ms": 0.08750318964052463, "mean_env_wait_ms": 8.463009108634667, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 165600, "timesteps_this_iter": 0, "agent_timesteps_total": 993600, "timers": {"sample_time_ms": 22499.455, "sample_throughput": 106.669, "load_time_ms": 0.149, "load_throughput": 16070130.268, "learn_time_ms": 118.052, "learn_throughput": 20330.068, "update_time_ms": 2.706}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 82152.6640625, "policy_entropy": 15960.308268229166, "policy_loss": -11130.3466796875, "vf_loss": 4019.6869099934897}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 165600, "num_agent_steps_sampled": 993600, "num_steps_trained": 165600, "num_agent_steps_trained": 993600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 692, "training_iteration": 69, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-59-17", "timestamp": 1718186357, "time_this_iter_s": 22.727745532989502, "time_total_s": 1573.1444602012634, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bde820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1573.1444602012634, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 4.203125, "ram_util_percent": 47.425}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -290.157506739972, "episode_reward_mean": -266.48795865455213, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -48.35958445666191}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.414659775758686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.5232867893177, -273.37799543798445, -272.90655092940176, -274.07730641257507, -247.22456269855317, -281.70373475472354, -270.1668186851481, -272.68557505494823, -274.67332516209893, -290.157506739972, -281.45326762496575, -283.98470122089054, -271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.92054779821965, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.56299923966385, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.48442515490022, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -45.67955106876257, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -41.20409378309222, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -46.95062245912062, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.02780311419119, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.44759584249124, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -45.77888752701646, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -48.35958445666191, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -46.90887793749424, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -47.330783536815, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514814389851051, "mean_inference_ms": 0.47693221357292825, "mean_action_processing_ms": 0.08749904163247418, "mean_env_wait_ms": 8.463229135330451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 1008000, "timers": {"sample_time_ms": 22534.498, "sample_throughput": 106.503, "load_time_ms": 0.15, "load_throughput": 16026635.249, "learn_time_ms": 118.55, "learn_throughput": 20244.592, "update_time_ms": 2.71}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71003.6484375, "policy_entropy": 16010.295735677084, "policy_loss": -13670.41796875, "vf_loss": 2766.167195638021}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 1008000, "num_steps_trained": 168000, "num_agent_steps_trained": 1008000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 700, "training_iteration": 70, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_18-59-40", "timestamp": 1718186380, "time_this_iter_s": 22.624080419540405, "time_total_s": 1595.7685406208038, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f751776b790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1595.7685406208038, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 4.39375, "ram_util_percent": 47.584374999999994}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -286.5458245508027, "episode_reward_mean": -265.5422650669581, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.75763742513379}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.25704417782635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-271.6679811001448, -273.8108407565677, -269.2595943162027, -257.888515748781, -272.2991362907769, -261.9427925734907, -263.2159152093961, -241.92007472471226, -278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.27799685002423, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -45.6351401260946, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -44.87659905270039, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -42.98141929146362, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -45.38318938179604, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.65713209558172, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -43.86931920156603, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -40.3200124541187, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514788973750454, "mean_inference_ms": 0.4769154908024217, "mean_action_processing_ms": 0.08749452042656312, "mean_env_wait_ms": 8.463747052280011, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 170400, "timesteps_this_iter": 0, "agent_timesteps_total": 1022400, "timers": {"sample_time_ms": 22564.208, "sample_throughput": 106.363, "load_time_ms": 0.149, "load_throughput": 16088108.678, "learn_time_ms": 118.673, "learn_throughput": 20223.576, "update_time_ms": 2.721}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68551.78125, "policy_entropy": 16040.66552734375, "policy_loss": -14389.313313802084, "vf_loss": 2627.3358154296875}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 170400, "num_agent_steps_sampled": 1022400, "num_steps_trained": 170400, "num_agent_steps_trained": 1022400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 712, "training_iteration": 71, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_19-00-02", "timestamp": 1718186402, "time_this_iter_s": 22.699965238571167, "time_total_s": 1618.468505859375, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516bdeaf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1618.468505859375, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 4.203125, "ram_util_percent": 47.75}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -286.5458245508027, "episode_reward_mean": -265.9439506739033, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.75763742513379}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.323991778983874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-278.9424148860268, -265.86659963613397, -263.50144856510127, -278.03771828050395, -267.46544122730404, -265.8421292681093, -269.1409207911318, -277.0581390314773, -274.29353632325905, -240.72478934408258, -269.65242882084993, -257.76744461070433, -268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -46.49040248100456, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -44.31109993935567, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -43.91690809418336, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -46.33961971341722, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.577573537884, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.307021544684886, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -44.85682013185524, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -46.176356505246304, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -45.71558938720988, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -40.120798224013676, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -44.94207147014161, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -42.961240768450644, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25147701992016663, "mean_inference_ms": 0.4769091054569432, "mean_action_processing_ms": 0.08749285500130359, "mean_env_wait_ms": 8.464285649701507, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 172800, "timesteps_this_iter": 0, "agent_timesteps_total": 1036800, "timers": {"sample_time_ms": 22604.034, "sample_throughput": 106.176, "load_time_ms": 0.148, "load_throughput": 16241254.598, "learn_time_ms": 119.535, "learn_throughput": 20077.771, "update_time_ms": 2.701}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 82491.3515625, "policy_entropy": 16053.37744140625, "policy_loss": -13050.414388020834, "vf_loss": 3415.3317057291665}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172800, "num_agent_steps_sampled": 1036800, "num_steps_trained": 172800, "num_agent_steps_trained": 1036800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 720, "training_iteration": 72, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_19-00-25", "timestamp": 1718186425, "time_this_iter_s": 22.60567331314087, "time_total_s": 1641.0741791725159, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b89d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1641.0741791725159, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 4.059375, "ram_util_percent": 47.88125}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -286.5458245508027, "episode_reward_mean": -266.25599544944214, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.75763742513379}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.37599924157369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-268.86806496802757, -277.1074726614013, -275.54349565305534, -252.50114690406417, -261.28754052099816, -270.3414464679982, -263.3750245647499, -267.6808586908047, -268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -44.811344161338056, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -46.18457877690024, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -45.92391594217584, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -42.08352448401073, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -43.5479234201661, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -45.0569077446664, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -43.89583742745829, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.61347644846771, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514784813838001, "mean_inference_ms": 0.4769160092168411, "mean_action_processing_ms": 0.08749342223654404, "mean_env_wait_ms": 8.465248156891636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 175200, "timesteps_this_iter": 0, "agent_timesteps_total": 1051200, "timers": {"sample_time_ms": 22631.377, "sample_throughput": 106.047, "load_time_ms": 0.146, "load_throughput": 16389335.07, "learn_time_ms": 119.306, "learn_throughput": 20116.345, "update_time_ms": 2.699}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69670.953125, "policy_entropy": 16056.8857421875, "policy_loss": -5579.626871744792, "vf_loss": 6309.269775390625}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 175200, "num_agent_steps_sampled": 1051200, "num_steps_trained": 175200, "num_agent_steps_trained": 1051200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 732, "training_iteration": 73, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_19-00-48", "timestamp": 1718186448, "time_this_iter_s": 22.63312530517578, "time_total_s": 1663.7073044776917, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7559d83280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1663.7073044776917, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 4.153124999999999, "ram_util_percent": 48.071875}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -286.5458245508027, "episode_reward_mean": -266.31862303806537, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -47.75763742513379}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.3864371730109}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-268.09420802556184, -276.8378565813132, -241.24169407922108, -269.79077658966025, -268.78095095922106, -273.425748814933, -285.5107005522522, -258.8892538974632, -269.68676261575763, -260.35241435146384, -267.0871674419465, -263.67399366872525, -286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -44.68236800426019, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -46.1396427635522, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -40.2069490132035, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.96512943160987, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -44.79682515987026, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -45.570958135822174, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -47.58511675870883, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -43.14820898291045, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -44.94779376929278, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -43.392069058577455, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -44.51452790699105, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -43.94566561145426, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514888694387277, "mean_inference_ms": 0.47693223453434086, "mean_action_processing_ms": 0.08749547011929583, "mean_env_wait_ms": 8.466034265301406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 177600, "timesteps_this_iter": 0, "agent_timesteps_total": 1065600, "timers": {"sample_time_ms": 22668.876, "sample_throughput": 105.872, "load_time_ms": 0.146, "load_throughput": 16405361.147, "learn_time_ms": 119.529, "learn_throughput": 20078.732, "update_time_ms": 2.712}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88492.1171875, "policy_entropy": 16098.33935546875, "policy_loss": -9245.453043619791, "vf_loss": 4411.421162923177}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 177600, "num_agent_steps_sampled": 1065600, "num_steps_trained": 177600, "num_agent_steps_trained": 1065600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 740, "training_iteration": 74, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_19-01-10", "timestamp": 1718186470, "time_this_iter_s": 22.765766620635986, "time_total_s": 1686.4730710983276, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f75173b8c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1686.4730710983276, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 4.066666666666666, "ram_util_percent": 48.27878787878789}}
{"episode_reward_max": -232.759606700878, "episode_reward_min": -286.5458245508027, "episode_reward_mean": -266.098517441167, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -47.75763742513379}, "policy_reward_max": {"shared_policy": -38.79326778347965}, "policy_reward_mean": {"shared_policy": -44.34975290686117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-286.5458245508027, -248.30803446363666, -278.33405867715055, -271.52407326044283, -260.75407830391913, -271.8939658631976, -275.9283470816616, -281.84018612963075, -257.52193165163465, -265.591734249681, -259.4614599006378, -277.11339339131627, -271.87528836458625, -253.60994768595006, -249.4472956560104, -276.0943562447282, -273.7888685990126, -276.5286977949452, -270.73237041468855, -262.33334548737605, -282.52494139658245, -253.31841293286868, -232.759606700878, -258.75392910030104, -255.68153795220329, -267.66085218647595, -244.97711657337388, -263.26013452341516, -275.0013454635334, -245.0242752022382, -271.0907736132034, -253.56175374192435, -280.8252566081667, -258.92265153332306, -243.2195994006832, -246.32560233583112, -284.4268572684159, -277.4527437422609, -275.2746763783932, -271.15491726412387, -255.76764856151667, -245.52978180893206, -271.2857606066438, -271.11497583347085, -255.25856893160548, -266.7349196278943, -252.92131352296144, -261.4295838490336, -238.59006720940778, -285.17754581490084, -269.3309401309941, -268.2630863310345, -263.6992836646825, -256.36384319555015, -276.5905997880375, -266.56460964431983, -265.2929979045195, -275.1875474487236, -273.47332896109833, -264.8314226579047, -274.75020140028005, -271.55932213664113, -258.665851440702, -263.70273813501063, -280.76892227376334, -270.2905269892345, -260.57519143593447, -271.86065760302154, -284.5132340573988, -275.078818320071, -277.1921379267963, -274.07835411156714, -281.7296706554491, -272.9458650422513, -267.42533845836255, -255.59888799168075, -244.08356458806358, -265.535323101053, -267.6475535258182, -273.6687405600603, -282.0715502724523, -267.6955672257632, -259.4740708162615, -272.2824476809175, -265.3809562572238, -257.6188234294542, -268.20529713729485, -270.23909647405594, -269.9259073616797, -272.8702450185839, -271.6282247924101, -248.6718591581529, -273.2240601951604, -271.05761980056957, -261.57357401212226, -258.4850571256994, -257.9194125950274, -257.4522212062404, -262.1803080302853, -276.37247859175307], "episode_lengths": [239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239], "policy_shared_policy_reward": [-47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -47.75763742513379, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -41.38467241060603, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -46.38900977952495, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -45.25401221007384, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -43.45901305065336, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.31566097719974, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -45.9880578469436, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -46.97336435493877, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -42.920321941939015, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -44.26528904161366, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -43.243576650106334, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -46.18556556521934, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -45.31254806076447, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -42.2683246143249, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -41.57454927600174, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -46.01572604078791, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -45.631478099835675, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -46.08811629915752, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -45.12206173578139, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -43.72222424789592, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -47.087490232763855, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -42.219735488811395, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -38.79326778347965, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -43.12565485005009, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -42.61358965870051, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -44.61014203107941, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -40.82951942889573, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -43.87668908723595, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -45.83355757725544, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -40.837379200373114, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -45.18179560220057, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -42.260292290320706, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -46.80420943469436, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -43.1537752555538, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -40.53659990011387, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -41.054267055971856, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -47.40447621140265, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -46.24212395704341, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.879112729732185, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -45.19248621068732, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -42.62794142691954, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -40.921630301488676, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.21429343444082, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -45.18582930557851, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -42.543094821934396, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -44.45581993798241, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -42.15355225382688, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -43.57159730817211, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -39.76501120156797, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -47.5295909691499, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.888490021832375, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -44.71051438850564, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -43.94988061078043, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -42.72730719925823, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -46.09843329800639, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.427434940720126, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -44.215499650753124, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.86459124145417, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -45.57888816018286, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -44.138570442983976, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.791700233379835, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -45.2598870227733, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.11097524011697, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -43.95045635583527, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -46.79482037896046, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -45.048421164872394, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -43.42919857265587, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -45.310109600503694, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -47.418872342899796, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -45.846469720011896, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -46.19868965446603, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -45.67972568526128, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -46.954945109241294, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -45.49097750704204, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -44.57088974306025, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -42.59981466528021, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -40.680594098010445, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.25588718350871, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -44.60792558763636, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -45.611456760010064, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -47.01192504540858, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -44.61592787096068, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -43.24567846937704, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -45.3804079468196, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -44.230159376203815, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -42.93647057157564, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -44.700882856215756, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -45.03984941234262, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -44.9876512269465, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.47837416976407, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -45.271370798735155, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -41.44530985969205, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.537343365860195, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -45.17626996676162, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.59559566868697, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -43.08084285428311, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.98656876583771, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -42.908703534373444, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -43.69671800504765, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154, -46.062079765292154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2515030000526758, "mean_inference_ms": 0.4769649159836352, "mean_action_processing_ms": 0.08750034133240404, "mean_env_wait_ms": 8.46748043620865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 1080000, "timers": {"sample_time_ms": 22711.063, "sample_throughput": 105.675, "load_time_ms": 0.147, "load_throughput": 16370677.509, "learn_time_ms": 119.333, "learn_throughput": 20111.767, "update_time_ms": 2.741}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 119169.875, "policy_entropy": 16116.379231770834, "policy_loss": -7698.2397537231445, "vf_loss": 5465.4846598307295}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 1080000, "num_steps_trained": 180000, "num_agent_steps_trained": 1080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 752, "training_iteration": 75, "trial_id": "b97be_00000", "experiment_id": "b3938d6a05e8453e99cecdbb7650e884", "date": "2024-06-12_19-01-33", "timestamp": 1718186493, "time_this_iter_s": 22.747089624404907, "time_total_s": 1709.2201607227325, "pid": 241922, "hostname": "DESKTOP-LQ219J4", "node_ip": "192.168.46.185", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2400, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 240, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "voltage", "env_args": {"voltage_barrier_type": "l1", "voltage_weight": 1.0, "q_weight": 0.1, "line_weight": null, "dq_dv_weight": null, "history": 1, "pv_scale": 1.0, "demand_scale": 1.0, "state_space": ["pv", "demand", "reactive", "vm_pu", "va_degree"], "v_upper": 1.05, "v_lower": 0.95, "data_path": "/home/yos/MARLlib/marllib/patch/dpn/var_voltage_control/data/case33_3min_final", "episode_limit": 240, "action_scale": 0.8, "action_bias": 0.0, "mode": "distributed", "reset_action": true, "seed": 0, "map_name": "case33_3min_final"}, "mask_flag": false, "global_state_flag": true, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100.], (50,), float32), state:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.\n -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.\n 100. 100. 100. 100.], (144,), float32))", "space_act": "Box([-0.8], [0.8], (1,), float32)", "num_agents": 6, "episode_limit": 240, "policy_mapping_info": {"all_scenario": {"description": "voltage control all scenarios", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2", "agent_3", "agent_4", "agent_5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "voltage_case33_3min_final", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7516a7a940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 1709.2201607227325, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 4.190625, "ram_util_percent": 48.446875000000006}}
